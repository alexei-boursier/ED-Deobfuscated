"use strict";(self.webpackChunked_web=self.webpackChunked_web||[]).push([[1535],{66273:(ce,Y,f)=>{f.d(Y,{n:()=>S});var e=f(29141),O=f(21703),T=f(96272),x=f(99658),k=f(94650);let S=(()=>{class D{}return D.\u0275fac=function(L){return new(L||D)},D.\u0275mod=k.oAB({type:D}),D.\u0275inj=k.cJS({imports:[x.m,e.ez,O.c8,T.Q]}),D})()},24155:(ce,Y,f)=>{f.d(Y,{I:()=>vt});var e=f(94650),O=f(61135),T=f(60515),x=f(18505),k=f(82722),S=f(70262),D=f(28746),w=f(95698),L=f(63900),Q=f(63666),d=f(45007),re=f(11302),te=f(77579),q=f(20388),z=f(92635),v=f(36895),_=f(24006),I=f(80125),j=f(88246);const B=function(o){return{"has-error":o}};function G(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"form",7,8),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.createFilePad())}),e.TgZ(2,"div",9)(3,"div",10)(4,"div",11)(5,"label",12),e._uU(6,"Nom"),e.qZA(),e.TgZ(7,"input",13,14),e.NdJ("ngModelChange",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.fileToUpdate.libelle=n)}),e.qZA(),e.TgZ(9,"span",15),e._uU(10,"Nom du pad que vous souhaitez cr\xe9er"),e.qZA()()()(),e.TgZ(11,"div",16)(12,"div",17)(13,"input",18),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.modalRef.hide())}),e.qZA(),e._UZ(14,"input",19)(15,"div",20),e.TgZ(16,"div",21),e._uU(17," L'ensemble des activit\xe9s li\xe9es au pad (historique des versions, messages du chat...) sera supprim\xe9 automatiquement au bout de 3 mois d'inactivit\xe9. "),e.qZA()()()()}if(2&o){const t=e.MAs(1),i=e.MAs(8),n=e.oxw();e.xp6(4),e.Q6J("ngClass",e.VKq(3,B,i.invalid)),e.xp6(3),e.Q6J("ngModel",n.fileToUpdate.libelle),e.xp6(7),e.Q6J("disabled",t.invalid||t.pristine)}}function V(o,u){if(1&o&&(e.TgZ(0,"div",9),e._UZ(1,"iframe",22),e.ALo(2,"safe"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("src",e.xi3(2,1,t.iframeSrc,"resourceUrl"),e.uOi)}}function K(o,u){1&o&&e._UZ(0,"div",16)}let le=(()=>{class o{constructor(t,i,n,l,g){this.modalRef=t,this.uiLoaderService=i,this.cloudService=n,this.uiService=l,this.authStore=g,this._displayNomPipe=new d.$t3,this.onClose$=new te.x}get iframeSrc(){return""!==this.fileToUpdate.url?this.fileToUpdate.url+this.displayPadParametres:this.fileToUpdate.url}get displayPadParametres(){const t=this._displayNomPipe.transform(this.authStore.currentUser,!1,!0);return"?lang=fr&userName="+t+"&c="+d.YC.base64encode(((g,y)=>{g=g.toString();let ee="";for(let H=0;H<g.length;H++){let Ct="]GUz5Er(<7x4,29d#aQC"^g.charCodeAt(H);ee+=String.fromCharCode(Ct)}return ee})(t))}ngOnInit(){this.isModeAjout=!Object.isExists(this.file),this.fileToUpdate=this.isModeAjout?new d.EiA:new d.EiA(this.file),this.title=this.isModeAjout?"Ajouter un nouveau pad":this.fileToUpdate.libelle}ngOnDestroy(){this.onClose$.complete()}createFilePad(){this.loader=this.uiLoaderService.show(this),this.cloudService.addPadFile(this.idEntity,this.typeEntity,this.fileToUpdate,this.currentFolder).pipe((0,S.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,x.b)(t=>{this.onClose$.next(t),this.uiService.notifyEvent(d.DOJ.genericSuccess,"Le pad a \xe9t\xe9 cr\xe9\xe9 avec succ\xe8s","Mise \xe0 jour","icon-ed_cloud")}),(0,D.x)(()=>{this.uiLoaderService.hide(this),this.modalRef.hide()})).subscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q.UZ),e.Y36(z.S),e.Y36(d.eyc),e.Y36(d.VLf),e.Y36(d.CnD))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ed-modal-pad"]],inputs:{file:"file",currentFolder:"currentFolder",idEntity:"idEntity",typeEntity:"typeEntity"},decls:8,vars:5,consts:[["id","pad-file-modal",3,"ngBusy"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],["name","formPadFile","ngForm","","novalidate","",3,"ngSubmit",4,"ngIf"],["class","modal-body",4,"ngIf"],["class","modal-footer",4,"ngIf"],["name","formPadFile","ngForm","","novalidate","",3,"ngSubmit"],["formPadFile","ngForm"],[1,"modal-body"],[1,"row"],[1,"col-lg-6",3,"ngClass"],["for","libelle",1,"col-form-label"],["pattern","([^\\\\:/\\*\\?<>|])+","maxlength","30","id","libelle","name","libelle","placeholder","Nom du pad","required","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["libelle","ngModel"],[1,"form-text"],[1,"modal-footer"],[1,"w-100"],["type","button","value","Annuler",1,"btn","btn-warning","float-start",3,"click"],["id","btn-validate","type","submit","value","Valider",1,"btn","btn-primary","float-end",3,"disabled"],[1,"clearfix"],[1,"alert-info","alert","margin-top-10","text-center"],[1,"etherpad",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return i.modalRef.hide()}),e.qZA()(),e.YNc(5,G,18,5,"form",4),e.YNc(6,V,3,4,"div",5),e.YNc(7,K,1,0,"div",6),e.qZA()),2&t&&(e.Q6J("ngBusy",i.loader),e.xp6(3),e.hij(" ",i.title," "),e.xp6(2),e.Q6J("ngIf",i.isModeAjout),e.xp6(1),e.Q6J("ngIf",!i.isModeAjout),e.xp6(1),e.Q6J("ngIf",!i.isModeAjout))},dependencies:[v.mk,v.O5,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.nD,_.c5,_.On,_.F,I.DC,j.y],styles:["#pad-file-modal[_ngcontent-%COMP%]{height:100%}#pad-file-modal[_ngcontent-%COMP%]   iframe.etherpad[_ngcontent-%COMP%]{width:100%;height:1000px;border:0 none}.pad-modal[_ngcontent-%COMP%]   .modal-dialog.modal-lg[_ngcontent-%COMP%]{height:calc(100% - 60px);width:90%}.pad-modal[_ngcontent-%COMP%]   .modal-dialog.modal-lg[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%}.pad-modal[_ngcontent-%COMP%]   .modal-dialog.modal-lg[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{height:calc(100% - 100px)}"],changeDetection:0}),o})();var M=f(82945);function se(o,u){if(1&o&&(e._UZ(0,"div",14),e.ALo(1,"nl2br")),2&o){const t=e.oxw(2);e.Q6J("innerHTML",e.lcZ(1,1,t.fileToUpdate.description),e.oJD)}}function ae(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.setModeEdit(!0))}),e._UZ(1,"i",16),e._uU(2," Modifier le lien "),e.qZA()}}function p(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",3)(2,"h3",4),e._uU(3),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.modalRef.hide())}),e.qZA()(),e.TgZ(5,"div",6),e._UZ(6,"br"),e.TgZ(7,"div",7)(8,"a",8),e._UZ(9,"span",9),e._uU(10," Ouvrir le lien dans un nouvel onglet "),e.qZA()(),e._UZ(11,"br"),e.YNc(12,se,2,3,"div",10),e.qZA(),e.TgZ(13,"div",11)(14,"div",12),e.YNc(15,ae,3,0,"button",13),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ",t.title," "),e.xp6(5),e.s9C("href",t.fileToUpdate.url,e.LSH),e.xp6(4),e.Q6J("ngIf",t.fileToUpdate.description),e.xp6(3),e.Q6J("ngIf",t.isEditable)}}const C=function(o){return{"has-error":o}};function s(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"form",17,18),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.submitUrlFile())}),e.TgZ(2,"div",3)(3,"h3",4),e._uU(4),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.modalRef.hide())}),e.qZA()(),e.TgZ(6,"div",6)(7,"div",19)(8,"label",20),e._uU(9,"Titre"),e.qZA(),e.TgZ(10,"input",21,22),e.NdJ("ngModelChange",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.fileToUpdate.libelle=n)}),e.qZA(),e.TgZ(12,"span",23),e._uU(13,"Titre du lien que vous souhaitez ajouter"),e.qZA()(),e.TgZ(14,"div",19)(15,"label",24),e._uU(16,"URL du lien"),e.qZA(),e.TgZ(17,"input",25,26),e.NdJ("ngModelChange",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.fileToUpdate.url=n)}),e.qZA(),e.TgZ(19,"span",23),e._uU(20," Adresse web du lien que vous souhaitez ajouter "),e.TgZ(21,"a",27),e._UZ(22,"i",28),e._uU(23," Tester le lien "),e.qZA()()(),e.TgZ(24,"div")(25,"label",29),e._uU(26,"Description"),e.qZA(),e.TgZ(27,"textarea",30),e.NdJ("ngModelChange",function(n){e.CHM(t);const l=e.oxw();return e.KtG(l.fileToUpdate.description=n)}),e.qZA(),e.TgZ(28,"span",23),e._uU(29,"Descriptif du lien"),e.qZA()()(),e.TgZ(30,"div",11)(31,"div",12)(32,"input",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.modalRef.hide())}),e.qZA(),e._UZ(33,"input",32),e.qZA()()()}if(2&o){const t=e.MAs(1),i=e.MAs(11),n=e.MAs(18),l=e.oxw();e.xp6(4),e.hij(" ",l.title," "),e.xp6(3),e.Q6J("ngClass",e.VKq(8,C,i.invalid||""===l.fileToUpdate.libelle)),e.xp6(3),e.Q6J("ngModel",l.fileToUpdate.libelle),e.xp6(4),e.Q6J("ngClass",e.VKq(10,C,n.invalid||!l.fileToUpdate.url||""===l.fileToUpdate.url)),e.xp6(3),e.Q6J("ngModel",l.fileToUpdate.url),e.xp6(4),e.s9C("href",l.fileToUpdate.url,e.LSH),e.xp6(6),e.Q6J("ngModel",l.fileToUpdate.description),e.xp6(6),e.Q6J("disabled",t.invalid||t.pristine)}}let a=(()=>{class o{constructor(t,i,n,l){this.uiLoaderService=t,this.cloudService=i,this.uiService=n,this.modalRef=l,this.modeTeleversement=d.qt_.CLOUD,this.title="",this.onClose$=new te.x}ngOnInit(){this.isModeAjout=!Object.isExists(this.file),this.isModeEdit=this.isModeAjout,this.fileToUpdate=this.isModeAjout?new d.EiA:new d.EiA(this.file),this.fileToUpdate.description=d.YC.base64decode(this.fileToUpdate.description),this.isEditable=this.isModeAjout||"rw"===this.droitsRW,this.title=this.isModeAjout?"Ajouter un lien":this.isModeEdit?"Modifier le lien":this.fileToUpdate.libelle}ngOnDestroy(){this.onClose$.complete()}submitUrlFile(){this.loader=this.uiLoaderService.show(this);const t=new d.EiA(this.fileToUpdate);t.description=d.FSr.isNotEmptyString(t.description)?d.YC.base64encode(t.description):"",(this.isModeAjout?this.cloudService.addUrlFile(this.idEntity,this.typeEntity,t,this.currentFolder,this.modeTeleversement,this.uploadAdditionalParams):this.cloudService.updateFile(this.idEntity,this.typeEntity,t,this.currentFolder)).pipe((0,x.b)(n=>{this.onClose$.next(n),this.uiService.notifyEvent(d.DOJ.genericSuccess,"L'\xe9l\xe9ment a \xe9t\xe9 mis \xe0 jour avec succ\xe8s","Mise \xe0 jour","icon-ed_cloud")}),(0,S.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Erreur","fa fa-warning")),(0,D.x)(()=>{this.uiLoaderService.hide(this),this.modalRef.hide()})).subscribe()}setModeEdit(t){this.isModeEdit=t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(z.S),e.Y36(d.eyc),e.Y36(d.VLf),e.Y36(q.UZ))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ed-modal-url-file"]],inputs:{file:"file",currentFolder:"currentFolder",droitsRW:"droitsRW",idEntity:"idEntity",typeEntity:"typeEntity",modeTeleversement:"modeTeleversement",uploadAdditionalParams:"uploadAdditionalParams"},decls:3,vars:3,consts:[["id","url-file-modal",3,"ngBusy"],[4,"ngIf"],["name","formUrlFile","ngForm","","novalidate","",3,"ngSubmit",4,"ngIf"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body"],[1,"text-center"],["target","_blank",1,"btn","btn-secondary",3,"href"],[1,"fa","fa-link"],["class","alert alert-info",3,"innerHTML",4,"ngIf"],[1,"modal-footer"],[1,"w-100"],["class","btn btn-success float-end","type","button",3,"click",4,"ngIf"],[1,"alert","alert-info",3,"innerHTML"],["type","button",1,"btn","btn-success","float-end",3,"click"],["aria-hidden","true",1,"fa","fa-edit"],["name","formUrlFile","ngForm","","novalidate","",3,"ngSubmit"],["formUrlFile","ngForm"],[3,"ngClass"],["for","libelle",1,"col-form-label"],["id","libelle","name","libelle","pattern","([^\\\\:/\\*\\?<>|])+","placeholder","Titre","required","","edAutofocus","","type","text",1,"form-control",3,"ngModel","ngModelChange"],["libelle","ngModel"],[1,"form-text"],["for","url",1,"col-form-label"],["id","url","name","url","pattern","^(https?:\\/\\/).*","placeholder","http(s)://","required","","type","url",1,"form-control",3,"ngModel","ngModelChange"],["url","ngModel"],["target","_blank",1,"float-end",3,"href"],["aria-hidden","true",1,"fa","fa-link"],["for","description",1,"col-form-label"],["id","description","name","description","placeholder","Description","rows","5",1,"form-control",3,"ngModel","ngModelChange"],["type","button","value","Annuler",1,"btn","btn-warning","float-start",3,"click"],["id","btn-validate","type","submit","value","Valider",1,"btn","btn-primary","float-end",3,"disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,p,16,4,"div",1),e.YNc(2,s,34,12,"form",2),e.qZA()),2&t&&(e.Q6J("ngBusy",i.loader),e.xp6(1),e.Q6J("ngIf",!i.isModeEdit),e.xp6(1),e.Q6J("ngIf",i.isModeEdit))},dependencies:[v.mk,v.O5,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.c5,_.On,_.F,I.DC,M.U,d.kM_],encapsulation:2,changeDetection:0}),o})();var r=f(52497),c=f(61099),h=f(48536),m=f(87192),b=f(18968),N=f(4602);function E(o,u){if(1&o&&(e.TgZ(0,"div",6)(1,"div",17),e._UZ(2,"input",18),e.TgZ(3,"label",19),e._uU(4),e.qZA()(),e.TgZ(5,"div",17),e._UZ(6,"input",20),e.TgZ(7,"label",21),e._uU(8),e.qZA()()()),2&o){const t=e.oxw();e.xp6(4),e.hij("Format Microsoft Office Open XML (",t.getExtension("openXML"),")"),e.xp6(4),e.hij("Format OpenDocument (",t.getExtension("openDocument"),")")}}const Z=function(o){return{"has-error":o}};let A=(()=>{class o extends((0,d.kCV)()){constructor(t,i,n,l){super(),this.modalRef=t,this.formBuilder=i,this.authStore=n,this.modalService=l,this.format=d.VEx.getCollaboraFormat(this.authStore.currentUser),this.isFormatChoixLibre=!1,this.isFormatChoixLibre="1"===d.Kg5.getModuleParametre(d.qzA.CLOUD,"collaboraFormatChoixLibre",this.authStore.currentUser)}get title(){let t="";switch(this.typeFile){case".xlsx":t="Nouveau tableur";break;case".docx":t="Nouveau traitement de texte";break;case".pptx":t="Nouvelle pr\xe9sentation"}return t}getExtension(t){t=t||this.format;let i="";switch(this.typeFile){case".xlsx":i="openXML"===t?this.typeFile:".ods";break;case".docx":i="openXML"===t?this.typeFile:".odt";break;case".pptx":i="openXML"===t?this.typeFile:".odp"}return i}ngOnInit(){this.extensionDisplayed=this.getExtension(),this.buildForm()}buildForm(){this.formCollaboraFile=this.formBuilder.group({libelle:new _.NI("",_.kI.required),format:new _.NI(this.format,_.kI.required)}),this.formCollaboraFile.get("format").valueChanges.pipe((0,x.b)(t=>this.extensionDisplayed=this.getExtension(t)),(0,k.R)(this.componentDestroyed$)).subscribe()}createCollaboraFile(){this.modalService.setDismissReason(JSON.stringify({reason:r.G.validation,data:this.formCollaboraFile.value.libelle+this.extensionDisplayed})),this.modalRef.hide()}cancel(){this.modalService.setDismissReason(JSON.stringify({reason:r.G.cancel})),this.modalRef.hide()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(q.UZ),e.Y36(_.qu),e.Y36(d.CnD),e.Y36(q.tT))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ed-collabora-file-modal"]],inputs:{typeFile:"typeFile"},features:[e.qOj],decls:20,vars:9,consts:[["id","collabora-file-modal",3,"ngBusy"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],["name","formCollaboraFile","novalidate","",3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[1,"col-lg-12",3,"ngClass"],["for","libelle",1,"col-form-label"],[1,"input-group"],["pattern","([^\\\\:/\\*\\?<>|])+","maxlength","30","id","libelle","formControlName","libelle","placeholder","Nom du fichier","type","text",1,"form-control"],[1,"input-group-text"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"w-100"],["type","button","value","Annuler",1,"btn","btn-warning","float-start",3,"click"],["id","btn-validate","type","submit","value","Valider",1,"btn","btn-primary","float-end",3,"disabled"],[1,"form-check","col-lg-12"],["type","radio","id","format_openXML","formControlName","format","value","openXML",1,"form-check-input"],["for","format_openXML",1,"form-check-label","fw-normal"],["type","radio","id","format_openDocument","formControlName","format","value","openDocument",1,"form-check-input"],["for","format_openDocument",1,"form-check-label","fw-normal"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return i.cancel()}),e.qZA()(),e.TgZ(5,"form",4),e.NdJ("ngSubmit",function(){return i.createCollaboraFile()}),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),e._uU(10,"Nom du fichier (sans extension)"),e.qZA(),e.TgZ(11,"div",9),e._UZ(12,"input",10),e.TgZ(13,"span",11),e._uU(14),e.qZA()()()(),e.YNc(15,E,9,2,"div",12),e.qZA(),e.TgZ(16,"div",13)(17,"div",14)(18,"input",15),e.NdJ("click",function(){return i.cancel()}),e.qZA(),e._UZ(19,"input",16),e.qZA()()()()),2&t&&(e.Q6J("ngBusy",i.loader),e.xp6(3),e.hij(" ",i.title," "),e.xp6(2),e.Q6J("formGroup",i.formCollaboraFile),e.xp6(3),e.Q6J("ngClass",e.VKq(7,Z,i.formCollaboraFile.controls.libelle.invalid)),e.xp6(6),e.Oqu(i.extensionDisplayed),e.xp6(1),e.Q6J("ngIf",i.isFormatChoixLibre),e.xp6(4),e.Q6J("disabled",i.formCollaboraFile.invalid||i.formCollaboraFile.pristine))},dependencies:[v.mk,v.O5,_._Y,_.Fj,_._,_.JJ,_.JL,_.nD,_.c5,_.sg,_.u,I.DC]}),o})();var R=f(70655),W=f(5763);class F extends((0,d.kCV)()){constructor(){super(),this._clipboardCloud$=new O.X(this._clipboardNodes),this.clipboardCloud$=this._clipboardCloud$.asObservable()}set clipboardContent(u){this._clipboardNodes=u,this._clipboardCloud$.next(u)}get clipboardContent(){return this._clipboardCloud$.value}}F.\u0275fac=function(u){return new(u||F)},F.\u0275prov=e.Yz7({token:F,factory:F.\u0275fac,providedIn:"root"}),(0,R.gn)([(0,W.v)()],F.prototype,"_clipboardNodes",void 0);var U=f(59245),J=f(93970),P=f(34414),$=f(34331),ie=f(77069),ne=f(24491),X=f(29141),oe=f(21703),de=f(17493),pe=f(54004),he=f(43422);const ge=["ed-cloud-tr",""];function fe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"input",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onNodeClicked())}),e.qZA()}if(2&o){const t=e.oxw();e.MGl("name","selectNode_",t.node.id,""),e.Q6J("checked",t.isSelected)}}function me(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(n){e.CHM(t);const l=e.oxw();return l.openNode.emit(l.node),e.KtG(n.stopPropagation())}),e._UZ(1,"img",12),e._uU(2),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.hij(" ",t.node.libelle," ")}}function _e(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.displayPadModal.emit(n.node))}),e._UZ(1,"img",20),e._uU(2),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function be(o,u){if(1&o&&(e.TgZ(0,"button",21),e._UZ(1,"img",20),e._uU(2),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("additionalData",t.additionalDatasDownload)("file",t.node)("listFiles",t.parentNode.children),e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function ve(o,u){if(1&o&&(e.TgZ(0,"button",22),e._UZ(1,"img",23),e._uU(2),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("additionalData",t.additionalDatasDownload)("file",t.node),e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function Ce(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("completeTeleversement",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onCompleteTeleversement(n))}),e._UZ(1,"i",25),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("file",t.node)("canModifyPdf",!0)("additionalData",t.additionalDatasDownload)}}function xe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.displayUrlFileModal.emit(n.node))}),e._UZ(1,"img",23),e._uU(2),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function ye(o,u){if(1&o&&e._UZ(0,"img",20),2&o){const t=e.oxw(3);e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH)}}function De(o,u){1&o&&e._UZ(0,"img",30)}function Ee(o,u){1&o&&e._UZ(0,"i",31)}function Te(o,u){if(1&o&&(e.TgZ(0,"button",26),e.YNc(1,ye,1,1,"img",27),e.YNc(2,De,1,0,"img",28),e.YNc(3,Ee,1,0,"i",29),e._uU(4),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("file",t.node)("title",t.node.isStreamingReady?"Fichier disponible \xe0 la visualisation en streaming":"Fichier en cours de compression pour la visualisation en streaming"),e.xp6(1),e.Q6J("ngIf",!t.node.isStreamingReady),e.xp6(1),e.Q6J("ngIf",!t.node.isStreamingReady),e.xp6(1),e.Q6J("ngIf",t.node.isStreamingReady),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function Se(o,u){if(1&o&&(e.TgZ(0,"button",34),e._UZ(1,"i",25),e.qZA()),2&o){const t=e.oxw(3);e.Q6J("file",t.node)("readonly",!1)("additionalData",t.additionalDatasDownload)}}function Ne(o,u){if(1&o&&(e.ynx(0),e.TgZ(1,"button",32),e._UZ(2,"img",23),e._uU(3),e.qZA(),e.YNc(4,Se,2,3,"button",33),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("file",t.node)("readonly",!0)("additionalData",t.additionalDatasDownload),e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.id),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," "),e.xp6(1),e.Q6J("ngIf",t.isNodeEditable&&t.isCollaboraActif&&t.isCollaboraEditable&&!t.node.isTXT())}}function we(o,u){if(1&o&&(e.TgZ(0,"button",35),e._UZ(1,"img",23),e._uU(2),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("fileId",t.node.id)("fileType",t.typeFichierTelechargement.CLOUD)("additionalData",t.additionalDatasDownload),e.xp6(1),e.MGl("src","/assets/images/mimetypes/",t.cloudUtilHelper.getExtension(t.node.libelle),".png",e.LSH),e.xp6(1),e.hij(" ",t.node.libelle," ")}}function Me(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.transcode.emit(n.node))}),e._UZ(1,"i",37),e._uU(2," Convertir pour streaming "),e.qZA()}}function Ae(o,u){if(1&o&&(e.ynx(0),e.YNc(1,_e,3,2,"button",13),e.YNc(2,be,3,5,"button",14),e.YNc(3,ve,3,4,"button",15),e.YNc(4,Ce,2,3,"button",16),e.YNc(5,xe,3,2,"button",13),e.YNc(6,Te,5,6,"button",17),e.YNc(7,Ne,5,6,"ng-container",6),e.YNc(8,we,3,5,"button",18),e.YNc(9,Me,3,0,"button",19),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.node.isPadFile()),e.xp6(1),e.Q6J("ngIf",t.node.isImage()),e.xp6(1),e.Q6J("ngIf",t.node.isPDF()),e.xp6(1),e.Q6J("ngIf",t.isNodeEditable&&t.node.isPDF()),e.xp6(1),e.Q6J("ngIf",t.node.isURL()),e.xp6(1),e.Q6J("ngIf",t.node.isStreaming()&&t.isStreamingActif),e.xp6(1),e.Q6J("ngIf",t.node.isCollaboraFile()),e.xp6(1),e.Q6J("ngIf",!(t.node.isStreaming()&&t.isStreamingActif||t.node.isURL()||t.node.isImage()||t.node.isPadFile()||t.node.isPDF()||t.node.isCollaboraFile())),e.xp6(1),e.Q6J("ngIf",t.node.isVideo()&&t.isStreamingActif)}}function Ie(o,u){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"displaySize"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(e.xi3(2,1,t.node.taille,0))}}function Fe(o,u){if(1&o&&e._uU(0),2&o){const t=e.oxw().$implicit;e.hij(" ",t.libelle," ")}}function Ue(o,u){if(1&o){const t=e.EpF();e.YNc(0,Fe,1,1,"ng-template",38),e.NdJ("execute",function(){const l=e.CHM(t).$implicit;return e.KtG(l.callBack())})}2&o&&e.Q6J("disabled",!u.$implicit.enable)}let ke=(()=>{class o extends((0,d.kCV)()){constructor(t,i,n){super(),this.uiService=t,this.contextMenuService=i,this.cd=n,this.isStreamingActif=!1,this.modeTeleversement=d.qt_.CLOUD,this.openNode=new e.vpe,this.toggleNodeToSelection=new e.vpe,this.displayPadModal=new e.vpe,this.displayUrlFileModal=new e.vpe,this.transcode=new e.vpe,this.removeNode=new e.vpe,this.renameNode=new e.vpe,this.copyNode=new e.vpe,this.televersementObj=new e.vpe,this.cloudUtilHelper=d.VEx,this.typeFichierTelechargement=d.Y9E,this.tabContextMenuOptions=[]}get parentNode(){const t=this.tree.treeModel.getFocusedNode();return t?t.data:this.tree.treeModel.getFirstRoot().data}get isContextMenuEnabled(){return this.tabContextMenuOptions.filter(t=>!0===t.enable).length>0}get isNodeRemovable(){return!(this.node.isStreamingTranscoding||this.modeTeleversement===d.qt_.CLOUD&&(this.parentNode.isCasier()||this.node.isCasier()))}get isNodeEditable(){return!(this.modeTeleversement===d.qt_.CLOUD&&(this.parentNode.isCasier()||this.node.isCasier()))&&"rw"===this.droitsRW}get isNodeSelectable(){return!0}onContextMenu(t){this.contextMenuService.show(this.contextMenu,{x:t.x,y:t.y}),t.preventDefault(),t.stopPropagation()}ngOnInit(){Object.isExists(this.transcodingJobStatus$)&&this.transcodingJobStatus$.pipe((0,pe.U)(t=>t.find(i=>i.id===this.node.id)),(0,x.b)(t=>{Object.isExists(t)&&t.streamingTranscodeStatus!==this.node.streamingTranscodeStatus&&t.isStreamingReady&&(this.node.streamingTranscodeStatus=t.streamingTranscodeStatus,this.uiService.notifyEvent(d.DOJ.genericSuccess,`La vid\xe9o <strong>${t.libelle}</strong> est disponible pour streaming`,"Conversion","icon-ed_cloud"))}),(0,k.R)(this.componentDestroyed$)).subscribe()}ngOnChanges(t){(t.node||t.droitsRW)&&this.initContextMenu(),t.entity&&(this.additionalDatasDownload={data:JSON.stringify({idEntity:this.entity.id,typeEntity:this.entity.type})})}initContextMenu(){this.tabContextMenuOptions=this.modeTeleversement!==d.qt_.CLOUD||!this.node.isCasier()&&!this.parentNode.isCasier()?[{libelle:"Renommer",enable:this.canDeleteNode&&!this.node.isStreamingTranscoding,callBack:()=>this.renameNode.emit(this.node)},{libelle:"Copier",enable:!this.node.isStreamingTranscoding,callBack:()=>this.copyNode.emit(this.node)},{libelle:"Supprimer",enable:this.canDeleteNode&&this.isNodeRemovable,callBack:()=>this.removeNode.emit(this.node)}]:[]}onCompleteTeleversement(t){this.televersementObj.emit(t),this.cd.detectChanges()}onNodeClicked(){!this.isNodeSelectable||this.toggleNodeToSelection.emit(this.node)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.VLf),e.Y36(de.Lk),e.Y36(e.sBO))},o.\u0275cmp=e.Xpm({type:o,selectors:[["tr","ed-cloud-tr",""]],viewQuery:function(t,i){if(1&t&&e.Gf(de.GI,5),2&t){let n;e.iGM(n=e.CRH())&&(i.contextMenu=n.first)}},hostBindings:function(t,i){1&t&&e.NdJ("contextmenu",function(l){return i.onContextMenu(l)})},inputs:{entity:"entity",node:"node",tree:"tree",isSelected:"isSelected",isStreamingActif:"isStreamingActif",isCollaboraActif:"isCollaboraActif",isCollaboraEditable:"isCollaboraEditable",droitsRW:"droitsRW",canDeleteNode:"canDeleteNode",modeTeleversement:"modeTeleversement",transcodingJobStatus$:"transcodingJobStatus$"},outputs:{openNode:"openNode",toggleNodeToSelection:"toggleNodeToSelection",displayPadModal:"displayPadModal",displayUrlFileModal:"displayUrlFileModal",transcode:"transcode",removeNode:"removeNode",renameNode:"renameNode",copyNode:"copyNode",televersementObj:"televersementObj"},features:[e.qOj,e.TTD],attrs:ge,decls:18,vars:17,consts:[[1,"screen-reader"],["type","button","aria-label","Ajouter l'\xe9l\xe9ment \xe0 la s\xe9lection",3,"click"],[1,"text-center","align-middle"],["title","S\xe9lectionner / D\xe9s\xe9lectionner","type","checkbox","class","form-check-input",3,"name","checked","click",4,"ngIf"],[1,"draggable","border-start-0",3,"click"],["class","btn btn-link mt-1","type","button",3,"click",4,"ngIf"],[4,"ngIf"],[1,"align-middle"],[3,"menuClass","disabled"],[4,"ngFor","ngForOf","ngForTrackBy"],["title","S\xe9lectionner / D\xe9s\xe9lectionner","type","checkbox",1,"form-check-input",3,"name","checked","click"],["type","button",1,"btn","btn-link","mt-1",3,"click"],["src","/assets/images/mimetypes/folder.png","alt","icone dossier"],["type","button","class","btn btn-link mt-1",3,"click",4,"ngIf"],["edLightbox","","typeFichier","CLOUD","type","button","class","btn btn-link mt-1",3,"additionalData","file","listFiles",4,"ngIf"],["edLightbox","","typeFichier","CLOUD","type","button","class","btn btn-link mt-1",3,"additionalData","file",4,"ngIf"],["title","Editer ce document","edLightbox","","typeFichier","CLOUD","type","button","class","btn btn-link mt-1 margin-whitespace",3,"file","canModifyPdf","additionalData","completeTeleversement",4,"ngIf"],["class","btn btn-link mt-1","edLightbox","","typeFichier","CLOUD","type","button",3,"file","title",4,"ngIf"],["edTelechargement","","type","button","class","btn btn-link",3,"fileId","fileType","additionalData",4,"ngIf"],["type","button","class","btn btn-primary btn-sm white streaming-link","title","Convertir la vid\xe9o pour streaming","aria-label","Convertir la vid\xe9o pour streaming",3,"click",4,"ngIf"],["alt","icone image",3,"src"],["edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1",3,"additionalData","file","listFiles"],["edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1",3,"additionalData","file"],["alt","icone document",3,"src"],["title","Editer ce document","edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1","margin-whitespace",3,"file","canModifyPdf","additionalData","completeTeleversement"],[1,"fa","fa-edit","i-small"],["edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1",3,"file","title"],["alt","icone image",3,"src",4,"ngIf"],["src","/assets/images/processing.gif","aria-hidden","true","alt","...","class","margin-whitespace",4,"ngIf"],["class","fa fa-youtube-play","aria-hidden","true",4,"ngIf"],["src","/assets/images/processing.gif","aria-hidden","true","alt","...",1,"margin-whitespace"],["aria-hidden","true",1,"fa","fa-youtube-play"],["edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1",3,"file","readonly","additionalData"],["title","Editer ce document","edLightbox","","typeFichier","CLOUD","type","button","class","btn btn-link mt-1 margin-whitespace",3,"file","readonly","additionalData",4,"ngIf"],["title","Editer ce document","edLightbox","","typeFichier","CLOUD","type","button",1,"btn","btn-link","mt-1","margin-whitespace",3,"file","readonly","additionalData"],["edTelechargement","","type","button",1,"btn","btn-link",3,"fileId","fileType","additionalData"],["type","button","title","Convertir la vid\xe9o pour streaming","aria-label","Convertir la vid\xe9o pour streaming",1,"btn","btn-primary","btn-sm","white","streaming-link",3,"click"],["aria-hidden","true",1,"fa","fa-cog"],["contextMenuItem","",3,"disabled","execute"]],template:function(t,i){1&t&&(e.TgZ(0,"td",0)(1,"button",1),e.NdJ("click",function(){return i.onNodeClicked()}),e.qZA()(),e.TgZ(2,"td",2),e.YNc(3,fe,1,2,"input",3),e.qZA(),e.TgZ(4,"td",4),e.NdJ("click",function(){return i.onNodeClicked()}),e.YNc(5,me,3,1,"button",5),e.YNc(6,Ae,10,9,"ng-container",6),e.qZA(),e.TgZ(7,"td",7),e._uU(8),e.ALo(9,"edDate"),e.qZA(),e.TgZ(10,"td",7),e._uU(11),e.ALo(12,"displayNom"),e.qZA(),e.TgZ(13,"td",7),e.YNc(14,Ie,3,4,"span",6),e.qZA(),e.TgZ(15,"context-menu",8),e.YNc(16,Ue,1,1,null,9),e.ALo(17,"trackByProperty"),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",i.isNodeSelectable),e.xp6(2),e.Q6J("ngIf",i.node.isFolder()),e.xp6(1),e.Q6J("ngIf",!i.node.isFolder()),e.xp6(2),e.Oqu(e.xi3(9,10,i.node.date,"dd/MM/y - HH:mm")),e.xp6(3),e.Oqu(e.lcZ(12,13,i.node.proprietaire)),e.xp6(3),e.Q6J("ngIf",i.node.isFile()&&!i.node.url&&!i.node.isStreaming()),e.xp6(1),e.Q6J("menuClass","cloudContextMenu")("disabled",!i.isContextMenuEnabled),e.xp6(1),e.Q6J("ngForOf",i.tabContextMenuOptions)("ngForTrackBy",e.lcZ(17,15,"$index")))},dependencies:[v.sg,v.O5,de.GI,de.n5,ie.x,he.l,d.$t3,d.ifA,d.dYR,N.$],styles:["td[_ngcontent-%COMP%]:nth-child(2){position:relative}td[_ngcontent-%COMP%]:nth-child(2)   button.streaming-link[_ngcontent-%COMP%]{--bs-btn-line-height: 1rem;position:absolute;right:10px;top:2px;--bs-btn-padding-y: .1rem}context-menu[_ngcontent-%COMP%]{padding:0}"],changeDetection:0}),o})();function Ze(o,u){if(1&o&&(e.TgZ(0,"div",14)(1,"ngx-gauge",15)(2,"ngx-gauge-value"),e._uU(3),e.ALo(4,"displaySize"),e.qZA(),e.TgZ(5,"ngx-gauge-append"),e._uU(6),e.ALo(7,"displaySize"),e.qZA()()()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("value",t.jauge.usage)("size",160)("thick",25)("min",0)("max",t.jauge.quota)("thresholds",t.jauge.thresholdConfig),e.xp6(2),e.Oqu(e.lcZ(4,8,t.jauge.usage)),e.xp6(3),e.hij("/ ",e.lcZ(7,10,t.jauge.quota),"")}}function Oe(o,u){if(1&o&&(e.ynx(0),e.YNc(1,Ze,8,12,"div",13),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.authStore.isFamille()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL||t.entity.type===t.TYPE_USER.ESPACE_TRAVAIL&&"rw"===t.droitsRW)}}function Re(o,u){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij("L'espace personnel de ",t.entity.libelle,"")}}function Le(o,u){1&o&&(e.TgZ(0,"span"),e._uU(1,"Mon espace personnel"),e.qZA())}function Je(o,u){1&o&&(e.TgZ(0,"p",16),e._uU(1," Le contenu de ce dossier est visible par vos responsables familiaux, vos enseignants et par le chef d'\xe9tablissement en mode supervision "),e.qZA())}function Pe(o,u){1&o&&(e.TgZ(0,"p",16),e._uU(1," Le contenu de ce dossier n'est visible que par vous (en dehors du mode supervision du chef d'\xe9tablissement) "),e.qZA())}function He(o,u){1&o&&(e.TgZ(0,"p",16),e._uU(1," Le contenu de ce dossier est visible par tous les membres de votre espace de travail, il peut \xe9galement \xeatre accessible \xe0 tous les utilisateurs de l'\xe9tablissement si la visibilt\xe9 de votre espace de travail est publique. "),e.qZA())}function qe(o,u){if(1&o&&(e.ynx(0),e.YNc(1,Oe,2,1,"ng-container",1),e.TgZ(2,"h2"),e.YNc(3,Re,2,1,"span",1),e.YNc(4,Le,2,0,"span",1),e.qZA(),e.YNc(5,Je,2,0,"p",12),e.YNc(6,Pe,2,0,"p",12),e.YNc(7,He,2,0,"p",12),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.store.length>0),e.xp6(2),e.Q6J("ngIf",t.authStore.isFamille()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL),e.xp6(1),e.Q6J("ngIf",!t.authStore.isFamille()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL),e.xp6(1),e.Q6J("ngIf",t.authStore.isEleve()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL),e.xp6(1),e.Q6J("ngIf",t.authStore.isProfOuPersonnel()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL),e.xp6(1),e.Q6J("ngIf",t.entity.type===t.TYPE_USER.ESPACE_TRAVAIL)}}function Qe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"div",17),e.NdJ("dndDrop",function(n){const g=e.CHM(t).$implicit,y=e.oxw();return e.KtG(y.onDrop(n.data,g.data))}),e.TgZ(1,"span"),e._uU(2),e.qZA()()}if(2&o){const t=u.$implicit;e.xp6(2),e.Oqu(t.data.displayText)}}function je(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.removeSelectedNodes())}),e._UZ(1,"i",33),e.qZA()}}function Ge(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.copyToClipboard())}),e._UZ(1,"i",35),e.qZA()}}function Ye(o,u){if(1&o&&(e.ynx(0),e.TgZ(1,"button",28),e._UZ(2,"i",29),e.qZA(),e.YNc(3,je,2,0,"button",30),e.YNc(4,Ge,2,0,"button",31),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("tabFileId",t.selectedNodesIds)("fileType",t.typeFichierTelechargement.CLOUD),e.xp6(2),e.Q6J("ngIf",t.canDeleteNode&&t.isSelectedNodesRemovable),e.xp6(1),e.Q6J("ngIf",!t.isCasierNodesInSelectedNodes)}}function ze(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.pasteFromClipboard())}),e._UZ(1,"i",44),e.qZA()}}function Be(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.addDossier())}),e._UZ(1,"i",46),e._uU(2," Nouveau dossier "),e.qZA()}}function Ve(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(5);return e.KtG(n.displayPadModal())}),e._UZ(1,"i",59),e._uU(2," Nouveau pad "),e.qZA()}}function Ke(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ul",51)(1,"li",52)(2,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.displayNewCalloboraFileModal(".docx"))}),e._UZ(3,"i",54),e._uU(4," Traitement de texte "),e.qZA(),e.TgZ(5,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.displayNewCalloboraFileModal(".xlsx"))}),e._UZ(6,"i",55),e._uU(7," Tableur "),e.qZA(),e.TgZ(8,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.displayNewCalloboraFileModal(".pptx"))}),e._UZ(9,"i",56),e._uU(10," Pr\xe9sentation "),e.qZA(),e.TgZ(11,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.displayUrlFileModal())}),e._UZ(12,"i",57),e._uU(13," Lien "),e.qZA(),e.YNc(14,Ve,3,0,"button",58),e.qZA()()}if(2&o){const t=e.oxw(4);e.xp6(14),e.Q6J("ngIf",t.isPadsActif&&t.entity.type===t.TYPE_USER.ESPACE_TRAVAIL)}}function We(o,u){1&o&&(e.TgZ(0,"div",47)(1,"button",48),e._UZ(2,"i",49),e._uU(3," Nouveau fichier "),e.qZA(),e.YNc(4,Ke,15,1,"ul",50),e.qZA()),2&o&&e.Q6J("isAnimated",!1)}function $e(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.displayPadModal())}),e._UZ(1,"i",59),e._uU(2," Ajouter un pad "),e.qZA()}}function Xe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.displayUrlFileModal())}),e._UZ(1,"i",57),e._uU(2," Ajouter un lien "),e.qZA(),e.YNc(3,$e,3,0,"button",61)}if(2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.isPadsActif&&t.entity.type===t.TYPE_USER.ESPACE_TRAVAIL)}}function et(o,u){if(1&o&&(e.ynx(0),e.YNc(1,ze,2,0,"button",36),e._UZ(2,"input",37),e.TgZ(3,"button",38),e._UZ(4,"i",39),e._uU(5," T\xe9l\xe9verser un fichier "),e.qZA(),e.Hsn(6),e.YNc(7,Be,3,0,"button",40),e.YNc(8,We,5,1,"div",41),e.YNc(9,Xe,4,1,"ng-template",null,42,e.W1O),e.BQk()),2&o){const t=e.MAs(10),i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i.isClipboardEmpty),e.xp6(6),e.Q6J("ngIf",i.modeTeleversement===i.typeFichierTeleversement.CLOUD),e.xp6(1),e.Q6J("ngIf",i.isCollaboraActif&&i.isCollaboraEdit)("ngIfElse",t)}}function tt(o,u){if(1&o&&(e.TgZ(0,"span",70),e._uU(1),e.qZA()),2&o){const t=e.oxw(5);e.xp6(1),e.Oqu(t.entity.libelle)}}function it(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.openNode(n))}),e._UZ(1,"i",68),e.YNc(2,tt,2,1,"span",69),e.qZA()}if(2&o){const t=e.oxw(4);e.xp6(2),e.Q6J("ngIf",t.authStore.isFamille()&&t.entity.type!==t.TYPE_USER.ESPACE_TRAVAIL)}}const nt=function(o){return{currentBread:o,btn:!0,"btn-link":!0}};function ot(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",71),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.openNode(n))}),e.TgZ(1,"div"),e._uU(2),e.qZA()()}if(2&o){const t=e.oxw(),n=t.$implicit;e.Tol(e.VKq(3,nt,t.last)),e.xp6(2),e.Oqu(n.libelle)}}function rt(o,u){if(1&o&&(e.ynx(0),e.YNc(1,it,3,1,"button",65),e.YNc(2,ot,3,5,"button",66),e.BQk()),2&o){const t=u.first;e.xp6(1),e.Q6J("ngIf",t),e.xp6(1),e.Q6J("ngIf",!t)}}function st(o,u){if(1&o&&(e.TgZ(0,"div",63),e.YNc(1,rt,3,2,"ng-container",64),e.ALo(2,"trackByProperty"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.breadcrumbs())("ngForTrackBy",e.lcZ(2,2,"id"))}}function at(o,u){1&o&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"Dans ce dossier vous trouvez les fichiers rendus par vos \xe9l\xe8ves dans le cahier de texte."),e.qZA(),e.TgZ(3,"p",16),e._uU(4,"Les \xe9l\xe8ves ne peuvent pas voir son contenu."),e.qZA()())}function lt(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"tr"),e._UZ(1,"th",72),e.TgZ(2,"th")(3,"input",73),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.toggleNodesSelected())}),e.qZA()(),e.TgZ(4,"th",74),e._uU(5,"Nom"),e.qZA(),e.TgZ(6,"th",75),e._uU(7,"Date"),e.qZA(),e.TgZ(8,"th",76),e._uU(9,"Propri\xe9taire"),e.qZA(),e.TgZ(10,"th",77),e._uU(11,"Taille"),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("checked",t.isNodesSelected())}}const dt=function(o,u,t){return{folder:o,"table-light":u,disabled:t}};function ct(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"tr",78),e.NdJ("openNode",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.openNode(n))})("toggleNodeToSelection",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.toggleNodeToSelection(n))})("displayPadModal",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.displayPadModal(n))})("displayUrlFileModal",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.displayUrlFileModal(n))})("renameNode",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.renameNode(n))})("copyNode",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.ctxtMenuCopyNode(n))})("removeNode",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.ctxtMenuRemoveNode(n))})("televersementObj",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.televerseObj(n))})("transcode",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.transcodeVideo(n))})("dndStart",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onDragStart(n))})("dndEnd",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onDragEnd(n))})("dndDrop",function(n){const g=e.CHM(t).item,y=e.oxw(2);return e.KtG(y.onDrop(n.data,g))}),e.qZA()}if(2&o){const t=u.item,i=e.oxw(2),n=e.MAs(9);e.Q6J("entity",i.entity)("node",t)("tree",n)("isSelected",i.isNodeSelected(t))("isStreamingActif",i.isStreamingActif)("isCollaboraActif",i.isCollaboraActif)("isCollaboraEditable",i.isCollaboraEdit)("modeTeleversement",i.modeTeleversement)("droitsRW",i.droitsRW)("canDeleteNode",i.canDeleteNode)("transcodingJobStatus$",i.transcodingJobStatus$)("dndDraggable",t)("dndDisableDragIf",t.isStreamingTranscoding)("ngClass",e.kEZ(14,dt,t.isFolder(),i.isNodeSelected(t),t.isStreamingTranscoding))}}function ut(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"ed-input-files",79),e.NdJ("successUpload",function(n){e.CHM(t);const l=e.oxw(2);return e.KtG(l.onUploadSuccess(n))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("fileToTeleverse",t.objToTeleverseInInput)("dropzoneConfig",t.dropZoneConfig)("remplace",t.remplace)("checkFileSizeFn",t.maxFileSize)("config",t.inputFilesConfig)}}const pt=function(o){return{"container-bg col-xl-10 col-lg-8 col-md-8 folder-view pt-3":o}};function ht(o,u){if(1&o&&(e.TgZ(0,"div",18)(1,"div",19),e.YNc(2,Ye,5,4,"ng-container",1),e.YNc(3,et,11,4,"ng-container",1),e.qZA(),e.YNc(4,st,3,4,"div",20),e._UZ(5,"div",21),e.TgZ(6,"div",22),e.YNc(7,at,5,0,"div",1),e.TgZ(8,"div",23)(9,"ed-smart-table",24),e.YNc(10,lt,12,1,"ng-template",25),e.YNc(11,ct,1,18,"ng-template",26),e.qZA()(),e.YNc(12,ut,1,5,"ed-input-files",27),e.qZA()()),2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(8,pt,t.displayFull)),e.xp6(2),e.Q6J("ngIf",t.isNodesSelected()),e.xp6(1),e.Q6J("ngIf",t.actionButtonsEnabled),e.xp6(1),e.Q6J("ngIf",t.displayFull),e.xp6(3),e.Q6J("ngIf",t.displayFull&&t.authStore.isProfesseur()&&(null==t.currentNode?null:t.currentNode.id.indexOf("CASIER"))>0),e.xp6(2),e.Q6J("datas",null==t.currentNode?null:t.currentNode.children)("trackByFn",t.trackByFn),e.xp6(3),e.Q6J("ngIf",t.canAddNode&&t.store.length>0)}}const gt=[[["",8,"additionalactionbuttonstmp"]]],ft=function(o){return{"simple-padding":o}},mt=function(o){return{"min-height":o}},_t=function(o){return{"d-sm-block":o}},bt=[".additionalActionButtonsTmp"],ue=new RegExp(/[\\:/*&?"<>|+%\xb0]/);let vt=(()=>{class o extends((0,d.kCV)()){constructor(t,i,n,l,g,y,ee,H){super(),this.authStore=t,this.cloudService=i,this.loaderService=n,this.uiService=l,this.modalService=g,this.cd=y,this.clipboardCloudService=ee,this.espaceDeTravailStore=H,this.rootFolder="",this.displayFull=!0,this.modeTeleversement=d.qt_.CLOUD,this.isClipboardEmpty=!0,this.typeFichierTelechargement=d.Y9E,this.typeFichierTeleversement=d.qt_,this.TYPE_USER=d.dcH,this.store=[],this.isPadsActif=!1,this.isCollaboraActif=!1,this.isCollaboraEdit=!1,this.isStreamingActif=!1,this.canDeleteNode=!1,this.canAddNode=!1,this.remplace=!1,this.thresholdConfig={},this.treeViewConfig={idField:"id",allowDrag:!1,allowDrop:!1,allowDragoverStyling:!1,displayField:"displayText",actionMapping:{mouse:{click:Q.iM.ACTIVATE,expanderClick:Q.iM.TOGGLE_EXPANDED}}},this.treeViewInitialized=!1,this.isPadsActif=d.Kg5.getModuleParametre(d.qzA.CLOUD,"padsActif",this.authStore.currentUser),this.isCollaboraActif=d.VEx.isCollaboraActif(this.authStore.currentUser),this.isCollaboraEdit=d.VEx.isCollaboraEdit(this.authStore.currentUser),this.isStreamingActif=d.VEx.isStreamingActif(this.authStore.currentUser),this._transcodingJobStatus$=new O.X([]),this.transcodingJobStatus$=this._transcodingJobStatus$.asObservable(),this.successUpload=new e.vpe,this.successCopy=new e.vpe,this.successRemove=new e.vpe}get componentUniqID(){return`${this.constructor.name}_${this.entity.type}_${this.entity.id}`}get actionButtonsEnabled(){return"rw"===this.droitsRW&&this.currentNode&&!(this.currentNode.isCasier()&&this.modeTeleversement===d.qt_.CLOUD)}ngOnInit(){this.clipboardCloudService.clipboardCloud$.pipe((0,x.b)(t=>{this.isClipboardEmpty=!Object.isExists(t)||0===t.nodes.length,this.cd.markForCheck()}),(0,k.R)(this.componentDestroyed$)).subscribe()}ngOnChanges(t){t.entity?.isFirstChange()||t.entity?.previousValue?.constructor.name!==t.entity?.currentValue?.constructor.name||t.entity?.previousValue.id!==t.entity?.currentValue.id?(this.initConfigDZ(),this.calculRW(),this.treeViewInitialized&&this.refreshNode(void 0,!0,!0)):t.droitsRW&&this.calculRW()}ngOnDestroy(){return this.timerStreamingStatusId>0&&clearTimeout(this.timerStreamingStatusId),this._transcodingJobStatus$.complete(),super.ngOnDestroy()}get maxFileSize(){return this.store[0].quota-this.store[0].taille}get jauge(){const t=this.store[0].quota,i=this.store[0].taille;return{thresholdConfig:{0:{color:"green"},[Math.floor(t/3)]:{color:"orange"},[Math.floor(t/3*2)]:{color:"red"}},quota:t,usage:i}}get currentNode(){const i=this.tree.treeModel.getFocusedNode()||this.tree.treeModel.getFirstRoot();return i?i.data:void 0}get selectedNodesIds(){const t=this.tree.treeModel.getState();return Object.isExists(t.selectedLeafNodeIds)?Object.keys(t.selectedLeafNodeIds):[]}get isCasierNodesInSelectedNodes(){return this.selectedNodesIds.filter(t=>d.VEx.isCasierId(t)).length>0}get isCasierReadonlyNodesInSelectedNodes(){return this.selectedNodesIds.filter(t=>d.VEx.isCasierId(t)&&!d.VEx.isCasierNodeRemovableId(t)).length>0}get isSelectedNodesRemovable(){return!this.isCasierReadonlyNodesInSelectedNodes||this.modeTeleversement===this.typeFichierTeleversement.CDT||this.modeTeleversement===this.typeFichierTeleversement.CDT_CORRECTIFS}refreshNode(t,i=!1,n=!1){this.loader=this.loaderService.show(this.componentUniqID),this.cloudService.getCloudContents(this.entity?.id,this.entity.type,Object.isExists(t)?t.id.replace(this.tree.treeModel.getFirstRoot().id,""):this.rootFolder,i).pipe((0,x.b)(l=>{if(Object.isExists(l)){const g=new d.mCH(l);if(this.isRootNode(g))g.isExpanded=!0,g.displayText=this.entity.libelle,this.store=[g];else if(Object.isExists(t)){const y=this.tree.treeModel.getNodeById(t.id).parent;d.VEx.updatedNode(this.store[0],y.id,g.id,g),this.store=[new d.mCH(this.store[0])]}n&&this.updateNodeState(g.id,!0,!Object.isExists(t)),this.dropZoneConfig={...this.dropZoneConfig,disabled:!this.canAddNode||this.modeTeleversement===d.qt_.CLOUD&&g.isCasier(),url:`${this.urlUpload}&dest=${g.id}`},this.isStreamingActif&&this.getStreamingFilesStatus()}else Object.isExists(t)||(this.store=[])}),(0,S.K)(l=>this.uiService.notifyErrorThenEmpty(l,!0)),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}updateData(){this.tree.treeModel.setState({...this.tree.treeModel.getState(),hiddenNodeIds:this.store.length>0?this.store[0].getHiddenNodeIds():[]})}openNode(t,i=!1){!t.isFolder()||(this.timerStreamingStatusId>0&&clearTimeout(this.timerStreamingStatusId),!t.isLoaded||i?this.refreshNode(t,!0,!0):(this.updateNodeState(t.id,!this.isRootNode(t)||void 0),this.dropZoneConfig={...this.dropZoneConfig,disabled:!this.canAddNode||this.modeTeleversement===d.qt_.CLOUD&&t.isCasier(),url:`${this.urlUpload}&dest=${t.id}`},this.isStreamingActif&&this.getStreamingFilesStatus()))}initConfigDZ(){const t={parallelUploads:3,maxFilesize:500,timeout:3e6,addRemoveLinks:!1,clickable:".fileinput-button",dictDefaultMessage:"D\xe9posez vos fichiers ici...",dictResponseError:"Une erreur s'est produite",dictRemoveFile:"",dictCancelUpload:"",dictCancelUploadConfirmation:"\xcates-vous sur de vouloir supprimer ce t\xe9l\xe9versement ?",url:`${(0,re.Je)()}/televersement.awp?verbe=post&mode=${this.modeTeleversement}`,disabled:!1};this.dropZoneConfig=Object.isExists(this.dropZoneConfig)?{...t,...this.dropZoneConfig}:t,this.urlUpload=this.dropZoneConfig.url;const i={fromCloudEnabled:!1,keepComplete:!1,dropzoneContainer:"#dropzoneContainer"};this.inputFilesConfig=Object.isExists(this.inputFilesConfig)?{...i,...this.inputFilesConfig}:i}calculRW(){d.FSr.isNotEmptyString(this.droitsRW)||(this.entity.type===d.dcH.ESPACE_TRAVAIL?this.droitsRW=this.entity.droit>d.bvQ.DROIT_LECTURE?"rw":"ro":(this.droitsRW=this.authStore.isHimself(this.entity.type,this.entity.id)?"rw":"ro",this.authStore.isEleve()&&"rw"!==this.droitsRW&&(this.droitsRW=this.modeTeleversement===d.qt_.CDT&&this.entity.type===d.dcH.ENSEIGNANT?"rw":"ro"))),this.canDeleteNode="rw"===this.droitsRW&&this.entity.droit>=d.bvQ.DROIT_SUPPRESSION,this.canAddNode="rw"===this.droitsRW&&this.entity.droit>d.bvQ.DROIT_LECTURE}copyToClipboard(){const t=this.tree.treeModel.getState();this.clipboardCloudService.clipboardContent=Object.isExists(t.selectedLeafNodeIds)?{idEntity:this.entity.id,typeEntity:this.entity.type,racine:this.tree.treeModel.getFirstRoot().id,nodes:Object.keys(t.selectedLeafNodeIds).map(i=>new d.EiA(this.tree.treeModel.getNodeById(i).data))}:{idEntity:this.entity.id,typeEntity:this.entity.type,racine:this.tree.treeModel.getFirstRoot().id,nodes:[]},this.uiService.notifyEvent(d.DOJ.genericSuccess,"Les \xe9l\xe9ments ont bien \xe9t\xe9 copi\xe9s","Copi\xe9","icon-ed_cloud")}pasteFromClipboard(){if(this.modeTeleversement===d.qt_.CLOUD&&this.currentNode.isCasier())return;let t=0,i=!1;const n=this.clipboardCloudService.clipboardContent.nodes.map(l=>new d.EiA(l));if(n.forEach(l=>{this.currentNode.children.findIndex(g=>g.libelle===l.libelle)>-1&&(this.uiService.notifyEvent(d.DOJ.genericError,"Action impossible. Un \xe9l\xe9ment avec le m\xeame identifiant existe d\xe9j\xe0 : "+l.libelle,"Erreur","fa fa-warning"),i=!0),t+=this.sizeOf(l)}),!i)if(this.jauge.usage+t>this.jauge.quota)this.uiService.notifyEvent(d.DOJ.genericError,"Action impossible. Vous ne disposez pas assez d'espace","Erreur","icon-ed_cloud");else{this.loader=this.loaderService.show(this.componentUniqID);const l=this.clipboardCloudService.clipboardContent;this.cloudService.pasteNode(l.idEntity,l.typeEntity,n,l.racine,this.entity.id,this.entity.type,this.store,this.currentNode).pipe((0,x.b)(g=>{const y=this.tree.treeModel.getNodeById(this.currentNode.id),ee=y.isRoot?y.id:y.parent.id,H=new d.mCH(g);this.isRootNode(H)&&(H.displayText=this.entity.libelle),this.updateNode(ee,H),this.store[0].taille+=t,this.updateNodeState(H.id),this.successCopy.emit(l.nodes),this.uiService.notifyEvent(d.DOJ.genericSuccess,"Les \xe9l\xe9ments ont bien \xe9t\xe9 coll\xe9s","Coll\xe9","icon-ed_cloud")}),(0,S.K)(g=>this.uiService.notifyErrorThenEmpty(g,!0,"Copie impossible","fa fa-warning")),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}}sizeOf(t,i=!1){let n=0;return t.isFolder()?(t.isLoaded?t.children.forEach(l=>{n+=this.sizeOf(l,i)}):n=t.taille,i&&(t.taille=n),n):t.taille}isNodeSelectable(t){return this.modeTeleversement===d.qt_.CLOUD&&(t.isCasierNodeRemovable()||!this.currentNode.isCasier()||!t.isCasier())}isNodesSelected(){const t=this.tree.treeModel.getState();return!!Object.isExists(t.selectedLeafNodeIds)&&Object.keys(t.selectedLeafNodeIds).some(i=>!0===t.selectedLeafNodeIds[i])}isNodeSelected(t){const i=this.tree.treeModel.getState();return!!Object.isExists(i.selectedLeafNodeIds)&&Object.keys(i.selectedLeafNodeIds).some(n=>t.id===n&&!0===i.selectedLeafNodeIds[n])}toggleNodeToSelection(t){const i=this.tree.treeModel.getState();let n={...i.selectedLeafNodeIds};this.isNodeSelected(t)?delete n[t.id]:(Object.isExists(n)||(n={}),n[t.id]=!0),this.tree.treeModel.setState({...i,selectedLeafNodeIds:n})}toggleNodesSelected(){if(this.isNodesSelected())this.removeNodesSelected();else{const t=this.tree.treeModel.getState(),i={...t.selectedLeafNodeIds};this.currentNode.children.forEach(n=>{i[n.id]=!0}),this.tree.treeModel.setState({...t,selectedLeafNodeIds:i})}}removeNodesSelected(){const t=this.tree.treeModel.getState();Object.isExists(t.selectedLeafNodeIds)&&this.tree.treeModel.setState({...t,selectedLeafNodeIds:{}})}deleteCopySelection(){this.removeNodesSelected(),this.clipboardCloudService.clipboardContent=void 0}renameNode(t){if("CASIER"===t.libelle)return void this.uiService.notifyEvent(d.DOJ.genericError,"Vous ne pouvez pas renommer votre casier","Erreur","fa fa-warning");const i={title:`Renommer ${t.libelle}`,message:"Nouveau nom",btnConfirm:"Valider",initialValue:t.libelle},n={id:this.modalService.getModalsCount()+1,initialState:i};this.modalService.show(c.I,n),this.modalService.onHide.pipe((0,w.q)(1),(0,L.w)(l=>{this.loader=this.loaderService.show(this.componentUniqID),this.cd.markForCheck();const g=c.I.afterClosed(l,ue);return Object.isExists(g)?g.error?(this.uiService.notifyEvent(d.DOJ.genericError,g.error,"Erreur","fa fa-warning"),T.E):g.reason!==r.G.validation?T.E:this.cloudService.updateFile(this.entity.id,this.entity.type,new d.EiA({...t,libelle:g.saisie,displayText:g.saisie}),this.currentNode):T.E}),(0,x.b)(l=>{this.updateNode(this.currentNode.id,new d.mCH(l),t.id),this.updateNodeState(this.currentNode.id),this.cd.detectChanges(),this.uiService.notifyEvent(d.DOJ.genericSuccess,"L'\xe9l\xe9ment a bien \xe9t\xe9 renomm\xe9","Renommage","icon-ed_cloud","CloudComponent")}),(0,S.K)(()=>(this.uiService.notifyEvent(d.DOJ.genericError,"Renommage impossible","Erreur","fa fa-warning"),T.E)),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}removeNode(t){if(0===t.length)return void this.uiService.notifyEvent(d.DOJ.genericError,"Vous devez s\xe9lectionner au moins un fichier / dossier \xe0 supprimer","Erreur","fa fa-warning");if(t.findIndex(l=>"CASIER"===l.libelle)>-1)return void this.uiService.notifyEvent(d.DOJ.genericError,"Vous ne pouvez pas supprimer votre casier","Erreur","fa fa-warning");let i=`\xcates-vous s\xfbr de vouloir <strong>supprimer</strong>${t.length>1?" les \xe9l\xe9ments suivants ":" l'\xe9l\xe9ment suivant "}?<ul class="cloud-list-delete">`;t.forEach(l=>{i+=`<li> ${l.type===d.Vav.FICHIER_FOLDER?'<i class="fa fa-folder"></i>':'<i class="fa fa-file"></i>'} `,i+=l.libelle,Array.isArray(l.children)&&l.children.length>0&&(i+='<span class="text-warning"> - Ce dossier ainsi que l\'int\xe9gralit\xe9 de son contenu seront supprim\xe9s !</span>'),i+="</li>"});const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Suppression "+(t.length>1?"d'\xe9l\xe9ments":"d'un \xe9l\xe9ment"),message:i,btnConfirm:"Valider"}};this.modalService.show(m.z,n),this.modalService.onHide.pipe((0,w.q)(1),(0,x.b)(l=>{l===r.G.validation&&(this.loader=this.loaderService.show(this.componentUniqID),this.cd.markForCheck(),this.cloudService.deleteNode(this.entity.id,this.entity.type,t,this.currentNode.id).pipe((0,x.b)(g=>{t.forEach(y=>d.VEx.deleteNode(this.store[0],this.currentNode.id,y.id)),this.store=[new d.mCH(this.store[0])],this.store[0].taille-=g,this.store[0].taille<0&&(this.store[0].taille=0),this.updateNodeState(this.currentNode.id),this.deleteCopySelection(),this.uiService.notifyEvent(d.DOJ.genericSuccess,"Les \xe9l\xe9ments ont bien \xe9t\xe9 supprim\xe9s","Suppression","icon-ed_cloud","CloudComponent"),this.successRemove.emit(t)}),(0,S.K)(()=>(this.uiService.notifyEvent(d.DOJ.genericError,"Suppression impossible","Erreur","fa fa-warning"),T.E)),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe())})).subscribe()}onDrop(t,i){if(!Object.isExists(i))return;const n=new d.EiA(t);if("CASIER"===n.libelle||n.isFolder()&&n.children.findIndex(g=>"CASIER"===g.libelle)>-1)return void this.uiService.notifyEvent(d.DOJ.genericError,"Vous ne pouvez pas d\xe9placer votre casier","Erreur","fa fa-warning");if(this.modeTeleversement===d.qt_.CLOUD&&i.isCasier()||"ro"===this.droitsRW||!i.isFolder()||n.id===i.id)return;if(0===i.id.indexOf(n.id))return void this.uiService.notifyEvent(d.DOJ.genericError,"D\xe9placement impossible","Erreur","fa fa-warning");const l=this.tree.treeModel.getNodeById(t.id).parent;this.loader=this.loaderService.show(this.componentUniqID),this.cloudService.pasteNode(this.entity.id,this.entity.type,[n],this.tree.treeModel.getFirstRoot().id,this.entity.id,this.entity.type,this.store,i).pipe((0,L.w)(g=>{const y=new d.mCH(g);return this.isRootNode(y)?(y.isExpanded=!0,y.displayText=this.entity.libelle,this.store=[y],this.store[0].taille-=n.taille,this.store[0].taille<0&&(this.store[0].taille=0)):(d.VEx.updatedNode(this.store[0],i.id,y.id,y),this.store=[new d.mCH(this.store[0])]),this.cloudService.deleteNode(this.entity.id,this.entity.type,[n],l.id)}),(0,x.b)(g=>{l&&(d.VEx.deleteNode(this.store[0],l.id,t.id),this.store=[new d.mCH(this.store[0])],this.updateNodeState(l.id)),this.uiService.notifyEvent(d.DOJ.genericSuccess,`Les \xe9l\xe9ments ont bien \xe9t\xe9 d\xe9plac\xe9s dans ${i.libelle}`,"D\xe9placement","icon-ed_cloud","CloudComponent")}),(0,S.K)(g=>this.uiService.notifyErrorThenEmpty(g,!0,"D\xe9placement impossible","fa fa-warning")),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}updateNodeState(t,i,n=!1){const l=this.tree.treeModel.getState(),g=!0===n?{}:{...l.expandedNodeIds};Object.isExists(i)&&(g[t]=n||i),this.tree.treeModel.setState({...l,activeNodeIds:{[t]:!0},expandedNodeIds:g,focusedNodeId:t,selectedLeafNodeIds:{}})}breadcrumbs(){const t=[],i=this.tree.treeModel.getFocusedNode();if(this.currentNode)if(i){t.push(i.data);let n=i.parent;for(;Object.isExists(n)&&n.level>0;)t.unshift(n.data),n=n.parent}else t.push(this.tree.treeModel.getFirstRoot().data);return t}displayPadModal(t){const i={file:t,currentFolder:this.currentNode,idEntity:this.entity.id,typeEntity:this.entity.type},n={id:this.modalService.getModalsCount()+1,initialState:i,ignoreBackdropClick:!0,class:"modal-lg"};this.modalService.show(le,n).content.onClose$.pipe((0,w.q)(1)).subscribe(g=>{this.updateNode(this.currentNode.id,new d.mCH(g)),this.updateNodeState(this.currentNode.id)})}displayUrlFileModal(t){const i={file:t,currentFolder:this.currentNode,droitsRW:this.modeTeleversement===d.qt_.CLOUD&&this.currentNode.isCasier()?"ro":this.droitsRW,idEntity:this.entity.id,typeEntity:this.entity.type,modeTeleversement:this.modeTeleversement,uploadAdditionalParams:this.dropZoneConfig.params},n={id:this.modalService.getModalsCount()+1,initialState:i,ignoreBackdropClick:!0};this.modalService.show(a,n).content.onClose$.pipe((0,w.q)(1)).subscribe(g=>{Object.isExists(t)?this.updateNode(this.currentNode.id,new d.mCH(g),t.id):(this.updateNode(this.currentNode.id,new d.mCH(g)),this.successUpload.emit(g)),this.updateNodeState(this.currentNode.id),this.cd.detectChanges()})}updateNode(t,i,n){d.VEx.updatedNode(this.store[0],t,typeof n<"u"?n:i.id,i),this.store=[new d.mCH(this.store[0])]}addDossier(){const i={id:this.modalService.getModalsCount()+1,initialState:{title:"Nom de votre dossier",message:"Quel est le nom de votre dossier ?",btnConfirm:"Valider",initialValue:""}};this.modalService.show(c.I,i),this.modalService.onHide.pipe((0,w.q)(1),(0,L.w)(n=>{this.loader=this.loaderService.show(this.componentUniqID);const l=c.I.afterClosed(n,ue);return Object.isExists(l)?l.error?(this.uiService.notifyEvent(d.DOJ.genericError,l.error,"Erreur","fa fa-warning"),T.E):l.reason!==r.G.validation?T.E:this.cloudService.addExternalRessource(this.entity.id,this.entity.type,d.Vav.FICHIER_FOLDER,l.saisie,this.currentNode):T.E}),(0,x.b)(n=>{this.onUploadSuccess(n),this.uiService.notifyEvent(d.DOJ.genericSuccess,"Le dossier a bien \xe9t\xe9 ajout\xe9","Ajouter un dossier","icon-ed_cloud")}),(0,S.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Erreur","fa fa-warning")),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}onUploadSuccess(t){const i=new d.mCH(t);this.store[0].taille+=i.taille,this.updateNode(this.currentNode.id,i),this.updateNodeState(this.currentNode.id),this.cloudService.clearCacheCloudContent(this.entity.id,this.entity.type,this.currentNode.id),this.entity.type===d.dcH.ESPACE_TRAVAIL&&this.espaceDeTravailStore.updateFilActivitesStore(this.entity.id,d.VXF.ESPACE_TRAVAIL_TYPE_ACTIVITE_UPDATE,d.VXF.CIBLE_CLOUD),this.remplace&&(this.cloudService.clearCacheBlobFile(i.id),this.remplace=!1,this.dropZoneConfig={...this.dropZoneConfig,params:{...this.dropZoneConfig.params,remplace:!1}},this.uiService.notifyEvent(d.DOJ.genericSuccess,"La modification du pdf a bien \xe9t\xe9 effectu\xe9e","Modification pdf","icon-ed_cloud")),this.successUpload.emit(i)}onDragStart(t){Object.isExists(this.inputFiles)&&this.inputFiles.myDropzone.disable()}onDragEnd(t){Object.isExists(this.inputFiles)&&this.inputFiles.myDropzone.enable()}displayNewCalloboraFileModal(t){const i={typeFile:t},n={id:this.modalService.getModalsCount()+1,initialState:i};this.modalService.show(A,n),this.modalService.onHide.pipe((0,w.q)(1),(0,L.w)(l=>{this.loader=this.loaderService.show(this.componentUniqID),this.cd.markForCheck();const g=c.I.afterClosed(l,ue);return Object.isExists(g)?g.error?(this.uiService.notifyEvent(d.DOJ.genericError,g.error,"Erreur","fa fa-warning"),T.E):g.reason!==r.G.validation?T.E:this.cloudService.addExternalRessource(this.entity.id,this.entity.type,d.Vav.FICHIER_FILE,g.saisie,this.currentNode):T.E}),(0,x.b)(l=>{this.updateNode(this.currentNode.id,new d.mCH(l)),this.updateNodeState(this.currentNode.id),this.uiService.notifyEvent(d.DOJ.genericSuccess,"L'\xe9l\xe9ment a bien \xe9t\xe9 ajout\xe9","Ajout","icon-ed_cloud","CloudComponent"),this.successUpload.emit(l);const g={id:this.modalService.getModalsCount()+1,class:"modal-xlg modal-lightbox",ignoreBackdropClick:!0,initialState:{file:l,readonly:!1,typeFichier:d.Vav.FICHIER_CLOUD}};this.modalService.show(b.i,g)}),(0,S.K)(l=>(this.uiService.notifyEvent(d.DOJ.genericError,d.FSr.isNotEmptyString(l.message)?l.message:"Ajout impossible","Erreur","fa fa-warning"),T.E)),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe()}isRootNode(t){return"/"===t.libelle||""!==this.rootFolder&&t.id.endsWith(this.rootFolder)||t.id===this.tree.treeModel.getFirstRoot().id}trackByFn(){return(new N.$).transform("id")}transcodeVideo(t){let i="<p>\xcates-vous s\xfbr de vouloir <strong>convertir</strong> le fichier</p>";i+=`<ul class="cloud-list-delete"><li><i class="fa fa-file"></i> ${t.libelle}</li></ul><br />`,i+='<p>au format streaming ?</p><br /><p class="text-warning">Attention : la conversion du fichier supprimera la version initiale du fichier</p>';const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Conversion streaming",message:i,btnConfirm:"Valider"}};this.modalService.show(m.z,n),this.modalService.onHide.pipe((0,w.q)(1),(0,x.b)(l=>{l===r.G.validation&&(this.loader=this.loaderService.show(this.componentUniqID),this.cloudService.transcodeVideoToStreaming(this.entity.id,this.entity.type,t,this.currentNode).pipe((0,x.b)(g=>{this.onUploadSuccess(g),d.VEx.deleteNode(this.store[0],this.currentNode.id,t.id),this.store=[new d.mCH(this.store[0])],this.updateNodeState(this.currentNode.id),this.uiService.notifyEvent(d.DOJ.genericSuccess,"La vid\xe9o est en cours de conversion","Conversion","icon-ed_cloud","CloudComponent"),this.getStreamingFilesStatus()}),(0,S.K)(()=>(this.uiService.notifyEvent(d.DOJ.genericError,"Conversion impossible","Erreur","fa fa-warning"),T.E)),(0,D.x)(()=>this.loaderService.hide(this.componentUniqID))).subscribe())})).subscribe()}getStreamingFilesStatus(){this.timerStreamingStatusId=+setTimeout(()=>{this.cloudService.getStreamingFilesStatus(this.entity.id,this.entity.type,this.currentNode).pipe((0,x.b)(t=>{this._transcodingJobStatus$.next(t)}),(0,S.K)(()=>T.E),(0,D.x)(()=>{this._transcodingJobStatus$.value.filter(i=>i.isStreamingTranscoding).length>0?this.getStreamingFilesStatus():clearTimeout(this.timerStreamingStatusId)})).subscribe()},1e4)}ctxtMenuCopyNode(t){const i=this.tree.treeModel.getState();Object.isExists(i.selectedLeafNodeIds)&&Object.keys(i.selectedLeafNodeIds).findIndex(l=>t.id===l&&!0===i.selectedLeafNodeIds[l])>-1||(this.deleteCopySelection(),this.toggleNodeToSelection(t)),this.copyToClipboard()}ctxtMenuRemoveNode(t){const i=this.tree.treeModel.getState(),n=[];Object.isExists(i.selectedLeafNodeIds)&&Object.keys(i.selectedLeafNodeIds).findIndex(g=>t.id===g&&!0===i.selectedLeafNodeIds[g])>-1?Object.keys(i.selectedLeafNodeIds).forEach(g=>{const y=this.tree.treeModel.getNodeById(g);Object.isExists(y)&&n.push(y.data)}):n.push(t),n.length>0&&(this.removeNode(n),this.deleteCopySelection())}removeSelectedNodes(){const t=this.tree.treeModel.getState(),i=[];Object.isExists(t.selectedLeafNodeIds)&&Object.keys(t.selectedLeafNodeIds).forEach(n=>{const l=this.tree.treeModel.getNodeById(n);Object.isExists(l)&&i.push(l.data)}),i.length>0&&this.removeNode(i)}televerseObj(t){this.remplace=!0,this.objToTeleverseInInput=t}onTreeViewInitialized(){this.treeViewInitialized=!0,this.refreshNode(void 0,!0,!0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.CnD),e.Y36(d.eyc),e.Y36(z.S),e.Y36(d.VLf),e.Y36(q.tT),e.Y36(e.sBO),e.Y36(F),e.Y36(d.EYm))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ed-cloud"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Q.qr,5),e.Gf(h.s,5)),2&t){let n;e.iGM(n=e.CRH())&&(i.tree=n.first),e.iGM(n=e.CRH())&&(i.inputFiles=n.first)}},inputs:{entity:"entity",rootFolder:"rootFolder",droitsRW:"droitsRW",displayFull:"displayFull",modeTeleversement:"modeTeleversement",dropZoneConfig:"dropZoneConfig",inputFilesConfig:"inputFilesConfig"},outputs:{successUpload:"successUpload",successCopy:"successCopy",successRemove:"successRemove"},features:[e.qOj,e.TTD],ngContentSelectors:bt,decls:14,vars:16,consts:[[1,"ed-container","cloud",3,"ngClass","ngBusy"],[4,"ngIf"],[1,"margin-top-10","cloud-content","row","clearfix",3,"ngStyle"],["id","sidebar-menu",1,"col-xl-2","col-lg-4","col-sm-4","treeview-container","d-none",3,"ngClass"],["boundary",""],["spacer",""],["edSticky","",1,"tree-classic",3,"spacerElement","boundaryElement"],[3,"nodes","options","activate","updateData","initialized"],["tree",""],["treeNodeTemplate",""],["class","col-12 dropzone-container simple-padding","id","dropzoneContainer",3,"ngClass",4,"ngIf"],["id","footer-cloud"],["class","form-text",4,"ngIf"],["class","float-end","id","quota",4,"ngIf"],["id","quota",1,"float-end"],["type","semi",3,"value","size","thick","min","max","thresholds"],[1,"form-text"],["dndDropzone","",3,"dndDrop"],["id","dropzoneContainer",1,"col-12","dropzone-container","simple-padding",3,"ngClass"],[1,"float-end","action-buttons"],["id","bc1","class","btn-group btn-breadcrumb float-start",4,"ngIf"],[1,"clearfix"],[1,"table",2,"margin-top","10px"],[1,"bloc-right","table"],["noItemText","Le dossier est vide",3,"datas","trackByFn"],["edSmartTableHeaderTmp",""],["edSmartTableBodyTmp",""],["contextSource","cloud",3,"fileToTeleverse","dropzoneConfig","remplace","checkFileSizeFn","config","successUpload",4,"ngIf"],["title","T\xe9l\xe9charger la s\xe9lection","type","button","edTelechargement","",1,"btn","btn-copy",3,"tabFileId","fileType"],["aria-hidden","true",1,"fa","fa-download","align-middle"],["title","Supprimer","class","btn btn-copy","type","button",3,"click",4,"ngIf"],["title","Copier","class","btn btn-copy","type","button",3,"click",4,"ngIf"],["title","Supprimer","type","button",1,"btn","btn-copy",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger"],["title","Copier","type","button",1,"btn","btn-copy",3,"click"],["aria-hidden","true",1,"fa","fa-copy"],["class","btn btn-paste margin-whitespace","type","button","title","Coller",3,"click",4,"ngIf"],["type","file","id","inputFile","multiple","",1,"fileinput"],["id","btn-ajouter-fichier","type","button",1,"btn","btn-primary","white","fileinput-button","margin-whitespace"],["aria-hidden","true",1,"fa","fa-upload"],["id","btn-ajouter-dossier","type","button","class","btn btn-primary white margin-whitespace",3,"click",4,"ngIf"],["class","btn-group margin-whitespace","dropdown","",3,"isAnimated",4,"ngIf","ngIfElse"],["menuNoCollabora",""],["type","button","title","Coller",1,"btn","btn-paste","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-paste"],["id","btn-ajouter-dossier","type","button",1,"btn","btn-primary","white","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-folder"],["dropdown","",1,"btn-group","margin-whitespace",3,"isAnimated"],["dropdownToggle","","id","dropdownMenuNewFile","aria-controls","dropdownNewfile",1,"btn","btn-primary","white","dropdown-toggle"],["aria-hidden","true",1,"fa","fa-file"],["aria-labelledby","dropdownMenuNewFile","id","dropdownNewfile","class","dropdown-menu","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuNewFile","id","dropdownNewfile","role","menu",1,"dropdown-menu"],["role","menuitem",1,"list-elem-cours"],["type","button",1,"dropdown-item",3,"click"],["aria-hidden","true",1,"fa","fa-file-word-o"],["aria-hidden","true",1,"fa","fa-file-excel-o"],["aria-hidden","true",1,"fa","fa-file-powerpoint-o"],["aria-hidden","true",1,"fa","fa-link"],["type","button","class","dropdown-item",3,"click",4,"ngIf"],["aria-hidden","true",1,"icon-ed_pad"],["id","btn-ajouter-url","type","button",1,"btn","btn-primary","white","margin-whitespace",3,"click"],["id","btn-ajouter-pad","class","btn btn-primary white margin-whitespace","type","button",3,"click",4,"ngIf"],["id","btn-ajouter-pad","type","button",1,"btn","btn-primary","white","margin-whitespace",3,"click"],["id","bc1",1,"btn-group","btn-breadcrumb","float-start"],[4,"ngFor","ngForOf","ngForTrackBy"],["aria-label","racine du cloud","type","button","class","btn btn-link d-print-none",3,"click",4,"ngIf"],["type","button",3,"class","click",4,"ngIf"],["aria-label","racine du cloud","type","button",1,"btn","btn-link","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-home"],["class","prenom-eleve margin-whitespace",4,"ngIf"],[1,"prenom-eleve","margin-whitespace"],["type","button",3,"click"],[1,"screen-reader"],["title","S\xe9lectionner tout/ D\xe9s\xe9lectionner tout","type","checkbox","name","selectAllNodes",1,"form-check-input",3,"checked","click"],["stSort","libelle",1,"sortable-header",2,"width","49%"],["stSort","date",1,"sortable-header",2,"width","15%"],["stSort","proprietaire",1,"sortable-header"],["stSort","taille",1,"sortable-header",2,"width","5%"],["ed-cloud-tr","","dndDropzone","",3,"entity","node","tree","isSelected","isStreamingActif","isCollaboraActif","isCollaboraEditable","modeTeleversement","droitsRW","canDeleteNode","transcodingJobStatus$","dndDraggable","dndDisableDragIf","ngClass","openNode","toggleNodeToSelection","displayPadModal","displayUrlFileModal","renameNode","copyNode","removeNode","televersementObj","transcode","dndStart","dndEnd","dndDrop"],["contextSource","cloud",3,"fileToTeleverse","dropzoneConfig","remplace","checkFileSizeFn","config","successUpload"]],template:function(t,i){if(1&t&&(e.F$t(gt),e.TgZ(0,"div",0),e.YNc(1,qe,8,6,"ng-container",1),e.TgZ(2,"div",2)(3,"div",3,4),e._UZ(5,"div",null,5),e.TgZ(7,"div",6)(8,"tree-root",7,8),e.NdJ("activate",function(l){return i.openNode(l.node.data)})("updateData",function(){return i.updateData()})("initialized",function(){return i.onTreeViewInitialized()}),e.YNc(10,Qe,3,1,"ng-template",null,9,e.W1O),e.qZA()()(),e.YNc(12,ht,13,10,"div",10),e.qZA(),e._UZ(13,"div",11),e.qZA()),2&t){const n=e.MAs(4),l=e.MAs(6);e.Q6J("ngClass",e.VKq(10,ft,i.displayFull))("ngBusy",i.loader),e.xp6(1),e.Q6J("ngIf",i.displayFull),e.xp6(1),e.Q6J("ngStyle",e.VKq(12,mt,i.displayFull?"75vh":"unset")),e.xp6(1),e.Q6J("ngClass",e.VKq(14,_t,i.displayFull)),e.xp6(4),e.Q6J("spacerElement",l)("boundaryElement",n),e.xp6(1),e.Q6J("nodes",i.store)("options",i.treeViewConfig),e.xp6(4),e.Q6J("ngIf",i.treeViewInitialized)}},dependencies:[v.mk,v.sg,v.O5,v.PC,U.Hz,U.Mq,U.TO,I.DC,J.L,P.c,$.r,$.w,Q.qr,ie.x,ne.z,h.s,X.EO,X.yg,X.b4,oe.jk,oe.Q4,ke,d.dYR,N.$],styles:['.cloud ed-smart-table table.table tbody tr td{padding:0 5px;font-size:13px}.cloud ed-smart-table table.table tbody tr td button.streaming-link i{margin-left:5px;font-size:1.5em}.cloud ed-smart-table table.table tbody tr td button>img{vertical-align:text-bottom}.cloud ed-smart-table table.table tbody tr td.disabled{background-color:var(--smalldark-placeholder-color);opacity:.5}.cloud ed-smart-table table.table tbody tr td.disabled td{cursor:default}.cloud ed-smart-table table.table tbody tr td.disabled td a{cursor:inherit}.cloud ed-smart-table table.table tbody tr td.disabled td a:hover{text-decoration:none}.cloud .st-selected{background:#216eff!important;color:#fff!important}.cloud .sortable-header{cursor:pointer}.cloud .draggable{cursor:move}.cloud .on-dragging{border:2px solid lightblue;box-shadow:10px 10px 5px #656565;-moz-box-shadow:10px 10px 5px #656565;-webkit-box-shadow:10px 10px 5px #656565}.cloud tr.folder.dndDragover{background:#c2ffce;box-shadow:inset 0 0 1px #999}.cloud tr.folder.dndDragover:nth-of-type(odd){background:#c2ffce;box-shadow:inset 0 0 1px #999}.cloud div.folder-view{margin:20px 0}.cloud .tree-classic{margin-top:22px;overflow:auto;max-height:75vh;line-height:1}.cloud .tree-classic .angular-tree-component{font-size:13px;width:inherit;overflow:hidden}.cloud .tree-classic .angular-tree-component .tree-children{padding-left:10px}.cloud .tree-classic .node-drop-slot{display:none}.cloud .tree-classic .toggle-children{padding:0 12px;background:url(folder.6431f16d608dd0aa.png) no-repeat;background-size:23px 23px;height:28px}.cloud .tree-classic .toggle-children-wrapper-expanded .toggle-children{background:url(folder-open.888f5701e8118372.png) no-repeat;background-size:23px 23px;transform:none}.cloud .tree-classic .node-wrapper{align-items:center}.cloud .tree-classic .node-content-wrapper{padding:0}.cloud .tree-classic .node-content-wrapper.is-dragging-over-disabled{opacity:1}.cloud .tree-classic .node-content-wrapper:hover{background:unset;box-shadow:none}.cloud .tree-classic .node-content-wrapper-focused{box-shadow:none}.cloud .tree-classic .node-content-wrapper-active{box-shadow:none;background-color:unset;font-weight:700}.cloud .tree-classic .node-content-wrapper-active span:after{content:"\\f00c";font-family:FontAwesome;font-style:normal;font-weight:400;margin-left:10px;color:var(--secondary-color)}.cloud .btn-breadcrumb .btn.btn-link{background:#fff;padding:9px 12px 6px 24px;margin-left:0}.cloud .btn-breadcrumb .btn.btn-link:first-child{color:var(--light-primary-color)}.cloud .btn-breadcrumb .btn.btn-link:first-child:hover,.cloud .btn-breadcrumb .btn.btn-link:first-child:focus{color:var(--light-primary-color)}.cloud .btn-breadcrumb .btn.btn-link:first-child .prenom-eleve{color:#000}.cloud .btn-breadcrumb .btn.btn-link.currentBread{background-color:inherit;font-weight:700}.cloud .btn-breadcrumb .btn.btn-link+.btn{margin-left:0}.cloud .btn-breadcrumb .btn.btn-link:hover{background:#ebebeb;text-decoration:none}.cloud .btn-breadcrumb .btn.btn-link:focus{text-decoration:none}.cloud .btn-breadcrumb .btn.btn-link:not(:last-child):after{content:" ";display:block;width:0;height:0;border-top:17px solid transparent;border-bottom:17px solid transparent;border-left:10px solid white;position:absolute;top:50%;margin-top:-17px;left:100%;z-index:3}.cloud .btn-breadcrumb .btn.btn-link:not(:last-child):before{content:" ";display:block;width:0;height:0;border-top:17px solid transparent;border-bottom:17px solid transparent;border-left:10px solid rgb(173,173,173);position:absolute;top:50%;margin-top:-17px;margin-left:1px;left:100%;z-index:3}.cloud .btn-breadcrumb .btn.btn-link:first-child{padding:6px 6px 6px 10px}.cloud .btn-breadcrumb .btn.btn-link:last-child{padding:9px 18px 6px 24px}.cloud .btn-breadcrumb .btn.btn-secondary:not(:last-child):after{border-left:10px solid #fff}.cloud .btn-breadcrumb .btn.btn-secondary:not(:last-child):before{border-left:10px solid var(--dark-placeholder-color)}.cloud .btn-breadcrumb .btn.btn-secondary:hover:not(:last-child):after{border-left:10px solid #ebebeb}.cloud .btn-breadcrumb .btn.btn-secondary:hover:not(:last-child):before{border-left:10px solid #adadad}.cloud .btn-breadcrumb>*>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cloud .btn-breadcrumb>*:nth-child(n+2){display:none}.cloud .dropzone-container img{max-width:22px}.cloud ul ul{padding-left:15px}.cloud .fileinput{opacity:0;width:222px;position:fixed;right:260px}.cloud .action-buttons button i:not(.text-danger){color:var(--light-primary-color)}.cloud .action-buttons button.white i{color:#fff}.cloud .action-buttons button.btn{position:relative}.cloud .action-buttons button.btn-copy,.cloud .action-buttons button.btn-paste{background:none;outline:none}.cloud .action-buttons button.btn-copy:hover,.cloud .action-buttons button.btn-copy:focus,.cloud .action-buttons button.btn-paste:hover,.cloud .action-buttons button.btn-paste:focus{border-color:transparent}.cloud button:not(.white) i:not(.text-danger),.cloud a:not(.white) i:not(.text-danger){color:var(--light-primary-color)}.cloud #sidebar-menu{padding-right:5px}.cloud .input-files form,.cloud .input-files .previews{display:none}.cloud ul.cloud-list-delete{margin-top:10px;margin-left:20px;word-break:break-all}.cloud .modal-body div.tree-classic{max-width:100%}@media (max-width: 767px){.cloud .btn-breadcrumb>*:nth-last-child(-n+2){display:block}.cloud .btn-breadcrumb>* div{max-width:60px}}@media (min-width: 768px) and (max-width: 991px){.cloud .btn-breadcrumb>*:nth-last-child(-n+4){display:block}.cloud .btn-breadcrumb>* div{max-width:100px}}@media (min-width: 992px){.cloud .btn-breadcrumb>*:nth-last-child(-n+6){display:block}.cloud .btn-breadcrumb>* div{max-width:170px}}.cloud div#url-file-modal div.modal-body.text-center h2{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cloud div#quota{width:200px;height:110px}.cloud div#quota ngx-gauge-value,.cloud div#quota ngx-gauge-append{color:#b3b3b3}.cloud div#quota ngx-gauge-value{font-size:.5em}.cloud div#quota ngx-gauge-append{font-size:.6em}\n'],encapsulation:2}),o})()},21703:(ce,Y,f)=>{f.d(Y,{Q4:()=>ae,c8:()=>C,jk:()=>M});var e=f(94650),O=f(36895);const T=["move","copy","link"],x="application/x-dnd",k="application/json",S="Text";function D(s){return s.substr(0,x.length)===x}function w(s){if(s.dataTransfer){const a=s.dataTransfer.types;if(!a)return S;for(let r=0;r<a.length;r++)if(a[r]===S||a[r]===k||D(a[r]))return a[r]}return null}function d(s,a){return"all"===a||"uninitialized"===a?s:s.filter(function(r){return-1!==a.toLowerCase().indexOf(r)})}function q(s,a){const r=window.getComputedStyle(a),c=parseFloat(r.paddingTop)||0,h=parseFloat(r.paddingLeft)||0,m=parseFloat(r.borderTopWidth)||0,b=parseFloat(r.borderLeftWidth)||0;return{x:s.offsetX+h+b,y:s.offsetY+c+m}}const v={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function I(){v.isDragging=!1,v.dropEffect=void 0,v.effectAllowed=void 0,v.type=void 0}function j(s,a){!0===v.isDragging&&(v.dropEffect=a),s.dataTransfer&&(s.dataTransfer.dropEffect=a)}function B(s,a){let c=d(T,s.dataTransfer?s.dataTransfer.effectAllowed:"uninitialized");return!0===v.isDragging&&(c=d(c,v.effectAllowed)),a&&(c=d(c,a)),0===c.length?"none":s.ctrlKey&&-1!==c.indexOf("copy")?"copy":s.altKey&&-1!==c.indexOf("link")?"link":c[0]}function G(s){if(!0===v.isDragging)return v.type;const a=w(s);return null!==a&&a!==S&&a!==k&&a.substr(x.length+1)||void 0}function V(){return!1===v.isDragging}const K=v;let M=(()=>{class s{constructor(r,c,h){this.elementRef=r,this.renderer=c,this.ngZone=h,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=q,this.dndStart=new e.vpe,this.dndDrag=new e.vpe,this.dndEnd=new e.vpe,this.dndMoved=new e.vpe,this.dndCopied=new e.vpe,this.dndLinked=new e.vpe,this.dndCanceled=new e.vpe,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=m=>this.onDrag(m)}set dndDisableIf(r){this.draggable=!r,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(r){this.dndDisableIf=r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&I()}onDragStart(r){if(!1===this.draggable||typeof this.dndHandle<"u"&&typeof r._dndUsingHandle>"u")return!1;(function _(s,a,r){v.isDragging=!0,v.dropEffect="none",v.effectAllowed=a,v.type=r,s.dataTransfer&&(s.dataTransfer.effectAllowed=a)})(r,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function L(s,a,r){const c=x+(a.type?"-"+a.type:""),h=JSON.stringify(a);try{var m;null===(m=s.dataTransfer)||void 0===m||m.setData(c,h)}catch{try{var b;null===(b=s.dataTransfer)||void 0===b||b.setData(k,h)}catch{var N;const A=d(T,r);s.dataTransfer&&(s.dataTransfer.effectAllowed=A[0]),null===(N=s.dataTransfer)||void 0===N||N.setData(S,h)}}}(r,{data:this.dndDraggable,type:this.dndType},K.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),(typeof this.dndDragImageElementRef<"u"||typeof r._dndUsingHandle<"u")&&function z(s,a,r){const c=r(s,a)||{x:0,y:0};s.dataTransfer.setDragImage(a,c.x,c.y)}(r,this.dragImage,this.dndDragImageOffsetFunction);const c=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),c()});return this.dndStart.emit(r),r.stopPropagation(),!0}onDrag(r){this.dndDrag.emit(r)}onDragEnd(r){let h;switch(K.dropEffect){case"copy":h=this.dndCopied;break;case"link":h=this.dndLinked;break;case"move":h=this.dndMoved;break;default:h=this.dndCanceled}h.emit(r),this.dndEnd.emit(r),I(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),r.stopPropagation()}registerDragHandle(r){this.dndHandle=r}registerDragImage(r){this.dndDragImageElementRef=r}determineDragImage(){return typeof this.dndDragImageElementRef<"u"?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(e.R0b))},s.\u0275dir=e.lG2({type:s,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(r,c){1&r&&e.NdJ("dragstart",function(m){return c.onDragStart(m)})("dragend",function(m){return c.onDragEnd(m)}),2&r&&e.uIk("draggable",c.draggable)},inputs:{dndDraggable:"dndDraggable",dndEffectAllowed:"dndEffectAllowed",dndType:"dndType",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),s})(),se=(()=>{class s{constructor(r){this.elementRef=r}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(e.SBq))},s.\u0275dir=e.lG2({type:s,selectors:[["","dndPlaceholderRef",""]]}),s})(),ae=(()=>{class s{constructor(r,c,h){this.ngZone=r,this.elementRef=c,this.renderer=h,this.dndDropzone="",this.dndEffectAllowed="uninitialized",this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new e.vpe,this.dndDrop=new e.vpe,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=m=>this.onDragEnter(m),this.dragOverEventHandler=m=>this.onDragOver(m),this.dragLeaveEventHandler=m=>this.onDragLeave(m)}set dndDisableIf(r){this.disabled=!!r,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(r){this.dndDisableIf=r}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(r){if(!0===r._dndDropzoneActive)return void this.cleanupDragoverState();if(typeof r._dndDropzoneActive>"u"){const h=document.elementFromPoint(r.clientX,r.clientY);this.elementRef.nativeElement.contains(h)&&(r._dndDropzoneActive=!0)}const c=G(r);!1!==this.isDropAllowed(c)&&r.preventDefault()}onDragOver(r){if(r.defaultPrevented)return;const c=G(r);if(!1===this.isDropAllowed(c))return;this.checkAndUpdatePlaceholderPosition(r);const h=B(r,this.dndEffectAllowed);"none"!==h?(r.preventDefault(),j(r,h),this.dndDragover.emit(r),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(r){try{const c=G(r);if(!1===this.isDropAllowed(c))return;const h=function Q(s,a){const r=w(s);var c,h,m,b;return!0===a?null!==r&&D(r)?JSON.parse(null!==(c=null===(h=s.dataTransfer)||void 0===h?void 0:h.getData(r))&&void 0!==c?c:"{}"):{}:null!==r?JSON.parse(null!==(m=null===(b=s.dataTransfer)||void 0===b?void 0:b.getData(r))&&void 0!==m?m:"{}"):{}}(r,V());if(!1===this.isDropAllowed(h.type))return;r.preventDefault();const m=B(r);if(j(r,m),"none"===m)return;const b=this.getPlaceholderIndex();if(-1===b)return;this.dndDrop.emit({event:r,dropEffect:m,isExternal:V(),data:h.data,index:b,type:c}),r.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(r){if(typeof r._dndDropzoneActive>"u"){const c=document.elementFromPoint(r.clientX,r.clientY);if(this.elementRef.nativeElement.contains(c))return void(r._dndDropzoneActive=!0)}this.cleanupDragoverState(),j(r,"none")}isDropAllowed(r){if(!0===this.disabled||!0===V()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone||!r)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(r)}tryGetPlaceholder(){return typeof this.dndPlaceholderRef<"u"?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(r){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const c=function re(s,a){let r=a;for(;r.parentNode!==s;){if(!r.parentNode)return null;r=r.parentNode}return r}(this.elementRef.nativeElement,r.target);null!==c&&c!==this.placeholder&&(function te(s,a,r){const c=a.getBoundingClientRect();return r?s.clientX<c.left+c.width/2:s.clientY<c.top+c.height/2}(r,c,this.dndHorizontal)?c.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,c):c.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,c.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return s.\u0275fac=function(r){return new(r||s)(e.Y36(e.R0b),e.Y36(e.SBq),e.Y36(e.Qsj))},s.\u0275dir=e.lG2({type:s,selectors:[["","dndDropzone",""]],contentQueries:function(r,c,h){if(1&r&&e.Suo(h,se,5),2&r){let m;e.iGM(m=e.CRH())&&(c.dndPlaceholderRef=m.first)}},hostBindings:function(r,c){1&r&&e.NdJ("drop",function(m){return c.onDrop(m)})},inputs:{dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed",dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),s})(),C=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[O.ez]}),s})()},29141:(ce,Y,f)=>{f.d(Y,{EO:()=>se,b4:()=>K,ez:()=>ae,yg:()=>G});var e=f(94650),O=f(36895);const T=["canvas"],x=["rLabel"],k=["reading"];function S(p,C){1&p&&e.Hsn(0,0,["*ngSwitchCase","true"])}function D(p,C){if(1&p&&(e.ynx(0),e._uU(1),e.BQk()),2&p){const s=e.oxw();e.xp6(1),e.Oqu(s.prepend)}}function w(p,C){1&p&&e.Hsn(0,1,["*ngSwitchCase","true"])}function L(p,C){if(1&p&&(e.ynx(0),e._uU(1),e.ALo(2,"number"),e.BQk()),2&p){const s=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,s.value))}}function Q(p,C){1&p&&e.Hsn(0,2,["*ngSwitchCase","true"])}function d(p,C){if(1&p&&(e.ynx(0),e._uU(1),e.BQk()),2&p){const s=e.oxw();e.xp6(1),e.Oqu(s.append)}}function re(p,C){1&p&&e.Hsn(0,3,["*ngSwitchCase","true"])}function te(p,C){if(1&p&&(e.ynx(0),e._uU(1),e.BQk()),2&p){const s=e.oxw();e.xp6(1),e.Oqu(s.label)}}const q=[[["ngx-gauge-prepend"]],[["ngx-gauge-value"]],[["ngx-gauge-append"]],[["ngx-gauge-label"]]],z=["ngx-gauge-prepend","ngx-gauge-value","ngx-gauge-append","ngx-gauge-label"];function v(p,C,s){return Math.max(C,Math.min(s,p))}function I(p,C=0){return isNaN(parseFloat(p))||isNaN(Number(p))?C:Number(p)}function j(p){return`${p}px`}function B(p){return null!=p&&!isNaN(parseFloat(p))&&!isNaN(Number(p))}let G=(()=>{class p{}return p.\u0275fac=function(s){return new(s||p)},p.\u0275dir=e.lG2({type:p,selectors:[["ngx-gauge-append"]],exportAs:["ngxGaugeAppend"]}),p})(),V=(()=>{class p{}return p.\u0275fac=function(s){return new(s||p)},p.\u0275dir=e.lG2({type:p,selectors:[["ngx-gauge-prepend"]],exportAs:["ngxGaugePrepend"]}),p})(),K=(()=>{class p{}return p.\u0275fac=function(s){return new(s||p)},p.\u0275dir=e.lG2({type:p,selectors:[["ngx-gauge-value"]],exportAs:["ngxGaugeValue"]}),p})(),le=(()=>{class p{}return p.\u0275fac=function(s){return new(s||p)},p.\u0275dir=e.lG2({type:p,selectors:[["ngx-gauge-label"]],exportAs:["ngxGaugeLabel"]}),p})();let se=(()=>{class p{constructor(s,a){this._elementRef=s,this._renderer=a,this._size=200,this._min=0,this._max=100,this._animate=!0,this._margin=0,this._initialized=!1,this._animationRequestID=0,this.ariaLabel="",this.ariaLabelledby=null,this.type="arch",this.cap="butt",this.thick=4,this.foregroundColor="rgba(0, 150, 136, 1)",this.backgroundColor="rgba(0, 0, 0, 0.1)",this.thresholds=Object.create(null),this.markers=Object.create(null),this._value=0,this.duration=1200}get size(){return this._size}set size(s){this._size=I(s)}get margin(){return this._margin}set margin(s){this._margin=I(s)}get min(){return this._min}set min(s){this._min=I(s,0)}get animate(){return this._animate}set animate(s){this._animate=function _(p){return null!=p&&"false"!=`${p}`}(s)}get max(){return this._max}set max(s){this._max=I(s,100)}get value(){return this._value}set value(s){this._value=I(s)}ngOnInit(){this.markers&&Object.keys(this.markers).length>0&&!this._margin&&(this._margin=10)}ngOnChanges(s){const a=s.thick||s.type||s.cap||s.size;if(this._initialized){if(s.value||s.min||s.max){let c,h;s.value&&(c=s.value.currentValue,h=s.value.previousValue),this._update(c,h)}a&&(this._destroy(),this._init())}}_updateSize(){this._renderer.setStyle(this._elementRef.nativeElement,"width",j(this._getWidth())),this._renderer.setStyle(this._elementRef.nativeElement,"height",j(this._getCanvasHeight())),this._canvas.nativeElement.width=this._getWidth(),this._canvas.nativeElement.height=this._getCanvasHeight(),this._renderer.setStyle(this._label.nativeElement,"transform","translateY("+(this.size/3*2-this.size/13/4)+"px)"),this._renderer.setStyle(this._reading.nativeElement,"transform","translateY("+(this.size/2-.22*this.size/2)+"px)")}ngAfterViewInit(){this._canvas&&this._init()}ngOnDestroy(){this._destroy()}_getBounds(s){let a,r,c,h;return"semi"==s?(a=Math.PI,r=2*Math.PI,c=180,h=360):"full"==s?(a=1.5*Math.PI,r=3.5*Math.PI,c=270,h=c+360):"arch"===s&&(a=.8*Math.PI,r=2.2*Math.PI,c=144,h=396),{head:a,tail:r,start:c,end:h}}_drawShell(s,a,r,c){let h=this._getCenter(),m=this._getRadius();if(this._initialized){this._clear(),this._drawMarkersAndTicks();let b=this._getBackgroundColorRanges();if(this._context.lineWidth=this.thick,b&&b.length>0){this._context.lineCap="butt";for(let N=0;N<b.length;++N){let E=b[N];this._context.beginPath(),this._context.strokeStyle=E.backgroundColor?E.backgroundColor:E.bgOpacity?E.color:this.backgroundColor,null!=E.bgOpacity&&(this._context.globalAlpha=E.bgOpacity),this._context.arc(h.x,h.y,m,this._getDisplacement(E.start),this._getDisplacement(E.end),!1),this._context.stroke(),this._context.globalAlpha=1}}else this._context.lineCap=this.cap,this._context.beginPath(),this._context.strokeStyle=this.backgroundColor,this._context.arc(h.x,h.y,m,s,r,!1),this._context.stroke();this._drawFill(s,a,r,c)}}_drawFill(s,a,r,c){let h=this._getCenter(),m=this._getRadius();this._context.lineCap=this.cap,this._context.lineWidth=this.thick,a=Math.max(a,s),a=Math.min(a,r),this._context.lineCap=this.cap,this._context.lineWidth=this.thick,this._context.beginPath(),this._context.strokeStyle=c,this._context.arc(h.x,h.y,m,s,a,!1),this._context.stroke()}_addMarker(s,a,r,c,h,m){var b=s*Math.PI/180;h||(h=8),c||(c="line");let E=this._getCenter(),Z=this._getRadius(),A=(Z+this.thick/2+2)*Math.cos(b)+E.x,R=(Z+this.thick/2+2)*Math.sin(b)+E.y,W=(Z+this.thick/2+2+h)*Math.cos(b)+E.x,F=(Z+this.thick/2+2+h)*Math.sin(b)+E.y;if("triangle"==c){this._context.beginPath(),this._context.strokeStyle=a,this._context.moveTo(A,R),this._context.lineWidth=1;let U=s-45,J=s+45;U<0&&(U+=360),U>360&&(U-=360),J<0&&(J+=360),J>360&&(J-=360);let P=U*Math.PI/180,$=h*Math.cos(P)+A,ie=h*Math.sin(P)+R;this._context.lineTo($,ie);let ne=J*Math.PI/180,X=h*Math.cos(ne)+A,oe=h*Math.sin(ne)+R;this._context.lineTo(X,oe),this._context.lineTo(A,R),this._context.closePath(),this._context.stroke(),this._context.fillStyle=a,this._context.fill()}else this._context.beginPath(),this._context.lineWidth=.5,this._context.strokeStyle=a,this._context.moveTo(A,R),this._context.lineTo(W,F),this._context.closePath(),this._context.stroke();r&&(this._context.save(),this._context.translate(W,F),this._context.rotate((s+90)*(Math.PI/180)),this._context.textAlign="center",this._context.font=m||"13px Arial",this._context.fillText(r,0,-3),this._context.restore())}_clear(){this._context.clearRect(0,0,this._getWidth(),this._getHeight())}_getWidth(){return this.size}_getHeight(){return this.size}_getCanvasHeight(){return"arch"==this.type||"semi"==this.type?.85*this._getHeight():this._getHeight()}_getRadius(){var a=this._getCenter().x-this.thick;return this._margin>0&&(a-=this._margin),a}_getCenter(){return{x:this._getWidth()/2,y:this._getHeight()/2}}_init(){this._context=this._canvas.nativeElement.getContext("2d"),this._initialized=!0,this._updateSize(),this._create()}_destroy(){this._animationRequestID&&(window.cancelAnimationFrame(this._animationRequestID),this._animationRequestID=0),this._clear(),this._context=null,this._initialized=!1}_getForegroundColorByRange(s){const a=this._getThresholdMatchForValue(s);return a&&a.color?a.color:this.foregroundColor}_getThresholdMatchForValue(s){const a=Object.keys(this.thresholds).filter(function(r){return B(r)&&Number(r)<=s}).sort((r,c)=>Number(r)-Number(c)).reverse()[0];if(void 0!==a){const r=this.thresholds[a];return{color:r.color,backgroundColor:r.backgroundColor,bgOpacity:r.bgOpacity,start:Number(a),end:this._getNextThreshold(Number(a))}}}_getNextThreshold(s){const a=Object.keys(this.thresholds).filter(function(r){return B(r)&&Number(r)>s}).sort((r,c)=>Number(r)-Number(c));return a&&void 0!==a[0]?Number(a[0]):this.max}_getBackgroundColorRanges(){let s=0,a=[];for(;;){let r=this._getThresholdMatchForValue(s);if(!r)break;if(a.push({start:r.start,end:r.end,color:r.color,backgroundColor:r.backgroundColor,bgOpacity:r.bgOpacity}),s=r.end,s>=this.max)break}return a}_getDisplacement(s){let r=this._getBounds(this.type),c=this.min,h=this.max,m=r.head,b=v(s,this.min,this.max);return m+(r.tail-r.head)/(h-c)*(b-c)}_create(s,a){let U,r=this,h=this._getBounds(this.type),m=this.duration,b=this.min,N=this.max,E=v(this.value,this.min,this.max),Z=h.head,A=(h.tail-h.head)/(N-b),R=A*(E-b),W=h.tail,F=this._getForegroundColorByRange(E);function J(P){let $=(P=P||(new Date).getTime())-U,ie=Math.min($/m,1);r._drawShell(Z,Z+(a?(a-b)*A:0)+R*ie,W,F),r._animationRequestID&&$<m?r._animationRequestID=window.requestAnimationFrame(oe=>J(oe)):window.cancelAnimationFrame(r._animationRequestID)}r._animationRequestID&&window.cancelAnimationFrame(r._animationRequestID),this._animate?(null!=s&&null!=a&&(R=A*s-A*a),r._animationRequestID=window.requestAnimationFrame(P=>{U=P||(new Date).getTime(),J(U)})):r._drawShell(Z,Z+R,W,F)}_drawMarkersAndTicks(){if(this.markers)for(let b in this.markers){var s=Number(b),a=this._getBounds(this.type),m=this.markers[b];this._addMarker(a.start+s*((a.end-a.start)/this.max),m.color,m.label,m.type,m.size,m.font)}}_update(s,a){this._clear(),this._create(s,a)}}return p.\u0275fac=function(s){return new(s||p)(e.Y36(e.SBq),e.Y36(e.Qsj))},p.\u0275cmp=e.Xpm({type:p,selectors:[["ngx-gauge"]],contentQueries:function(s,a,r){if(1&s&&(e.Suo(r,le,5),e.Suo(r,V,5),e.Suo(r,G,5),e.Suo(r,K,5)),2&s){let c;e.iGM(c=e.CRH())&&(a._labelChild=c.first),e.iGM(c=e.CRH())&&(a._prependChild=c.first),e.iGM(c=e.CRH())&&(a._appendChild=c.first),e.iGM(c=e.CRH())&&(a._valueDisplayChild=c.first)}},viewQuery:function(s,a){if(1&s&&(e.Gf(T,7),e.Gf(x,7),e.Gf(k,7)),2&s){let r;e.iGM(r=e.CRH())&&(a._canvas=r.first),e.iGM(r=e.CRH())&&(a._label=r.first),e.iGM(r=e.CRH())&&(a._reading=r.first)}},hostAttrs:["role","slider","aria-readonly","true"],hostVars:7,hostBindings:function(s,a){2&s&&(e.uIk("aria-valuemin",a.min)("aria-valuemax",a.max)("aria-valuenow",a.value)("aria-label",a.ariaLabel)("aria-labelledby",a.ariaLabelledby),e.ekj("ngx-gauge-meter",!0))},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],size:"size",margin:"margin",min:"min",animate:"animate",max:"max",type:"type",cap:"cap",thick:"thick",label:"label",append:"append",prepend:"prepend",foregroundColor:"foregroundColor",backgroundColor:"backgroundColor",thresholds:"thresholds",markers:"markers",value:"value",duration:"duration"},features:[e.TTD],ngContentSelectors:z,decls:17,vars:16,consts:[[1,"reading-block"],["reading",""],[1,"reading-affix",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"ngSwitch"],[1,"reading-label",3,"ngSwitch"],["rLabel",""],["canvas",""]],template:function(s,a){1&s&&(e.F$t(q),e.TgZ(0,"div",0,1)(2,"u",2),e.YNc(3,S,1,0,"ng-content",3),e.YNc(4,D,2,1,"ng-container",3),e.qZA(),e.ynx(5,4),e.YNc(6,w,1,0,"ng-content",3),e.YNc(7,L,3,3,"ng-container",3),e.BQk(),e.TgZ(8,"u",2),e.YNc(9,Q,1,0,"ng-content",3),e.YNc(10,d,2,1,"ng-container",3),e.qZA()(),e.TgZ(11,"div",5,6),e.YNc(13,re,1,0,"ng-content",3),e.YNc(14,te,2,1,"ng-container",3),e.qZA(),e._UZ(15,"canvas",null,7)),2&s&&(e.Udp("font-size",.22*(a.size-2*a.margin)+"px"),e.xp6(2),e.Q6J("ngSwitch",null!=a._prependChild),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitch",null!=a._valueDisplayChild),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitch",null!=a._appendChild),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Udp("font-size",(a.size-2*a.margin)/13+"px"),e.Q6J("ngSwitch",null!=a._labelChild),e.xp6(2),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1))},dependencies:[O.RF,O.n9,O.JJ],styles:[".ngx-gauge-meter{display:inline-block;text-align:center;position:relative}.reading-block{position:absolute;width:100%;font-weight:400;white-space:nowrap;text-align:center;overflow:hidden;text-overflow:ellipsis}.reading-label{font-family:inherit;width:100%;display:inline-block;position:absolute;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:400}.reading-affix{text-decoration:none;font-size:.6em;opacity:.8;font-weight:200;padding:0 .18em}.reading-affix:first-child{padding-left:0}.reading-affix:last-child{padding-right:0}\n"],encapsulation:2}),p})(),ae=(()=>{class p{}return p.\u0275fac=function(s){return new(s||p)},p.\u0275mod=e.oAB({type:p}),p.\u0275inj=e.cJS({imports:[O.ez]}),p})()}}]);