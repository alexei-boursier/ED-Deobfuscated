"use strict";(self.webpackChunked_web=self.webpackChunked_web||[]).push([[2268],{34414:(Fe,Q,d)=>{d.d(Q,{c:()=>te});var Y=d(86852),I=d(94650),ee=d(29402);let te=(()=>{class N{constructor(P,e){this.table=P,this._el=e,this.currentSortDirection="none",this.delay=0,this.cycle=!1}get isAsc(){return"asc"===this.currentSortDirection}get isDesc(){return"desc"===this.currentSortDirection}toggle(){this._directive.toggle()}ngOnInit(){this._directive=(0,Y.W1)({table:this.table,pointer:this.pointer,cycle:!0===this.cycle||"true"===this.cycle,debounceTime:this.delay}),this._directive.onSortToggle(({direction:e,pointer:r})=>{this.currentSortDirection=r===this.pointer?e:"none"});const P=this._directive.state();this.currentSortDirection=P.pointer===this.pointer?P.direction||"asc":"none"}ngOnDestroy(){this._directive.off()}}return N.\u0275fac=function(P){return new(P||N)(I.Y36(ee.I),I.Y36(I.SBq))},N.\u0275dir=I.lG2({type:N,selectors:[["","stSort",""]],hostVars:4,hostBindings:function(P,e){1&P&&I.NdJ("click",function(){return e.toggle()}),2&P&&I.ekj("st-sort-asc",e.isAsc)("st-sort-desc",e.isDesc)},inputs:{delay:["stDebounceTime","delay"],pointer:["stSort","pointer"],cycle:["stSortCycle","cycle"]},exportAs:["stSort"]}),N})()},72268:(Fe,Q,d)=>{d.r(Q),d.d(Q,{CahierDeTexteModule:()=>la});var Y=d(29141),I=d(48262),ee=d(99658),te=d(96272),N=d(40030),V=d(56281),P=d(4477),e=d(94650),r=d(45007),_=d(24006),D=d(63900),U=d(39646),ie=d(93123),J=d(61135);class pe{constructor(s={}){Object.isExists(s.parametrage)&&(this.parametrage=new ie.D(s.parametrage)),this._periodeCDT$=new J.X(Object.isExists(s.periodeCDT)?s.periodeCDT:void 0),this.periodeCDT$=this._periodeCDT$.asObservable().pipe(r.z43)}get periodeCDT(){return this._periodeCDT$.value}selectPeriodeCDT(s){this._periodeCDT$.next(s)}reset(){this.parametrage=void 0,this.selectPeriodeCDT(void 0)}}class Ne extends pe{constructor(s={}){super(s),Object.isExists(s.correspondances)&&(this.correspondances=new r.syW(s.correspondances)),Array.isArray(s.classesGroupes)&&(this.classesGroupes=s.classesGroupes.map(t=>t.typeEntity===r.meW.CLASSE?new r.Mn7(t):new r.zJg(t))),this._selectedSlot$=new J.X(void 0),this.selectedSlot$=this._selectedSlot$.asObservable(),this._slots$=new J.X([]),this.slots$=this._slots$.asObservable(),this._filtre$=new J.X(void 0),this.filtre$=this._filtre$.asObservable(),this._selectedView$=new J.X(void 0),this.selectedView$=this._selectedView$.asObservable(),this._selectedEntity$=new J.X(void 0),this.selectedEntity$=this._selectedEntity$.asObservable()}get selectedSlot(){return this._selectedSlot$.value}get filtre(){return this._filtre$.value}get selectedView(){return this._selectedView$.value}get selectedEntity(){return this._selectedEntity$.value}selectSlot(s){this._selectedSlot$.next(s)}selectSlots(s){this._slots$.next(Array.isArray(s)?s:[])}selectFiltre(s){this._filtre$.next(s)}selectView(s){this._selectedView$.next(s)}selectEntity(s){Object.isExists(s)?this._selectedEntity$.next(s.typeEntity===r.meW.CLASSE?new r.Mn7(s):new r.zJg(s)):this._selectedEntity$.next(void 0)}reset(){super.reset(),this.classesGroupes=void 0,this.selectSlot(void 0),this.selectSlots(void 0),this.selectEntity(void 0),this.selectFiltre(void 0),this.selectView(void 0)}}class qe extends pe{constructor(s={typeVue:r.Rcf.AVENIR}){super(s),this._selectedDate$=new J.X(void 0),this.selectedDate$=this._selectedDate$.asObservable().pipe(r.z43),this.typeVue=s.typeVue}get selectedDate(){return this._selectedDate$.value}selectDate(s){this._selectedDate$.next(s)}reset(){super.reset(),this.selectDate(void 0),this.typeVue=r.Rcf.AVENIR}}let m=(()=>{class i{constructor(t,n,o){this.etablissementStore=t,this.authStore=n,this.uiService=o,this.cdtProf=new Ne,this.cdtEleve=new qe}get libelleToutesLesClasses(){return this.cdtProf.parametrage.edt?"Toutes les classes":"Classes"}get libelleToutesLesMatieres(){return this.cdtProf.parametrage.edt?"Toutes les mati\xe8res":"Mati\xe8res"}static clonePeriodeCDT(t){if(Object.isExists(t))return{...t,periode:{...t.periode}}}static filtrerSlots(t,n){return t.filter(o=>!(n.entityCode&&o.entityCode!==n.entityCode&&n.entityType&&o.entityType||n.matiereCode&&o.matiereCode!==n.matiereCode||n.selectedDate&&o.date!==n.selectedDateToString))}initCdtEleve(t){let n;return n=Object.isExists(t)?this.authStore.getEleve(t):(0,U.of)(this.authStore.currentUser),n.pipe((0,D.w)(o=>{if(!Object.isExists(o))return(0,U.of)(!1);if(this.cdtEleve.parametrage=new ie.D(r.Kg5.getModuleParams(r.qzA.CAHIER_DE_TEXTES,o)),this.cdtEleve.parametrage.isCDTPrimaire){const a=new Date;switch(a.getDay()){case 6:this.selectDate(r.C_1.addNbJourToDate(a,2));break;case 5:this.selectDate(a);break;default:this.selectDate(r.C_1.addNbJourToDate(a,1))}}else{this.selectTypeVueCDTEleve(r.Rcf.AVENIR);const a={periode:r.C_1.getWeekPeriodForADay(),type:"week"};this.cdtEleve.selectPeriodeCDT(a)}return(0,U.of)(!0)}))}initCdtEnseignant(){if(Object.isExists(this.cdtProf.parametrage))return;this.cdtProf.parametrage=new ie.D(r.Kg5.getModuleParams(r.qzA.CAHIER_DE_TEXTES,this.authStore.currentUser));const t={periode:{dateDebut:void 0,dateFin:void 0},type:this.cdtProf.parametrage.isCDTPrimaire?"week":"month"};if(t.periode.dateDebut=new Date,this.cdtProf.parametrage.isCDTPrimaire){const n=r.C_1.getDaysOfWeek();t.periode.dateDebut=n[0],t.periode.dateFin=n[6],this.cdtProf.selectView(r.a7m.LIST)}else t.periode.dateDebut=r.C_1.getStartOfMonth(),t.periode.dateFin=r.C_1.getEndOfMonth(),this.cdtProf.selectView(this.authStore.currentUser.parametresIndividuels.typeViewCDTDefaut);this.cdtProf.selectPeriodeCDT(t),this.cdtProf.classesGroupes=r.uKw.getProfClassesGroupesTreeConcatUnique(this.etablissementStore.snapshot)}listMatieresOfClasse(t){return this.cdtProf.classesGroupes.find(o=>o.code===t).matieres}selectSlot(t){if(Object.isExists(t)){if(!Object.isExists(t.matiereCode))return void this.uiService.notifyEvent(r.DOJ.genericError,"Il n'y a pas de mati\xe8re associ\xe9e. La saisie est impossible","Erreur");if(!Object.isExists(t.entityCode))return void this.uiService.notifyEvent(r.DOJ.genericError,"Il n'y a pas de classe ou de groupe associ\xe9e. La saisie est impossible","Erreur")}this.cdtProf.selectSlot(t)}selectPeriodeCDT(t){Object.isExists(this.cdtProf)&&this.cdtProf.selectPeriodeCDT(t),Object.isExists(this.cdtEleve)&&this.cdtEleve.selectPeriodeCDT(t)}selectSlots(t){this.cdtProf.selectSlots(t)}selectDate(t){if(this.cdtEleve.selectDate(t),Object.isExists(t)){const n={periode:r.C_1.getWeekPeriodForADay(t),type:"week"};this.cdtEleve.selectPeriodeCDT(n),this.selectTypeVueCDTEleve(r.Rcf.JOUR)}}selectTypeVueCDTEleve(t){this.cdtEleve.typeVue=t,t!==r.Rcf.JOUR&&this.cdtEleve.selectDate(void 0)}selectEntity(t){this.cdtProf.selectEntity(t)}reset(){Object.isExists(this.cdtProf)&&this.cdtProf.reset(),Object.isExists(this.cdtEleve)&&this.cdtEleve.reset()}resetCDTEleve(){Object.isExists(this.cdtEleve)&&this.cdtEleve.reset()}resetCDTProf(){Object.isExists(this.cdtProf)&&this.cdtProf.reset()}isDatePast(t){return r.C_1.isDatePassee(t)||!0===this.cdtEleve.parametrage.compteRenduSeancePrevisionnel}correspondanceClasseInNote(t){const n=this.cdtProf.correspondances.classes.find(o=>o.edt.classeCode===t.entityCode&&o.edt.typeEntity===t.entityType);if(Object.isExists(n))return n.edt}correspondanceMatiereInNote(t){const n=this.cdtProf.correspondances.matieres.find(o=>o.edt.matiereCode===t.matiereCode&&o.edt.matiereLibelle===t.matiereLibelle);if(Object.isExists(n))return n.edt}correspondanceNeeded(t){return!!this.cdtProf.parametrage.correspondancesActives&&(this.correspondanceClasseNeeded(t)||this.correspondanceMatiereNeeded(t))}correspondanceClasseNeeded(t){if(!this.cdtProf.parametrage.correspondancesActives)return!1;const n=!Object.isExists(this.cdtProf.classesGroupes.find(a=>t.entityCode===a.code)),o=Object.isExists(this.correspondanceClasseInNote(t));return n&&!o}correspondanceMatiereNeeded(t){if(!this.cdtProf.parametrage.correspondancesActives)return!1;const n=this.correspondanceMatiereInNote(t);if(Object.isExists(n)&&t.matiereCode===n.matiereCode)return!1;let a=this.cdtProf.classesGroupes.find(c=>c.code===t.entityCode&&c.typeEntity===t.entityType);if(!Object.isExists(a)){const c=this.correspondanceClasseInNote(t);if(!Object.isExists(c))return!1;a=this.cdtProf.classesGroupes.find(p=>p.code===c.classeCode&&p.typeEntity===c.typeEntity)}return!!Object.isExists(a)&&!Object.isExists(a.matieres.find(c=>c.code===t.matiereCode))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(r.VD2),e.LFG(r.CnD),e.LFG(r.VLf))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var ne=d(54004),Le=d(4707),Ye=d(94033),G=d(30576),oe=d(77579),Re=d(38421),Qe=d(54482),Ve=d(69751);const Be={connector:()=>new oe.x};function He(i,s,t,n){t&&!(0,G.m)(t)&&(n=t);const o=(0,G.m)(t)?t:void 0;return a=>function $e(i,s){const t=(0,G.m)(i)?i:()=>i;return(0,G.m)(s)?function je(i,s=Be){const{connector:t}=s;return(0,Qe.e)((n,o)=>{const a=t();(0,Re.Xf)(i(function Ge(i){return new Ve.y(s=>i.subscribe(s))}(a))).subscribe(o),o.add(n.subscribe(a))})}(s,{connector:t}):n=>new Ye.c(n,t)}(new Le.t(i,s,n),o)(a)}var Ke=d(38343),u=d(18505),f=d(70262),C=d(28746),A=d(95698),B=d(39300),O=d(87192),E=d(52497),b=d(60515),j=d(46590),g=d(20388),y=d(92635),l=d(36895),T=d(80125),Z=d(4602);function ze(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Vos prochaines s\xe9ances du m\xeame niveau"),e.qZA())}function We(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1,"Vos autres classes / mati\xe8res"),e.qZA())}function Xe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"input",15),e.NdJ("change",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.toggleSlot(a))}),e.qZA(),e.TgZ(5,"label",16),e._uU(6),e.ALo(7,"edDate"),e.qZA()()()()()}if(2&i){const t=s.$implicit,n=e.oxw(3);e.xp6(4),e.MGl("id","checkEntityCdt_",t.idCours,""),e.Q6J("checked",n.isSlotSelected(t)),e.xp6(1),e.MGl("for","checkEntityCdt_",t.idCours,""),e.xp6(1),e.lnq(" ",t.entityLibelle," - ",e.xi3(7,6,t.date,"EEEE d MMMM")," - (",t.matiereLibelle,") ")}}const et=function(){return["date"]};function tt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"blockquote",8),e.YNc(2,Xe,8,9,"div",9),e.ALo(3,"orderBy"),e.ALo(4,"trackByProperty"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.duplicate())}),e._uU(6,"Dupliquer sur les cours s\xe9lectionn\xe9s"),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.xi3(3,3,t.tabSlotsForDuplication,e.DdM(8,et)))("ngForTrackBy",e.lcZ(4,6,"$index")),e.xp6(3),e.Q6J("disabled",0===t.selectedSlots.length)}}function it(i,s){1&i&&(e.TgZ(0,"div",17),e._uU(1," Cet \xe9l\xe9ment ne peut pas \xeatre dupliqu\xe9 car aucun cours du m\xeame niveau et de la m\xeame mati\xe8re n'est planifi\xe9 dans l'emploi du temps pour les 30 prochains jours. "),e.qZA())}function nt(i,s){if(1&i&&(e.ynx(0),e.YNc(1,tt,7,9,"div",3),e.YNc(2,it,2,0,"div",7),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.tabSlotsForDuplication&&t.tabSlotsForDuplication.length>0),e.xp6(1),e.Q6J("ngIf",!t.tabSlotsForDuplication||0===t.tabSlotsForDuplication.length)}}function ot(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"input",15),e.NdJ("change",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.toggleEntityMatiere(a))}),e.qZA(),e.TgZ(5,"label",16),e._uU(6),e.qZA()()()()()}if(2&i){const t=s.$implicit;e.xp6(4),e.MGl("id","checkEntityMatiere_",t.entityId,""),e.Q6J("checked",t.selected),e.xp6(1),e.MGl("for","checkEntityMatiere_",t.entityId,""),e.xp6(1),e.AsE(" ",t.entityLibelle," - ",t.matiereLibelle," ")}}const rt=function(){return["entityLibelle","matiereLibelle"]};function st(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"blockquote",8),e.YNc(2,ot,7,5,"div",9),e.ALo(3,"orderBy"),e.ALo(4,"trackByProperty"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.duplicate())}),e._uU(6," Dupliquer sur les classes/mati\xe8res s\xe9lectionn\xe9s "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",e.xi3(3,3,t.tabEntityMatiereRessource,e.DdM(8,rt)))("ngForTrackBy",e.lcZ(4,6,"$index")),e.xp6(3),e.Q6J("disabled",0===t.selectedTabEntityMatieres.length)}}function at(i,s){1&i&&(e.TgZ(0,"div",17),e._uU(1," Cette ressource ne peut pas \xeatre dupliqu\xe9e car aucune autre classe/mati\xe8re n'est affect\xe9 \xe0 votre profil "),e.qZA())}function ct(i,s){if(1&i&&(e.ynx(0),e.YNc(1,st,7,9,"div",3),e.YNc(2,at,2,0,"div",7),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.tabEntityMatiereRessource&&t.tabEntityMatiereRessource.length>0),e.xp6(1),e.Q6J("ngIf",!t.tabEntityMatiereRessource||0===t.tabEntityMatiereRessource.length)}}let _e=(()=>{class i{constructor(t,n,o,a,c,p,h){this.cahierDeTexteStore=t,this.authStore=n,this.modalRef=o,this.cahierDeTexteService=a,this.uiService=c,this.loaderService=p,this.cdtUserService=h,this.typeCDT=r.ce3,this._datePipe=new r.ifA}get selectedSlots(){return this.tabSlotsForDuplication.filter(t=>t.selected).map(t=>new r.B5X(t))}get selectedTabEntityMatieres(){return this.tabEntityMatiereRessource.filter(t=>t.selected)}ngOnInit(){this.side===r.ce3.RESSOURCE?(this.title=`Ressource des ${this.entity.libelle} en ${this.matiere.libelle}`,this.initListEntityMatiereForDuplicationRessource()):(this.title=`${this.side===r.P2J.AFAIRE?"Travail \xe0 faire":"Contenu de s\xe9ance"} des ${this.slot.entityLibelle} en ${this.slot.matiereLibelle}`,this.initNextSlotForDuplication())}initListEntityMatiereForDuplicationRessource(){this.tabEntityMatiereRessource=[],this.cdtUserService.cdtProf.classesGroupes.forEach(t=>{t.code===this.ressource.entityCode&&this.matiere.code===this.ressource.matiereCode||t.matieres.forEach(n=>{this.tabEntityMatiereRessource.push({entityId:t.id,entityCode:t.code,entityType:t.typeEntity,entityLibelle:t.libelle,matiereCode:n.code,matiereLibelle:n.libelle,selected:!1})})})}initNextSlotForDuplication(){const t=r.C_1.addNbJourToDate(new Date(this.slot.date),-5),n=this._datePipe.transform(t,"y-MM-dd"),o=this._datePipe.transform(r.C_1.addNbJourToDate(t,30),"y-MM-dd");let a=!1;const c=r.C_1.getStartOfMonth(r.C_1.addNbMoisToDate(new Date,1)),p=r.C_1.getEndOfMonth(c),h={dateDebut:c,dateFin:p};this.loader=this.loaderService.show(this),this.cahierDeTexteService.loadSlots(this.authStore.currentUser.id,this.authStore.currentUser.typeCompte,this._datePipe.transform(c,"y-MM-dd"),this._datePipe.transform(p,"y-MM-dd")).pipe((0,j.d)(null),(0,u.b)(()=>{const k=this.cahierDeTexteStore.getCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id,{...h,dateDebut:t}).map(x=>({...x,selected:!1}));this.tabSlotsForDuplication=k.filter(x=>((!Array.isArray(x.niveaux)||0===x.niveaux.length)&&(a=!0),x.date>=n&&x.date<o&&x.niveaux.edIntersect(this.slot.niveaux).length>0)),a&&(this.tabSlotsForDuplication=k.filter(x=>x.date>=n&&x.date<o&&x.matiereCode===this.slot.matiereCode))}),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}duplicate(){let t;this.loader=this.loaderService.show(this),t=this.side!==r.ce3.RESSOURCE?this.cahierDeTexteService.duplicateSlot(this.slot,this.selectedSlots,this.side):this.cahierDeTexteService.duplicateRessource(this.ressource,this.selectedTabEntityMatieres),t.pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre saisie a bien \xe9t\xe9 prise en compte","Enregistrement effectu\xe9","icon-ed_cahierdetexte"),this.modalRef.hide()}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur est survenu lors de la duplication","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}isSlotSelected(t){return t.selected}toggleSlot(t){t.selected=!t.selected}toggleEntityMatiere(t){t.selected=!t.selected}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.x1h),e.Y36(r.CnD),e.Y36(g.UZ),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(y.S),e.Y36(m))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-duplication-modal"]],inputs:{slot:"slot",side:"side",entity:"entity",matiere:"matiere",ressource:"ressource"},decls:12,vars:6,consts:[[1,"modal-header","duplication-cahierdetexte",3,"ngBusy"],[1,"modal-title"],[1,"modal-subtitle"],[4,"ngIf"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body"],[1,"modal-footer"],["class","jumbotron",4,"ngIf"],[2,"max-height","500px","overflow","auto"],["class","row g-0",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"row","g-0"],[1,"col-lg-12","ps-1"],[1,"input-group"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"checked","id","change"],[1,"form-check-label","fw-normal",3,"for"],[1,"jumbotron"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div")(2,"h3",1),e._uU(3),e.qZA(),e.TgZ(4,"p",2),e.YNc(5,ze,2,0,"span",3),e.YNc(6,We,2,0,"span",3),e.qZA()(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.modalRef.hide()}),e.qZA()(),e.TgZ(8,"div",5),e.YNc(9,nt,3,2,"ng-container",3),e.YNc(10,ct,3,2,"ng-container",3),e.qZA(),e._UZ(11,"div",6)),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(3),e.hij("Duplication de ",n.title,""),e.xp6(2),e.Q6J("ngIf",n.side!==n.typeCDT.RESSOURCE),e.xp6(1),e.Q6J("ngIf",n.side===n.typeCDT.RESSOURCE),e.xp6(3),e.Q6J("ngIf",n.side!==n.typeCDT.RESSOURCE),e.xp6(1),e.Q6J("ngIf",n.side===n.typeCDT.RESSOURCE))},dependencies:[l.sg,l.O5,T.DC,r.d0N,r.ifA,Z.$],encapsulation:2,changeDetection:0}),i})();var w=d(11302),v=d(82722),me=d(93970),fe=d(34414),$=d(34331),dt=d(55253),re=d(77069),lt=d(48536),H=d(24155);function ut(i,s){1&i&&(e.ynx(0),e._uU(1," Vous pouvez ajouter ici des documents \xe0 rendre pour ce travail \xe0 faire. "),e._UZ(2,"br"),e.TgZ(3,"strong"),e._uU(4,"L'ensemble des documents ne sera visible par l'enseignant qu'une fois d\xe9pos\xe9 dans son casier."),e.qZA(),e.BQk())}function pt(i,s){1&i&&(e.ynx(0),e._uU(1," Ces documents ont \xe9t\xe9 d\xe9pos\xe9s dans le casier de l'enseignant. "),e._UZ(2,"br"),e._uU(3," Vous ne pouvez pas les modifier. "),e.BQk())}function _t(i,s){1&i&&(e.TgZ(0,"strong"),e._uU(1,"Des correctifs ont d\xe9j\xe0 \xe9t\xe9 d\xe9pos\xe9s par l'enseignant pour ce travail \xe0 faire."),e.qZA(),e._UZ(2,"br"),e._uU(3," Vos documents n'ont pas \xe9t\xe9 d\xe9pos\xe9s dans le casier de l'enseignant. "),e._UZ(4,"br"),e.TgZ(5,"strong"),e._uU(6,"Vous ne pouvez plus les d\xe9poser."),e.qZA())}function mt(i,s){if(1&i&&(e.YNc(0,pt,4,0,"ng-container",2),e.YNc(1,_t,7,0,"ng-template",null,10,e.W1O)),2&i){const t=e.MAs(2),n=e.oxw(2);e.Q6J("ngIf",!n.cdtMatiere.aFaire.hasCorrectifs)("ngIfElse",t)}}function ft(i,s){if(1&i&&(e.ynx(0),e.YNc(1,ut,5,0,"ng-container",2),e.YNc(2,mt,3,2,"ng-template",null,9,e.W1O),e.BQk()),2&i){const t=e.MAs(3),n=e.oxw();e.xp6(1),e.Q6J("ngIf",!n.eleveDCC.readonlyCopies)("ngIfElse",t)}}function Ct(i,s){if(1&i&&(e._uU(0),e.ALo(1,"displayNom"),e._UZ(2,"br"),e._uU(3," Vous ne pouvez pas les modifier. ")),2&i){const t=e.oxw();e.hij(" Ces documents ont \xe9t\xe9 d\xe9pos\xe9s dans votre casier par ",e.lcZ(1,1,t.eleveDCC.eleve),". ")}}function ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deposerRendusDansCasierEnseignant())}),e._UZ(2,"i",13),e._uU(3," D\xe9poser mes documents dans le casier de l'enseignant "),e.qZA()()}}let se=(()=>{class i{constructor(t,n,o,a,c,p,h){this.authStore=t,this.cahierDeTexteStore=n,this.uiService=o,this.cahierDeTexteService=a,this.modalService=c,this.loaderService=p,this.cd=h,this.modeTeleversement=r.qt_,this.isFouE=this.authStore.isFouE()}ngOnInit(){!this.authStore.isProfesseur()&&!this.authStore.isFouE()||(this.eleveRendusCloudEntity=new r.Xp8({id:this.eleveDCC.idProf,type:r.dcH.ENSEIGNANT,libelle:"Rendus",droit:this.eleveDCC.readonlyCopies?r.bvQ.DROIT_LECTURE:r.bvQ.DROIT_SUPPRESSION}),!this.authStore.isProfesseur()&&!this.eleveDCC.readonlyCopies&&this.initConfigDZRendus())}initConfigDZRendus(){const t="#rendus_"+this.idCDT+" .dropzone-container";this.dropZoneConfigRendus={url:`${(0,w.Je)()}/televersement.awp?verbe=post&mode=${r.qt_.CDT}`,params:{idContexte:this.idCDT},clickable:t+" .fileinput-button"},this.authStore.isFamille()&&(this.dropZoneConfigRendus.url+="&idEleve="+this.eleveDCC.eleve.id,this.dropZoneConfigRendus.params.idEleve=this.eleveDCC.eleve.id),this.inputFilesConfigRendus={keepComplete:!1,mode:r.qt_.CDT,dropzoneContainer:t,idContexte:this.idCDT,fromCloudEnabled:r.Kg5.isModuleEnabled(this.authStore.currentUser,r.qzA.CLOUD,this.authStore.isFamille()?this.eleveDCC.eleve.id:0)},this.authStore.isFamille()&&(this.inputFilesConfigRendus.idEntity=this.eleveDCC.eleve.id,this.inputFilesConfigRendus.typeEntity=r.meW.ELEVE)}onUploadSuccess(t){this.cahierDeTexteStore.addRenduDevoir(t,this.dateDevoir,this.cdtMatiere,this.eleveDCC.eleve.id),this.eleveDCC.copies++}onRemoveSuccess(t){this.cahierDeTexteStore.removeRendusDevoir(t,this.dateDevoir,this.cdtMatiere,this.eleveDCC.eleve.id),this.eleveDCC.copies-=t.length}deposerRendusDansCasierEnseignant(){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"D\xe9poser mes documents dans le casier de l'enseignant",message:'\n        <p>\xcates-vous vraiment s\xfbr de vouloir d\xe9poser vos documents dans le casier de l\'enseignant ?</p>\n        <p class="text-danger">Attention ! Une fois d\xe9pos\xe9s <strong>vous ne pourrez plus modifier les documents</strong></p>\n      ',btnConfirm:"Valider",btnCancel:"Non"},ignoreBackdropClick:!0};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(o=>(this.loader=this.loaderService.show(this),this.cd.markForCheck(),o===E.G.validation?this.cahierDeTexteService.validerDepotRendusEleveDansCasierProf(this.idCDT,this.eleveDCC.eleve.id,this.dateDevoir):(0,U.of)(void 0))),(0,u.b)(o=>{o?(this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 d\xe9pos\xe9s dans le casier de l'enseignant.","Fichiers enregistr\xe9s","icon-ed_cahierdetexte"),this.eleveDCC.readonlyCopies=!0):!1===o&&this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(r.x1h),e.Y36(r.VLf),e.Y36(r.mYE),e.Y36(g.tT),e.Y36(y.S),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-taf-rendus-eleve"]],viewQuery:function(t,n){if(1&t&&e.Gf(H.I,5),2&t){let o;e.iGM(o=e.CRH())&&(n.cloudComponent=o.first)}},inputs:{cdtMatiere:"cdtMatiere",dateDevoir:"dateDevoir",eleveDCC:"eleveDCC",idCDT:"idCDT"},decls:11,vars:12,consts:[[1,"ed-cdt-taf-rendus-eleve",3,"id","ngBusy"],[1,"alert","alert-info"],[4,"ngIf","ngIfElse"],["prof",""],[3,"droitsRW","displayFull","rootFolder","entity","modeTeleversement","inputFilesConfig","dropZoneConfig","successUpload","successRemove"],["cloud",""],["type","button",1,"btn","btn-primary","white","margin-whitespace","additionalActionButtonsTmp",3,"click"],["aria-hidden","true",1,"fa","fa-cloud"],["class","text-center",4,"ngIf"],["roEleve",""],["roEleveLocked",""],[1,"text-center"],["type","button",1,"btn","btn-success",3,"click"],["aria-hidden","true",1,"fa","fa-share-square-o"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ft,4,2,"ng-container",2),e.YNc(3,Ct,4,3,"ng-template",null,3,e.W1O),e.qZA(),e.TgZ(5,"ed-cloud",4,5),e.NdJ("successUpload",function(c){return n.onUploadSuccess(c)})("successRemove",function(c){return n.onRemoveSuccess(c)}),e.TgZ(7,"button",6),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(6);return e.KtG(c.inputFiles.openCloudFinder())}),e._UZ(8,"i",7),e._uU(9," S\xe9lectionner depuis mon Cloud "),e.qZA()(),e.YNc(10,ht,4,0,"div",8),e.qZA()}if(2&t){const o=e.MAs(4);e.MGl("id","rendus_",n.idCDT,""),e.Q6J("ngBusy",n.loader),e.xp6(2),e.Q6J("ngIf",n.isFouE)("ngIfElse",o),e.xp6(3),e.Q6J("droitsRW",n.eleveDCC.readonlyCopies||!n.isFouE?"ro":"rw")("displayFull",!1)("rootFolder",n.eleveDCC.idPathCopies)("entity",n.eleveRendusCloudEntity)("modeTeleversement",n.modeTeleversement.CDT)("inputFilesConfig",n.inputFilesConfigRendus)("dropZoneConfig",n.dropZoneConfigRendus),e.xp6(5),e.Q6J("ngIf",n.isFouE&&!n.eleveDCC.readonlyCopies&&n.eleveDCC.copies>0)}},dependencies:[l.O5,T.DC,H.I,r.$t3],changeDetection:0}),i})();function gt(i,s){1&i&&(e.ynx(0),e._uU(1,"Vous trouverez ici la liste des correctifs rendus par l'enseignant."),e.BQk())}function vt(i,s){if(1&i&&(e.ynx(0),e._uU(1),e.ALo(2,"displayNom"),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.hij("Liste des correctifs d\xe9pos\xe9s pour ",e.lcZ(2,1,t.eleveDCC.eleve),".")}}function bt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",8)(1,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deposerCorrectifsDansCasierEleve())}),e._UZ(2,"i",10),e._uU(3," D\xe9poser les correctifs dans le casier de l'\xe9l\xe8ve "),e.qZA()()}}let ae=(()=>{class i{constructor(t,n,o,a,c,p,h){this.authStore=t,this.modalService=n,this.loaderService=o,this.cd=a,this.cahierDeTexteService=c,this.cahierDeTexteStore=p,this.uiService=h,this.modeTeleversement=r.qt_,this.isFouE=this.authStore.isFouE()}ngOnInit(){!this.authStore.isProfesseur()&&!this.authStore.isFouE()||(this.eleveCorrectifsCloudEntity=new r.Xp8({id:this.eleveDCC.eleve.id,type:r.dcH.ELEVE,libelle:"Correctifs",droit:this.isFouE?r.bvQ.DROIT_LECTURE:r.bvQ.DROIT_SUPPRESSION}),this.initConfigDZCorrectifs())}initConfigDZCorrectifs(){const t="#correctifs_"+this.idCDT+" .dropzone-container";this.dropZoneConfigCorrectifs={url:`${(0,w.Je)()}/televersement.awp?verbe=post&mode=${r.qt_.CDT_CORRECTIFS}&idEleve=${this.eleveDCC.eleve.id}`,params:{idContexte:this.idCDT,idEleve:this.eleveDCC.eleve.id,contexte:this.eleveDCC.idPathCorrectifs},clickable:t+" .fileinput-button"},this.inputFilesConfigCorrectifs={keepComplete:!1,mode:r.qt_.CDT_CORRECTIFS,dropzoneContainer:t,idContexte:this.idCDT,fromCloudEnabled:r.Kg5.isModuleEnabled(this.authStore.currentUser,r.qzA.CLOUD,0)}}onUploadSuccess(){this.cahierDeTexteStore.addCorrectifDevoir(this.idCDT,this.eleveDCC.eleve.id,1)}onCopySuccess(t){this.cahierDeTexteStore.addCorrectifDevoir(this.idCDT,this.eleveDCC.eleve.id,t.length)}onRemoveSuccess(t){this.cahierDeTexteStore.addCorrectifDevoir(this.idCDT,this.eleveDCC.eleve.id,-t.length)}deposerCorrectifsDansCasierEleve(){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"D\xe9poser les correctifs dans le casier de l'\xe9l\xe8ve",message:'\n        <p>\xcates-vous vraiment s\xfbr de vouloir d\xe9poser ces correctifs dans le casier de l\'\xe9l\xe8ve ?</p>\n        <p class="text-danger">Attention ! Une fois d\xe9pos\xe9s <strong>vous ne pourrez plus modifier les documents</strong></p>\n      ',btnConfirm:"Valider",btnCancel:"Non"},ignoreBackdropClick:!0};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(o=>(this.loader=this.loaderService.show(this),this.cd.markForCheck(),o===E.G.validation?this.cahierDeTexteService.updateStateDepotRenduCorrectifEleve(this.idCDT,this.eleveDCC.eleve.id,this.dateDevoir,"correctif"):(0,U.of)(void 0))),(0,u.b)(o=>{o?this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 d\xe9pos\xe9s dans le casier de l'\xe9l\xe8ve.","Fichiers enregistr\xe9s","icon-ed_cahierdetexte"):!1===o&&this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(g.tT),e.Y36(y.S),e.Y36(e.sBO),e.Y36(r.mYE),e.Y36(r.x1h),e.Y36(r.VLf))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-taf-correctifs-prof"]],viewQuery:function(t,n){if(1&t&&e.Gf(H.I,5),2&t){let o;e.iGM(o=e.CRH())&&(n.cloudComponent=o.first)}},inputs:{eleveDCC:"eleveDCC",dateDevoir:"dateDevoir",idCDT:"idCDT"},decls:10,vars:12,consts:[[1,"ed-cdt-taf-correctifs-prof",3,"id","ngBusy"],[1,"alert","alert-info"],[4,"ngIf"],[3,"displayFull","droitsRW","rootFolder","entity","modeTeleversement","inputFilesConfig","dropZoneConfig","successUpload","successCopy","successRemove"],["cloud",""],["type","button",1,"btn","btn-primary","white","margin-whitespace","additionalActionButtonsTmp",3,"click"],["aria-hidden","true",1,"fa","fa-cloud"],["class","text-center",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","btn-success",3,"click"],["aria-hidden","true",1,"fa","fa-share-square-o"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,gt,2,0,"ng-container",2),e.YNc(3,vt,3,3,"ng-container",2),e.qZA(),e.TgZ(4,"ed-cloud",3,4),e.NdJ("successUpload",function(){return n.onUploadSuccess()})("successCopy",function(c){return n.onCopySuccess(c)})("successRemove",function(c){return n.onRemoveSuccess(c)}),e.TgZ(6,"button",5),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(5);return e.KtG(c.inputFiles.openCloudFinder())}),e._UZ(7,"i",6),e._uU(8," S\xe9lectionner depuis mon Cloud "),e.qZA()(),e.YNc(9,bt,4,0,"div",7),e.qZA()}2&t&&(e.MGl("id","correctifs_",n.idCDT,""),e.Q6J("ngBusy",n.loader),e.xp6(2),e.Q6J("ngIf",n.isFouE),e.xp6(1),e.Q6J("ngIf",!n.isFouE),e.xp6(1),e.Q6J("displayFull",!1)("droitsRW",n.eleveDCC.readonlyCorrectifs?"ro":"rw")("rootFolder",n.eleveDCC.idPathCorrectifs)("entity",n.eleveCorrectifsCloudEntity)("modeTeleversement",n.modeTeleversement.CDT_CORRECTIFS)("inputFilesConfig",n.inputFilesConfigCorrectifs)("dropZoneConfig",n.dropZoneConfigCorrectifs),e.xp6(5),e.Q6J("ngIf",!n.eleveDCC.readonlyCorrectifs&&n.eleveDCC.correctifs>0))},dependencies:[l.O5,T.DC,H.I,r.$t3],changeDetection:0}),i})();function Tt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.annulerDepotRendus())}),e._UZ(1,"i",16),e._uU(2," Annuler le d\xe9pot de l'\xe9l\xe8ve "),e.qZA()}}function xt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.copierRendusVersCorrectifs())}),e._UZ(2,"i",19),e._uU(3," Copier les documents rendus pour corrections "),e.qZA()()}}function Et(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.annulerDepotCorrectifs())}),e._UZ(1,"i",16),e._uU(2," Annuler le d\xe9pot "),e.qZA()}}function yt(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",8)(2,"div",9)(3,"h3"),e._uU(4," Documents rendus "),e.YNc(5,Tt,3,0,"button",10),e.qZA()(),e.TgZ(6,"div",11),e._UZ(7,"ed-cdt-taf-rendus-eleve",12),e.YNc(8,xt,4,0,"div",13),e.qZA()(),e.TgZ(9,"div",8)(10,"div",9)(11,"h3"),e._uU(12),e.YNc(13,Et,3,0,"button",14),e.qZA()(),e.TgZ(14,"div",11),e._UZ(15,"ed-cdt-taf-correctifs-prof",12),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(5),e.Q6J("ngIf",t.eleveDCC.copies>0&&t.eleveDCC.readonlyCopies),e.xp6(2),e.Q6J("idCDT",t.slot.idCDT)("eleveDCC",t.eleveDCC)("dateDevoir",t.slot.date),e.xp6(1),e.Q6J("ngIf",!t.eleveDCC.readonlyCorrectifs&&t.eleveDCC.readonlyCopies&&t.eleveDCC.copies>0),e.xp6(4),e.hij(" ",t.titleCorrectif," "),e.xp6(1),e.Q6J("ngIf",t.eleveDCC.correctifs>0&&t.eleveDCC.readonlyCorrectifs),e.xp6(2),e.Q6J("idCDT",t.slot.idCDT)("eleveDCC",t.eleveDCC)("dateDevoir",t.slot.date)}}function St(i,s){1&i&&(e.TgZ(0,"div",21)(1,"h3"),e._uU(2,"Aucun rendu/correctif associ\xe9"),e.qZA()())}let Mt=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p){super(),this.loaderService=t,this.cahierDeTexteService=n,this.cahierDeTexteStore=o,this.uiService=a,this.modalRef=c,this.modalService=p}get titleCorrectif(){return this.eleveDCC.readonlyCorrectifs?"Correctifs (d\xe9pos\xe9s)":"Correctifs (en cours de correction)"}ngOnInit(){Object.isExists(this.subDCC)&&this.subDCC.unsubscribe(),this.subDCC=this.cahierDeTexteStore.selectDCCEleveSlot(this.slot.idCDT,this.idEleve).pipe((0,u.b)(t=>{!Object.isExists(t)||(this.eleveDCC=new r.TuB(t))}),(0,v.R)(this.componentDestroyed$)).subscribe()}ngOnDestroy(){return Object.isExists(this.subDCC)&&this.subDCC.unsubscribe(),super.ngOnDestroy()}close(){this.modalRef.hide()}copierRendusVersCorrectifs(){this.cdtTafRendus.cloudComponent.deleteCopySelection(),this.cdtTafRendus.cloudComponent.currentNode.children.forEach(t=>this.cdtTafRendus.cloudComponent.toggleNodeToSelection(t)),this.cdtTafRendus.cloudComponent.copyToClipboard(),this.cdtTafCorrectifs.cloudComponent.pasteFromClipboard(),this.cdtTafRendus.cloudComponent.deleteCopySelection()}annulerDepotCorrectifs(){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Retirer les correctifs du casier de l'\xe9l\xe8ve",message:"\n        <p>\xcates-vous vraiment s\xfbr de vouloir retirer ces correctifs du casier de l'\xe9l\xe8ve ?</p>\n      ",btnConfirm:"Valider",btnCancel:"Non"},ignoreBackdropClick:!0};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(o=>(this.loader=this.loaderService.show(this),o===E.G.validation?this.cahierDeTexteService.updateStateDepotRenduCorrectifEleve(this.slot.idCDT,this.eleveDCC.eleve.id,this.slot.date,"correctif",!1):(0,U.of)(void 0))),(0,u.b)(o=>{o?this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 retir\xe9s du casier de l'\xe9l\xe8ve.","Fichiers retir\xe9s","icon-ed_cahierdetexte"):!1===o&&this.uiService.notifyEvent(r.DOJ.genericError,"Le retrait de vos correctifs a \xe9chou\xe9.","Erreur","fa fa-warning")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Le retrait de vos correctifs a \xe9chou\xe9.","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}annulerDepotRendus(){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Annuler les rendus de l'\xe9l\xe8ve",message:'\n        <p>\xcates-vous vraiment s\xfbr de vouloir annuler le d\xe9pot de ces documents rendus ?</p>\n        <p class="text-danger">Attention ! Une fois le d\xe9pot annul\xe9 <strong> l\'\xe9l\xe8ve pourra de nouveau vous d\xe9poser des documents</strong></p>\n      ',btnConfirm:"Valider",btnCancel:"Non"},ignoreBackdropClick:!0};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(o=>(this.loader=this.loaderService.show(this),o===E.G.validation?this.cahierDeTexteService.updateStateDepotRenduCorrectifEleve(this.slot.idCDT,this.eleveDCC.eleve.id,this.slot.date,"rendu",!1):(0,U.of)(void 0))),(0,u.b)(o=>{o?(this.uiService.notifyEvent(r.DOJ.genericSuccess,"Le d\xe9pot des documents rendus a bien \xe9t\xe9 annul\xe9.","Fichiers retir\xe9s","icon-ed_cahierdetexte"),this.cdtTafRendus.cloudComponent.refreshNode(void 0,!0)):!1===o&&this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot des documents rendus a \xe9chou\xe9.","Erreur","fa fa-warning")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot des documents rendus a \xe9chou\xe9.","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.S),e.Y36(r.mYE),e.Y36(r.x1h),e.Y36(r.VLf),e.Y36(g.UZ),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-taf-rendus-correctifs-eleve-modal"]],viewQuery:function(t,n){if(1&t&&(e.Gf(se,5),e.Gf(ae,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.cdtTafRendus=o.first),e.iGM(o=e.CRH())&&(n.cdtTafCorrectifs=o.first)}},inputs:{slot:"slot",idEleve:"idEleve"},features:[e.qOj],decls:14,vars:12,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],[4,"ngIf","ngIfElse"],["noDCC",""],[1,"modal-footer"],[1,"ed-card","card","with-epingle"],[1,"card-header"],["type","button","class","btn btn-danger float-end","title","Annuler le d\xe9pot de l'\xe9l\xe8ve",3,"click",4,"ngIf"],[1,"card-body"],[3,"idCDT","eleveDCC","dateDevoir"],["class","text-center",4,"ngIf"],["type","button","class","btn btn-danger float-end","title","Annuler le d\xe9pot",3,"click",4,"ngIf"],["type","button","title","Annuler le d\xe9pot de l'\xe9l\xe8ve",1,"btn","btn-danger","float-end",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],[1,"text-center"],["type","button",1,"btn","btn-success",3,"click"],["aria-hidden","true",1,"fa","fa-copy"],["type","button","title","Annuler le d\xe9pot",1,"btn","btn-danger","float-end",3,"click"],[1,"jumbotron"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div")(2,"h3",1),e._uU(3,"Rendus / Correctifs"),e.qZA(),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"edDate"),e.ALo(7,"displayNom"),e.qZA()(),e.TgZ(8,"button",3),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(9,"div",4),e.YNc(10,yt,16,10,"ng-container",5),e.YNc(11,St,3,0,"ng-template",null,6,e.W1O),e.qZA(),e._UZ(13,"div",7)),2&t){const o=e.MAs(12);e.xp6(5),e.HOy(" ",n.slot.entityLibelle," - ",n.slot.matiereLibelle," - ",e.xi3(6,7,n.slot.date,"EEEE d MMMM")," - ",e.lcZ(7,10,n.eleveDCC.eleve)," "),e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",n.eleveDCC)("ngIfElse",o)}},dependencies:[l.O5,T.DC,se,ae,r.$t3,r.ifA]}),i})();var q=d(95715);const Dt=["ed-cdt-tr-eleve-dashboard-copies-correctifs",""];function Zt(i,s){1&i&&e._UZ(0,"i",10)}const At=function(){return[]};function wt(i,s){if(1&i&&(e.TgZ(0,"a",11),e._UZ(1,"i",12)(2,"br"),e._uU(3),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&i){const t=e.oxw();e.Q6J("fileId",t.uncCopies)("fileType",t.typeFichierTelechargement.CLOUD)("routerLink",e.DdM(5,At)),e.xp6(3),e.hij(" ",t.dccEleve.copies," "),e.xp6(2),e.Oqu(t.dccEleve.copies>1?"fichiers":"fichier")}}function Ut(i,s){1&i&&(e.ynx(0),e._UZ(1,"i",13),e._uU(2," Afficher et corriger "),e.BQk())}function Ot(i,s){1&i&&(e.ynx(0),e._uU(1,"Voir les correctif d\xe9pos\xe9s"),e.BQk())}function kt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",14)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addCommentaire())}),e._UZ(2,"i",16),e.qZA(),e.TgZ(3,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.cancelCommentaire())}),e._UZ(4,"i",18),e.qZA()()}}let Pt=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h){super(),this.formBuilder=t,this.cahierDeTexteStore=n,this.modalService=o,this.cloudService=a,this.uiService=c,this.cahierDeTexteService=p,this.authStore=h,this.beforeUpdate=new e.vpe,this.afterUpdate=new e.vpe,this.typeFichierTelechargement=r.Y9E,this.isRendreCorrectifDisplayed=!1,this.inputFilesConfig={mode:r.qt_.CDT_CORRECTIFS,libelleTitre:"D\xe9posez votre fichier ici, ou s\xe9lectionnez un fichier \xe0 l'aide du bouton.",fromCloudEnabled:!0,dropzoneContainer:"#correctifs_"},this.dropZoneConfig={previewsContainer:!1,url:`${(0,w.Je)()}/televersement.awp?verbe=post&mode=${r.qt_.CDT_CORRECTIFS}`}}get uncCopies(){return`${this.authStore.currentUser.codeOgec}\\${this.authStore.currentUser.typeCompte}\\${this.authStore.currentUser.id}${this.dccEleve.idPathCopies}`}ngOnChanges(t){this.initFormulaire(),this.inputFilesConfig={...this.inputFilesConfig,dropzoneContainer:"#correctifs_"+this.dccEleve.eleve.id},this.dropZoneConfig={...this.dropZoneConfig,url:`${(0,w.Je)()}/televersement.awp?verbe=post&mode=${r.qt_.CDT_CORRECTIFS}&idEleve=${this.dccEleve.eleve.id}`,params:{idContexte:this.dccEleve.idPathCorrectifs,idEleve:this.dccEleve.eleve.id}}}initFormulaire(){this.formDccEleve=this.formBuilder.group({commentaire:[r.YC.base64decode(this.dccEleve.commentaire)]})}rendreCorrectifs(t=!0){this.isRendreCorrectifDisplayed=t;const n={id:this.modalService.getModalsCount()+1,initialState:{slot:this.currentCDT,idEleve:this.dccEleve.eleve.id},class:"modal-lg"};this.modalService.show(Mt,n)}removeCorrectifs(){const t={id:this.modalService.getModalsCount()+1,initialState:{title:"Suppression correctifs \xe9l\xe8ve",message:"<p>\xcates-vous s\xfbr de vouloir <strong>supprimer</strong> les fichiers et le <strong>commentaire</strong> ?</p>",btnConfirm:"Supprimer",btnCancel:"Non"}};this.modalService.show(O.z,t),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(n=>n===E.G.validation?(this.beforeUpdate.emit(),this.cloudService.deleteNode(this.dccEleve.eleve.id,r.dcH.ELEVE,[new r.EiA({id:this.dccEleve.idPathCorrectifs})])):b.E),(0,u.b)(n=>{this.cahierDeTexteStore.removeCorrectifsDevoir(this.currentCDT.idCDT,this.dccEleve.eleve.id),this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les correctifs de cet \xe9l\xe8ve ont bien \xe9t\xe9 supprim\xe9s.","Suppression"),this.afterUpdate.emit()}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur s'est produite lors de la suppression des correctifs de cet \xe9l\xe8ve.","Suppression"),b.E))).subscribe()}addCommentaire(){this.beforeUpdate.emit(),this.cahierDeTexteService.saveCorrectifsCommentaireEnseignant(this.currentCDT,this.dccEleve.eleve.id,r.YC.base64encode(this.formDccEleve.value.commentaire)).pipe((0,u.b)(t=>{t?this.uiService.notifyEvent(r.DOJ.genericSuccess,"Le commentaire a bien \xe9t\xe9 enregistr\xe9.","Commentaire"):this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur s'est produite lors de l'enregistrement du commentaire.","Erreur")}),(0,C.x)(()=>this.afterUpdate.emit()),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur s'est produite lors de l'enregistrement du commentaire.","Erreur"),b.E))).subscribe()}cancelCommentaire(){this.formDccEleve.reset({commentaire:r.YC.base64decode(this.dccEleve.commentaire)})}onUploadQueueSuccess(t){this.isRendreCorrectifDisplayed=!1,this.cahierDeTexteStore.addCorrectifDevoir(this.currentCDT.idCDT,this.dccEleve.eleve.id,t),this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 d\xe9pos\xe9s dans le casier de l'\xe9l\xe8ve.","Fichiers enregistr\xe9s")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.qu),e.Y36(r.x1h),e.Y36(g.tT),e.Y36(r.eyc),e.Y36(r.VLf),e.Y36(r.mYE),e.Y36(r.CnD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["tr","ed-cdt-tr-eleve-dashboard-copies-correctifs",""]],inputs:{dccEleve:"dccEleve",currentCDT:"currentCDT"},outputs:{beforeUpdate:"beforeUpdate",afterUpdate:"afterUpdate"},features:[e.qOj,e.TTD],attrs:Dt,decls:16,vars:11,consts:[[1,"text-center"],["class","fa fa-2x fa-close","style","color: darkred","aria-label","hidden","title","Aucun fichier d\xe9pos\xe9 pour le moment",4,"ngIf"],["href","","class","btn btn-primary-color","edTelechargement","","aria-label","T\xe9l\xe9charger le travail rendu","role","button",3,"fileId","fileType","routerLink",4,"ngIf"],["type","button",1,"btn","btn-success","btn-sm","d-print-none",3,"click"],[4,"ngIf"],["novalidate","",1,"form-commentaire-correctif",3,"name","formGroup"],[1,"row"],[1,"col-lg-10"],["formControlName","commentaire","rows","2",1,"form-control",3,"name"],["class","col-lg-2",4,"ngIf"],["aria-label","hidden","title","Aucun fichier d\xe9pos\xe9 pour le moment",1,"fa","fa-2x","fa-close",2,"color","darkred"],["href","","edTelechargement","","aria-label","T\xe9l\xe9charger le travail rendu","role","button",1,"btn","btn-primary-color",3,"fileId","fileType","routerLink"],["title","T\xe9l\xe9charger le travail rendu","aria-hidden","true",1,"fa","fa-2x","fa-download"],["aria-hidden","true",1,"fa","fa-2x","fa-upload","i-small"],[1,"col-lg-2"],["type","button","title","Enregistrer le commentaire",1,"btn","btn-primary-color","no-background","btn-sm","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-save"],["type","button","title","Annnuler la saisie du commentaire",1,"btn","btn-danger-color","no-background","btn-sm","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-close"]],template:function(t,n){1&t&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"displayNom"),e.qZA(),e.TgZ(3,"td",0),e.YNc(4,Zt,1,0,"i",1),e.YNc(5,wt,6,6,"a",2),e.qZA(),e.TgZ(6,"td",0)(7,"button",3),e.NdJ("click",function(){return n.rendreCorrectifs()}),e.YNc(8,Ut,3,0,"ng-container",4),e.YNc(9,Ot,2,0,"ng-container",4),e.qZA()(),e.TgZ(10,"td")(11,"form",5)(12,"div",6)(13,"div",7),e._UZ(14,"textarea",8),e.qZA(),e.YNc(15,kt,5,0,"div",9),e.qZA()()()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,9,n.dccEleve.eleve)),e.xp6(3),e.Q6J("ngIf",0===n.dccEleve.copies),e.xp6(1),e.Q6J("ngIf",n.dccEleve.copies>0),e.xp6(3),e.Q6J("ngIf",!n.dccEleve.readonlyCorrectifs),e.xp6(1),e.Q6J("ngIf",n.dccEleve.readonlyCorrectifs),e.xp6(2),e.MGl("name","form",n.dccEleve.eleve.id,""),e.Q6J("formGroup",n.formDccEleve),e.xp6(3),e.MGl("name","commentaireAFaire_",n.dccEleve.eleve.id,""),e.xp6(1),e.Q6J("ngIf",n.formDccEleve.dirty))},dependencies:[l.O5,_._Y,_.Fj,_.JJ,_.JL,_.sg,_.u,q.yS,re.x,r.$t3],styles:["td.dropzone-container[_ngcontent-%COMP%]{position:relative}.form-commentaire-correctif[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-right:0;margin-left:0}"],changeDetection:0}),i})();function It(i,s){if(1&i&&(e.TgZ(0,"button",24),e._UZ(1,"span",25),e._uU(2," \xc9l\xe8ves "),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("listContact",t.elevesWithNoRendu)("typeContact",t.edTypeUser.ELEVE)}}function Jt(i,s){if(1&i&&(e.TgZ(0,"button",26),e._UZ(1,"span",25),e._uU(2," Familles "),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("listContact",t.famillesWithNoRendu)("typeContact",t.edTypeUser.FAMILLE_RESPONSABLE)}}function Ft(i,s){if(1&i&&(e.TgZ(0,"button",24),e._UZ(1,"span",25),e._uU(2," \xc9l\xe8ves "),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("listContact",t.elevesAll)("typeContact",t.edTypeUser.ELEVE)}}function Nt(i,s){if(1&i&&(e.TgZ(0,"button",26),e._UZ(1,"span",25),e._uU(2," Familles "),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("listContact",t.famillesAll)("typeContact",t.edTypeUser.FAMILLE_RESPONSABLE)}}function qt(i,s){if(1&i&&(e.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"strong"),e._uU(4,"Relancer"),e.qZA(),e._uU(5," ceux qui n'ont encore "),e.TgZ(6,"b"),e._uU(7,"rien rendu"),e.qZA(),e.YNc(8,It,3,2,"button",22),e.YNc(9,Jt,3,2,"button",23),e.qZA(),e.TgZ(10,"div",9)(11,"strong"),e._uU(12,"\xc9crire \xe0 tous"),e.qZA(),e.YNc(13,Ft,3,2,"button",22),e.YNc(14,Nt,3,2,"button",23),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(8),e.Q6J("ngIf",t.messagerieStore.canSendMessageUser(t.edTypeUser.ELEVE)&&t.elevesWithNoRendu.length>0),e.xp6(1),e.Q6J("ngIf",t.messagerieStore.canSendMessageUser(t.edTypeUser.FAMILLE)&&t.famillesWithNoRendu.length>0),e.xp6(4),e.Q6J("ngIf",t.messagerieStore.canSendMessageUser(t.edTypeUser.ELEVE)&&t.elevesAll.length>0),e.xp6(1),e.Q6J("ngIf",t.messagerieStore.canSendMessageUser(t.edTypeUser.FAMILLE)&&t.famillesAll.length>0)}}function Lt(i,s){if(1&i&&(e.TgZ(0,"div",4)(1,"div",27)(2,"small",28),e._UZ(3,"i",29),e._uU(4),e.ALo(5,"edDate"),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(4),e.hij(" La date limite de rendu est le ",e.xi3(5,1,t.dateButoireRendu,"EEEE d MMMM")," ")}}function Yt(i,s){if(1&i&&(e.TgZ(0,"div",30)(1,"button",31),e._UZ(2,"i",32),e._uU(3," T\xe9l\xe9charger l'ensemble des copies rendues "),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("fileId",t.currentCDT.idCDT)("fileType",t.typeFichier.FICHIER_CDT_RENDU)}}function Rt(i,s){1&i&&(e.TgZ(0,"tr")(1,"th",33),e._uU(2,"\xc9l\xe8ve"),e.qZA(),e.TgZ(3,"th",34),e._uU(4,"Rendu"),e.qZA(),e.TgZ(5,"th",34),e._uU(6,"Correctif"),e.qZA(),e.TgZ(7,"th",34),e._UZ(8,"i",35),e._uU(9," Commentaire "),e.qZA()())}function Qt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr",36),e.NdJ("beforeUpdate",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onBeforeDCCEleveUpdate())})("afterUpdate",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onAfterDCCEleveUpdate())}),e.qZA()}if(2&i){const t=s.item,n=e.oxw(2);e.Q6J("dccEleve",t)("currentCDT",n.currentCDT)}}function Vt(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,qt,15,4,"div",2),e.TgZ(2,"div",3)(3,"div",4)(4,"div",5)(5,"ed-input-files",6),e.NdJ("successUploadQueue",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onUploadQueueSuccess(o))}),e.qZA()()()(),e.TgZ(6,"div",7),e.YNc(7,Lt,6,4,"div",8),e.TgZ(8,"div",4)(9,"div",9)(10,"h4"),e._UZ(11,"i",10),e._uU(12),e.qZA()(),e.YNc(13,Yt,4,2,"div",11),e.qZA(),e.TgZ(14,"div",12)(15,"ed-smart-table",13),e.YNc(16,Rt,10,0,"ng-template",14),e.YNc(17,Qt,1,2,"ng-template",15),e.qZA()(),e.TgZ(18,"div",16)(19,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.deposerCorrectifsDansCasiersEleves())}),e._UZ(20,"i",18),e._uU(21," D\xe9poser les correctifs dans les casiers des \xe9l\xe8ves "),e.qZA()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.messagerieStore.canSendMessageUser(t.edTypeUser.ELEVE)||t.messagerieStore.canSendMessageUser(t.edTypeUser.FAMILLE)),e.xp6(4),e.Q6J("dropzoneConfig",t.dropZoneConfig)("config",t.inputFilesConfig),e.xp6(2),e.Q6J("ngIf",t.currentCDT.entityLibelle),e.xp6(5),e.AsE(" Nombre de copies rendues: ",t.dcc.nbCopies||0,"",t.dcc.nbCopiesTotal?"/"+t.dcc.nbCopiesTotal:""," "),e.xp6(1),e.Q6J("ngIf",t.dcc.nbCopies>0),e.xp6(2),e.Q6J("datas",t.dcc.eleves)}}let Ce=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h,k,x){super(),this.authStore=t,this.cahierDeTexteService=n,this.cahierDeTexteStore=o,this.uiLoaderService=a,this.messagerieStore=c,this.cd=p,this.loaderService=h,this.uiService=k,this.modalService=x,this.edTypeUser=r.dcH,this.typeFichier=r.Vav,this.elevesWithNoRendu=[],this.elevesAll=[],this.famillesWithNoRendu=[],this.famillesAll=[],this.inputFilesConfig={mode:r.qt_.CDT_CORRECTIFS_GLOBAL,libelleTitre:"D\xe9posez un correctif global pour l'ensemble des \xe9l\xe8ves ici, ou s\xe9lectionnez un fichier \xe0 l'aide du bouton.",fromCloudEnabled:!0,dropzoneContainer:"#correctif_global"},this.dropZoneConfig={previewsContainer:!1,url:`${(0,w.Je)()}/televersement.awp?verbe=post&mode=${r.qt_.CDT_CORRECTIFS_GLOBAL}`}}ngOnInit(){const t=+this.authStore.currentUser.listParametresIndividuels("nbJoursMaxRenduDevoirCDT");this.dateButoireRendu=r.C_1.addNbJourToDate(this.currentCDT.date,t)}ngOnChanges(t){Object.isExists(this.sub)&&this.sub.unsubscribe(),this.sub=this.cahierDeTexteStore.selectDCCSlot(this.currentCDT.idCDT).pipe((0,u.b)(n=>{if(!Object.isExists(n))return;this.dcc=new r.O$2(n);const o={};this.dcc.eleves.forEach(a=>{o[a.eleve.id]=a.idPathCorrectifs}),this.dropZoneConfig={...this.dropZoneConfig,params:{tabContexte:o}},this.cd.markForCheck(),this.initDestinataires()}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.refresh()}ngOnDestroy(){return Object.isExists(this.sub)&&this.sub.unsubscribe(),super.ngOnDestroy()}refresh(t=!1){this.loader=this.uiLoaderService.show(this),this.cd.markForCheck(),this.cahierDeTexteService.getCopiesCorrectifs(this.currentCDT,t).pipe((0,C.x)(()=>this.uiLoaderService.hide(this))).subscribe()}initDestinataires(){!Object.isExists(this.dcc)||(this.famillesAll=this.dcc.contactsFamilles.map(t=>r.tHm.convertUserToContactMessagerie(t.responsable)),this.elevesAll=this.dcc.eleves.edPluckFlatten("eleve").map(t=>r.tHm.convertUserToContactMessagerie(t)),this.elevesWithNoRendu=[],this.famillesWithNoRendu=[],this.dcc.eleves.forEach(t=>{if(t.copies>0)return;this.elevesWithNoRendu.push(r.tHm.convertUserToContactMessagerie(t.eleve));const n=this.dcc.contactsFamilles.filter(o=>o.id===t.eleve.id);n.length>0&&(this.famillesWithNoRendu=[...this.famillesWithNoRendu,...n.map(o=>r.tHm.convertUserToContactMessagerie(o.responsable))])}))}onBeforeDCCEleveUpdate(){this.loader=this.loaderService.show(this)}onAfterDCCEleveUpdate(){this.loaderService.hide(this)}onUploadQueueSuccess(t){this.dcc.eleves.forEach(n=>{this.cahierDeTexteStore.addCorrectifDevoir(this.currentCDT.idCDT,n.eleve.id,t)}),this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 d\xe9pos\xe9s dans le casier des \xe9l\xe8ves.","Fichiers enregistr\xe9s")}deposerCorrectifsDansCasiersEleves(){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"D\xe9poser les correctifs dans le casier des l'\xe9l\xe8ve",message:'\n        <p>\xcates-vous vraiment s\xfbr de vouloir d\xe9poser ces correctifs dans le casier de l\'ensemble des \xe9l\xe8ves ?</p>\n        <p class="text-danger">Attention ! Une fois d\xe9pos\xe9s <strong>vous ne pourrez plus modifier les documents</strong></p>\n      ',btnConfirm:"Valider",btnCancel:"Non"},ignoreBackdropClick:!0};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(o=>(this.loader=this.loaderService.show(this),this.cd.markForCheck(),o===E.G.validation?this.cahierDeTexteService.validerDepotCorrectifGlobal(this.currentCDT.idCDT):(0,U.of)(void 0))),(0,u.b)(o=>{o?this.uiService.notifyEvent(r.DOJ.genericSuccess,"Les fichiers ont bien \xe9t\xe9 d\xe9pos\xe9s dans le casier des \xe9l\xe8ves.","Fichiers enregistr\xe9s","icon-ed_cahierdetexte"):!1===o&&this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Le d\xe9pot de vos documents a \xe9chou\xe9.","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(r.mYE),e.Y36(r.x1h),e.Y36(y.S),e.Y36(r.q0O),e.Y36(e.sBO),e.Y36(y.S),e.Y36(r.VLf),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-dashboard-copies-correctifs"]],inputs:{currentCDT:"currentCDT"},features:[e.qOj,e.TTD],decls:2,vars:2,consts:[[1,"dashboard-copies-correctifs",3,"ngBusy"],[4,"ngIf"],["class","ed-card p-2 without-margin-top",4,"ngIf"],[1,"ed-card","p-2","margin-top-10"],[1,"row"],["id","correctif_global",1,"col-lg-12","dropzone-container"],[3,"dropzoneConfig","config","successUploadQueue"],[1,"ed-card","p-2"],["class","row",4,"ngIf"],[1,"col-lg-5"],["aria-hidden","true",1,"fa","fa-cloud-upload"],["class","col-lg-7 text-end",4,"ngIf"],[1,"margin-top-10"],[3,"datas"],["edSmartTableHeaderTmp",""],["edSmartTableBodyTmp",""],[1,"col-lg-12","text-center"],["type","button","title","D\xe9poser les correctifs dans les casiers des \xe9l\xe8ves",1,"btn","btn-primary","btn-success","btn-sm","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-share-square-o"],[1,"ed-card","p-2","without-margin-top"],[1,"row","d-print-none"],[1,"col-lg-7"],["type","button","class","btn btn-primary btn-sm margin-whitespace","edMessageTo","","title","Envoyer un message aux \xe9l\xe8ves",3,"listContact","typeContact",4,"ngIf"],["type","button","class","btn btn-primary btn-sm margin-whitespace","edMessageTo","","title","Envoyer un message aux familles",3,"listContact","typeContact",4,"ngIf"],["type","button","edMessageTo","","title","Envoyer un message aux \xe9l\xe8ves",1,"btn","btn-primary","btn-sm","margin-whitespace",3,"listContact","typeContact"],[1,"fa","fa-2x","icon-ed_messagerie"],["type","button","edMessageTo","","title","Envoyer un message aux familles",1,"btn","btn-primary","btn-sm","margin-whitespace",3,"listContact","typeContact"],[1,"col-lg-12"],[1,"text-warning"],["aria-hidden","true",1,"fa","fa-exclamation-triangle"],[1,"col-lg-7","text-end"],["type","button","title","T\xe9l\xe9charger l'ensemble des copies","edTelechargement","",1,"btn","btn-primary","btn-success","btn-sm","d-print-none",3,"fileId","fileType"],["aria-hidden","true",1,"fa","fa-download"],["stSort","eleve.nom",1,"sortable-header"],[1,"text-center"],["aria-hidden","true",1,"fa","fa-comments"],["ed-cdt-tr-eleve-dashboard-copies-correctifs","",3,"dccEleve","currentCDT","beforeUpdate","afterUpdate"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Vt,22,8,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",n.dcc))},dependencies:[l.O5,T.DC,me.L,fe.c,$.r,$.w,dt.x,re.x,lt.s,Pt,r.ifA],changeDetection:0}),i})();function Gt(i,s){if(1&i&&(e.TgZ(0,"span",9),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.lnq(" ",t.currentCDT.entityLibelle," - ",t.currentCDT.matiereLibelle?t.currentCDT.matiereLibelle:t.currentCDT.matiereCode," - ",e.xi3(2,3,t.currentCDT.date,"EEEE d MMMM")," ")}}let Bt=(()=>{class i{constructor(t){this.modalRef=t}refresh(){this.cdtDashboardCopiesCorrectifsComponent.refresh(!0)}close(){this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-dashboard-copies-correctifs-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ce,5),2&t){let o;e.iGM(o=e.CRH())&&(n.cdtDashboardCopiesCorrectifsComponent=o.first)}},inputs:{currentCDT:"currentCDT"},decls:12,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","title","Rafra\xeechir les donn\xe9es",1,"btn","btn-secondary","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-refresh"],["class","modal-subtitle",4,"ngIf"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body"],[3,"currentCDT"],[1,"modal-footer"],[1,"modal-subtitle"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"div",0)(2,"div")(3,"h3",1),e._uU(4," G\xe9rer les copies et les correctifs "),e.TgZ(5,"button",2),e.NdJ("click",function(){return n.refresh()}),e._UZ(6,"i",3),e.qZA()(),e.YNc(7,Gt,3,6,"span",4),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(9,"div",6),e._UZ(10,"ed-cdt-dashboard-copies-correctifs",7),e.qZA(),e._UZ(11,"div",8),e.qZA()),2&t&&(e.xp6(7),e.Q6J("ngIf",n.currentCDT.entityLibelle),e.xp6(3),e.Q6J("currentCDT",n.currentCDT))},dependencies:[l.O5,Ce,r.ifA],changeDetection:0}),i})();function jt(i,s){if(1&i&&(e.TgZ(0,"strong")(1,"u"),e._uU(2),e.ALo(3,"edDate"),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.xi3(3,1,t.date,"dd/MM/y"))}}function $t(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,jt,4,4,"strong",10),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf",!0===t.group_by_CHANGED),e.xp6(2),e.Oqu(t.matiere)}}const Ht=function(){return["date:asc"]},Kt=function(){return["date"]};function zt(i,s){if(1&i&&(e.TgZ(0,"div",8),e.YNc(1,$t,4,2,"div",9),e.ALo(2,"groupBy"),e.ALo(3,"orderBy"),e.ALo(4,"trackByProperty"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,2,e.xi3(3,5,t.listInterrogation,e.DdM(10,Ht)),e.DdM(11,Kt)))("ngForTrackBy",e.lcZ(4,8,"date"))}}function Wt(i,s){1&i&&(e.TgZ(0,"div",11),e._uU(1,"Aucun contr\xf4le n'est disponible"),e.qZA())}let Xt=(()=>{class i{constructor(t,n){this.cahierDeTexteService=t,this.modalRef=n,this.edTypeClasseGroupeEntity=r.JBS}ngOnInit(){this.loader=this.cahierDeTexteService.listeInterrogations(this.entity.id,this.entity.typeEntity).pipe((0,u.b)(t=>{this.listInterrogation=Array.isArray(t)?t.map(n=>new r.iEn(n)):[]})).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.mYE),e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-interrogations-classe-modal"]],inputs:{entity:"entity"},decls:9,vars:5,consts:[[1,"modal-header",3,"ngBusy"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"clearfix"],["id","cdtInterrogationClasse",1,"modal-body"],["class","ui-list-view-bordered ui-list-view",4,"ngIf"],["class","jumbotron",4,"ngIf"],[1,"modal-footer"],[1,"ui-list-view-bordered","ui-list-view"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"jumbotron"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.modalRef.hide()}),e.qZA(),e._UZ(4,"div",3),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,zt,5,12,"div",5),e.YNc(7,Wt,2,0,"div",6),e.qZA(),e._UZ(8,"div",7)),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(2),e.AsE("Liste des contr\xf4les \xe0 venir ",n.entity.typeEntity===n.edTypeClasseGroupeEntity.CLASSE?"de la classe":"du groupe"," ",n.entity.libelle,""),e.xp6(4),e.Q6J("ngIf",(null==n.listInterrogation?null:n.listInterrogation.length)>0),e.xp6(1),e.Q6J("ngIf",0===(null==n.listInterrogation?null:n.listInterrogation.length)))},dependencies:[l.sg,l.O5,T.DC,r.d0N,r.ifA,r.lfJ,Z.$],styles:["#cdtInterrogationClasse[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:10px}#cdtInterrogationClasse[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--light-primary-color)}"],changeDetection:0}),i})();var L=d(94702),M=d(59245),he=d(91752),ce=d(99533),K=d(75177),z=d(87338),ei=d(3971);function ti(i,s){1&i&&(e.TgZ(0,"h4"),e._UZ(1,"i",3),e._uU(2," \xc9l\xe9ments de programme "),e.qZA())}function ii(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"h4")(1,"button",4),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.associateElemProg())}),e._UZ(2,"i",3),e._uU(3," \xc9l\xe9ments de programme "),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.associateElemProg())}),e._UZ(5,"i",6),e.qZA()()}}function ni(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.dissocierElemProg(o))}),e._UZ(1,"i",12),e.qZA()}}function oi(i,s){if(1&i&&(e.TgZ(0,"li"),e._uU(1),e.YNc(2,ni,2,0,"button",10),e.qZA()),2&i){const t=s.$implicit,n=e.oxw(2);e.xp6(1),e.hij(" ",t.libelle," "),e.xp6(1),e.Q6J("ngIf",!n.readonly)}}function ri(i,s){if(1&i&&(e.TgZ(0,"div",7)(1,"ul",8),e.YNc(2,oi,3,2,"li",9),e.ALo(3,"trackByProperty"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.elementsProg)("ngForTrackBy",e.lcZ(3,2,"id"))}}let ge=(()=>{class i{constructor(t,n,o){this.uiService=t,this.modalService=n,this.cahierDeTexteService=o,this.readonly=!1,this.beforeSlotUpdate=new e.vpe,this.afterSlotUpdate=new e.vpe}associateElemProg(){const t={prof:this.prof,selectedItem:this.selectedItem,catalogueReadOnly:!0,moduleSource:"CDT",sideCDT:this.side},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0};this.modalService.show(ei.R,n)}dissocierElemProg(t){if(this.selectedItem instanceof r.B5X){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Supprimer l'\xe9l\xe8ment de programme",message:`Confirmez-vous la suppression de l'\xe9l\xe9ment de programme <strong>${t.libelle}</strong> ?`}};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,B.h)(o=>o===E.G.validation),(0,D.w)(o=>{this.beforeSlotUpdate.emit();const a=new r.B5X(this.selectedItem);return a.typeSaisie=this.side===r.P2J.AFAIRE?r.ce3.T:r.ce3.C,this.cahierDeTexteService.dissociateElemProg(a,t)}),(0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"L'\xe9l\xe9ment de programme a bien \xe9t\xe9 supprim\xe9","Suppression","icon-ed_cahierdetexte")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Suppression impossible","Erreur"),b.E)),(0,C.x)(()=>this.afterSlotUpdate.emit())).subscribe()}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.VLf),e.Y36(g.tT),e.Y36(r.mYE))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-elems-prog"]],inputs:{elementsProg:"elementsProg",readonly:"readonly",prof:"prof",selectedItem:"selectedItem",side:"side"},outputs:{beforeSlotUpdate:"beforeSlotUpdate",afterSlotUpdate:"afterSlotUpdate"},decls:4,vars:3,consts:[[1,"ed-cdt-elems-prog"],[4,"ngIf"],["class","",4,"ngIf"],["aria-hidden","true",1,"fa","fa-puzzle-piece","size-17"],["type","button",1,"btn","active","no-background","no-padding",3,"click"],["type","button","aria-label","Ajouter des \xe9l\xe9ments de programme","title","Ajouter un \xe9l\xe9ment de programme",1,"btn","btn-primary-color","no-background","no-padding","float-end",3,"click"],[1,"fa","fa-plus-circle","size-23"],[1,""],[1,"list-elem"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","margin-whitespace btn btn-danger-color","title","Dissocier cet \xe9l\xe9ment de programme","type","button",3,"click",4,"ngIf"],["title","Dissocier cet \xe9l\xe9ment de programme","type","button",1,"margin-whitespace","btn","btn-danger-color",3,"click"],["aria-hidden","true",1,"fa","fa-trash","size-17"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ti,3,0,"h4",1),e.YNc(2,ii,6,0,"h4",1),e.YNc(3,ri,4,4,"div",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.readonly),e.xp6(1),e.Q6J("ngIf",!n.readonly),e.xp6(1),e.Q6J("ngIf",n.elementsProg.length>0))},dependencies:[l.sg,l.O5,Z.$],encapsulation:2}),i})();const ve=function(i){return{"has-error":i}};let si=(()=>{class i{constructor(t){this.modalRef=t,this.lienManuel=new r.my1,this.onClose$=new oe.x}ngOnDestroy(){this.onClose$.complete()}save(){this.onClose$.next(this.lienManuel),this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-ajout-lien-manuel-modal"]],decls:29,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body"],["name","formAjoutLien"],["formAjoutLien","ngForm"],[1,"row",3,"ngClass"],["for","libelle",1,"col-lg-2","col-form-label"],[1,"col-lg-10"],["id","libelle","name","libelle","type","text","placeholder","Le libell\xe9 de la ressource","required","",1,"form-control",3,"ngModel","ngModelChange"],["libelle","ngModel"],["for","url",1,"col-lg-2","col-form-label"],["id","url","name","url","type","text","placeholder","Le lien de la ressource","required","",1,"form-control",3,"ngModel","ngModelChange"],["url","ngModel"],[1,"form-text"],[1,"modal-footer"],[1,"w-100"],["id","button2id","name","button2id","type","button",1,"btn","btn-danger","float-start",3,"click"],["id","button1id","name","button1id","type","button",1,"btn","btn-success","float-end",3,"disabled","click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Ajout d'un lien Biblio Manuels"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.modalRef.hide()}),e.qZA()(),e.TgZ(4,"div",3)(5,"div")(6,"form",4,5)(8,"fieldset")(9,"div",6)(10,"label",7),e._uU(11,"Libell\xe9"),e.qZA(),e.TgZ(12,"div",8)(13,"input",9,10),e.NdJ("ngModelChange",function(a){return n.lienManuel.libelle=a}),e.qZA()()(),e.TgZ(15,"div",6)(16,"label",11),e._uU(17,"Lien"),e.qZA(),e.TgZ(18,"div",8)(19,"input",12,13),e.NdJ("ngModelChange",function(a){return n.lienManuel.url=a}),e.qZA(),e.TgZ(21,"span",14),e._uU(22,"Ce lien est obtenu directement depuis l'interface du Biblio Manuel"),e.qZA()()()()()()(),e.TgZ(23,"div",15)(24,"div",16)(25,"button",17),e.NdJ("click",function(){return n.modalRef.hide()}),e._uU(26,"Annuler"),e.qZA(),e.TgZ(27,"button",18),e.NdJ("click",function(){return n.save()}),e._uU(28," Ajouter "),e.qZA()()()),2&t){const o=e.MAs(7),a=e.MAs(14),c=e.MAs(20);e.xp6(9),e.Q6J("ngClass",e.VKq(5,ve,a.pristine||a.invalid)),e.xp6(4),e.Q6J("ngModel",n.lienManuel.libelle),e.xp6(2),e.Q6J("ngClass",e.VKq(7,ve,c.pristine||c.invalid)),e.xp6(4),e.Q6J("ngModel",n.lienManuel.url),e.xp6(8),e.Q6J("disabled",o.pristine||o.invalid)}},dependencies:[l.mk,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.On,_.F],changeDetection:0}),i})();var ai=d(34141);function ci(i,s){1&i&&(e.TgZ(0,"h4"),e._UZ(1,"i",3),e._uU(2," Ressources Biblio Manuels "),e.qZA())}function di(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"h4",4)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.associateLienManuel())}),e._UZ(2,"i",3),e._uU(3," Ressources Biblio Manuels "),e.qZA(),e.TgZ(4,"button",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.associateLienManuel())}),e._UZ(5,"i",7),e.qZA(),e._UZ(6,"div",8),e.qZA()}}function li(i,s){1&i&&e._UZ(0,"i",14)}function ui(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.dissocierLienManuel(o))}),e._UZ(1,"i",16),e.qZA()}}const pi=function(i){return{"margin-whitespace":i}},_i=function(){return[]};function mi(i,s){if(1&i&&(e.TgZ(0,"li"),e.YNc(1,li,1,0,"i",11),e.TgZ(2,"a",12),e._uU(3),e.qZA(),e.YNc(4,ui,2,0,"button",13),e.qZA()),2&i){const t=s.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.readonly),e.xp6(1),e.Tol(e.VKq(7,pi,n.readonly)),e.Q6J("href",t.url,e.LSH)("routerLink",e.DdM(9,_i)),e.xp6(1),e.Oqu(t.libelle),e.xp6(1),e.Q6J("ngIf",!n.readonly)}}function fi(i,s){if(1&i&&(e.TgZ(0,"div")(1,"ul",9),e.YNc(2,mi,5,10,"li",10),e.ALo(3,"trackByProperty"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.liensManuel)("ngForTrackBy",e.lcZ(3,2,"id"))}}let be=(()=>{class i{constructor(t,n,o){this.cahierDeTexteService=t,this.uiService=n,this.modalService=o,this.readonly=!1,this.beforeSlotUpdate=new e.vpe,this.afterSlotUpdate=new e.vpe}get liensManuel(){if(Object.isExists(this.slot))return this.slot[this.side].liensManuel;if(Object.isExists(this.cdtMatiere)){if(this.side===r.P2J.AFAIRE)return this.cdtMatiere.aFaire.liensManuel;if(this.side===r.P2J.SEANCE)return this.cdtMatiere.contenuDeSeance.liensManuel}return[]}associateLienManuel(){Object.isExists(this.slot)&&this.modalService.show(si,{id:this.modalService.getModalsCount()+1}).content.onClose$.pipe((0,D.w)(n=>(this.beforeSlotUpdate.emit(),this.cahierDeTexteService.associateLienManuel(this.slot,this.side,n))),(0,u.b)(n=>{!0===n&&this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre lien a bien \xe9t\xe9 associ\xe9","Association d'un lien BiblioManuel","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterSlotUpdate.emit()),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Association d'un lien BiblioManuel","fa fa-warning"))).subscribe()}dissocierLienManuel(t){if(!Object.isExists(this.slot))return;const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Supprimer le lien Biblio Manuels",message:"Confirmez-vous la suppression du lien Biblio Manuels ?"}};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,B.h)(o=>o===E.G.validation),(0,D.w)(o=>(this.beforeSlotUpdate.emit(),this.cahierDeTexteService.dissociateLienManuel(this.slot,this.side,t))),(0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre lien a bien \xe9t\xe9 dissoci\xe9","Dissociation d'un lien manuel","icon-ed_cahierdetexte")}),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Dissociation d'un lien manuel","fa fa-warning")),(0,C.x)(()=>this.afterSlotUpdate.emit())).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-ressources-biblio-manuel"]],inputs:{slot:"slot",cdtMatiere:"cdtMatiere",side:"side",readonly:"readonly"},outputs:{beforeSlotUpdate:"beforeSlotUpdate",afterSlotUpdate:"afterSlotUpdate"},decls:4,vars:3,consts:[[1,"ed-cdt-ressources-biblio-manuel"],[4,"ngIf"],["class","cliquable",4,"ngIf"],["aria-hidden","true",1,"fa","fa-book","size-17"],[1,"cliquable"],["type","button",1,"btn","active","no-background","no-padding",3,"click"],["title","Ajouter une ressource Biblio Manuels","aria-label","Ajouter une ressource Biblio Manuels","type","button",1,"btn","btn-primary-color","no-background","no-padding","float-end",3,"click"],[1,"fa","fa-plus-circle","size-23"],[1,"clearfix"],[1,"list-elem"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","fa fa-external-link","aria-hidden","true",4,"ngIf"],["edGoToService","","target","other","role","button",3,"href","routerLink"],["title","Dissocier ce lien","class","btn btn-link btn-danger-color margin-whitespace","type","button",3,"click",4,"ngIf"],["aria-hidden","true",1,"fa","fa-external-link"],["title","Dissocier ce lien","type","button",1,"btn","btn-link","btn-danger-color","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-trash","size-17"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ci,3,0,"h4",1),e.YNc(2,di,7,0,"h4",2),e.YNc(3,fi,4,4,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.readonly),e.xp6(1),e.Q6J("ngIf",!n.readonly),e.xp6(1),e.Q6J("ngIf",n.liensManuel.length>0))},dependencies:[l.sg,l.O5,q.yS,ai.R,Z.$],changeDetection:0}),i})(),Ci=(()=>{class i{constructor(t){this.router=t}openQCM(){this.router.navigate(["",{outlets:{auxiliaryModal:["repondre-au-qcm"]}}],{skipLocationChange:!0,queryParams:{idQCM:this.aFaire.qcm.idQCM,titre:this.aFaire.qcm.titre,idAssociation:this.aFaire.qcm.idAssociation}}).catch(()=>console.error("CdtQcmComponent open qcm"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(q.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-qcm"]],inputs:{aFaire:"aFaire"},decls:6,vars:1,consts:[["type","button",1,"btn","btn-link",3,"click"],["aria-hidden","true",1,"i-small","icon-ed_qcm"],[1,"margin-whitespace"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"h4")(2,"button",0),e.NdJ("click",function(){return n.openQCM()}),e._UZ(3,"i",1),e.TgZ(4,"span",2),e._uU(5),e.qZA()()()()),2&t&&(e.xp6(5),e.hij("QCM : ",n.aFaire.qcm.titre,""))},encapsulation:2,changeDetection:0}),i})();var de=d(39653);const Te=function(i,s){return{travail:i,contenu:s}};function hi(i,s){if(1&i&&(e.TgZ(0,"div",4)(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"hr",5),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.WLB(2,Te,t.side===t.sideCDT.AFAIRE,t.side===t.sideCDT.SEANCE)),e.xp6(2),e.Oqu(t.side===t.sideCDT.AFAIRE?"Travail \xe0 faire":"Contenu de s\xe9ance")}}function gi(i,s){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.side===t.sideCDT.AFAIRE?"Travail \xe0 faire":"Contenu de s\xe9ance")}}function vi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.openSuppression())}),e._UZ(1,"i",15),e.qZA()}}function bi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.openDuplication())}),e._UZ(1,"i",17),e.qZA()}}function Ti(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.setModeEdit(!0))}),e._UZ(1,"i",19),e.qZA()}}function xi(i,s){if(1&i&&(e.TgZ(0,"div",10),e.YNc(1,vi,2,0,"button",11),e.YNc(2,bi,2,0,"button",12),e.YNc(3,Ti,2,0,"button",13),e.qZA()),2&i){const t=e.oxw().ngIf,n=e.oxw();e.xp6(1),e.Q6J("ngIf",t.idCDT&&n.sideContent),e.xp6(1),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire&&n.parametrage.edt&&t.idCDT&&n.sideContent),e.xp6(1),e.Q6J("ngIf",!n.isModeEdit)}}function Ei(i,s){1&i&&e._UZ(0,"hr",5)}const yi=function(i,s){return{"donne-le-modale-saisie":i,"form-text":s}};function Si(i,s){if(1&i&&(e.TgZ(0,"span",20),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("ngClass",e.WLB(5,yi,t.typeViewCDT===t.TYPES_VIEW.EDT,t.typeViewCDT===t.TYPES_VIEW.EDT)),e.xp6(1),e.hij(" Donn\xe9 le ",e.xi3(2,2,t.sideContent.donneLe,"EEEE d LLLL")," ")}}function Mi(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",6),e.YNc(2,gi,2,1,"h3",3),e.YNc(3,xi,4,3,"div",7),e.qZA(),e.YNc(4,Ei,1,0,"hr",8),e.YNc(5,Si,3,8,"span",9),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(5,Te,t.side===t.sideCDT.AFAIRE,t.side===t.sideCDT.SEANCE)),e.xp6(1),e.Q6J("ngIf",t.typeViewCDT!==t.TYPES_VIEW.EDT),e.xp6(1),e.Q6J("ngIf",!t.isModeEdit),e.xp6(1),e.Q6J("ngIf",t.typeViewCDT!==t.TYPES_VIEW.EDT&&!t.isModeEdit),e.xp6(1),e.Q6J("ngIf",!t.isModeEdit&&t.side===t.sideCDT.AFAIRE&&t.sideContent&&t.sideContent.donneLe)}}function Di(i,s){if(1&i&&(e._UZ(0,"p",27),e.ALo(1,"filterHtml"),e.ALo(2,"base64")),2&i){const t=e.oxw(3);e.Q6J("content",t.sideContent.contenu)("innerHTML",e.lcZ(1,2,e.lcZ(2,4,t.sideContent.contenu)),e.oJD)}}function Zi(i,s){1&i&&(e.TgZ(0,"p",28),e._uU(1,"Double cliquez pour modifier"),e.qZA())}function Ai(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("dblclick",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.setModeEdit(!0))}),e.YNc(1,Di,3,6,"p",25),e.YNc(2,Zi,2,0,"p",26),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.sideContent),e.xp6(1),e.Q6J("ngIf",!t.sideContent||0===t.sideContent.contenu.length)}}function wi(i,s){if(1&i&&(e.TgZ(0,"h2",48),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(2).ngIf;e.xp6(1),e.lnq(" ",t.entityLibelle," - ",t.matiereLibelle," - ",e.xi3(2,3,t.date,"EEEE d LLLL")," ")}}function Ui(i,s){1&i&&(e.TgZ(0,"span",54),e._uU(1,"Le devoir ne sera visible qu'\xe0 partir de cette date."),e.qZA())}const Oi=function(){return[0]};function ki(i,s){if(1&i&&e._UZ(0,"input",55),2&i){const t=e.oxw(4);e.Q6J("bsConfig",t.datePickerConfig)("daysDisabled",e.DdM(3,Oi))("isOpen",t.isDatePickerOpen)}}function Pi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",56)(1,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.toggleDatePicker())}),e._UZ(2,"i",58),e.qZA()()}}function Ii(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(e.xi3(2,1,t.sideContent.donneLe,"EEEE d LLLL"))}}function Ji(i,s){if(1&i&&(e.TgZ(0,"div",49)(1,"label",50),e._uU(2,"Donn\xe9 le"),e.qZA(),e.YNc(3,Ui,2,0,"span",47),e.TgZ(4,"div",51),e.YNc(5,ki,1,4,"input",52),e.YNc(6,Pi,3,0,"span",53),e.qZA(),e.YNc(7,Ii,3,4,"span",3),e.qZA()),2&i){const t=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.parametrage.donneLeModifiable),e.xp6(2),e.Q6J("ngIf",t.parametrage.donneLeModifiable),e.xp6(1),e.Q6J("ngIf",t.parametrage.donneLeModifiable),e.xp6(1),e.Q6J("ngIf",!t.parametrage.donneLeModifiable)}}function Fi(i,s){1&i&&(e.TgZ(0,"div",59)(1,"div",36),e._UZ(2,"input",60),e.TgZ(3,"label",61),e._uU(4," Les \xe9l\xe8ves doivent rendre en ligne "),e.qZA()()())}function Ni(i,s){1&i&&(e.TgZ(0,"div",59)(1,"strong",62),e._UZ(2,"input",63),e._uU(3," Les \xe9l\xe8ves doivent rendre en ligne. "),e.qZA()())}function qi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.showInterrogationsClasse())}),e._UZ(1,"i",65),e.qZA()}if(2&i){const t=e.oxw(2).ngIf,n=e.oxw();e.MGl("title","Consulter les contr\xf4les \xe0 venir ",t.entityType===n.edTypeClasseGroupeEntity.CLASSE?"de la classe":"du groupe","")}}function Li(i,s){if(1&i&&(e.TgZ(0,"div",54),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(3).ngIf;e.xp6(1),e.hij(" Les \xe9l\xe8ves pourront envoyer des fichiers jusqu'au ",e.xi3(2,1,t.date,"EEEE d LLLL")," inclus. Vous pourrez ensuite t\xe9l\xe9charger un zip avec tous les devoirs. ")}}function Yi(i,s){if(1&i&&(e.TgZ(0,"div",66),e.YNc(1,Li,3,4,"div",47),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.parametrage.cloud)}}function Ri(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"button",72),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(5);return e.KtG(c.save(a))}),e._UZ(2,"i",73),e._uU(3," \xa0\xa0\xa0le "),e.TgZ(4,"strong"),e._uU(5),e.ALo(6,"edDate"),e.qZA()()()}if(2&i){const t=s.$implicit;e.xp6(5),e.Oqu(e.xi3(6,1,t.date,"EEEE d MMMM"))}}const Qi=function(){return["date"]};function Vi(i,s){if(1&i&&(e.TgZ(0,"ul",70),e.YNc(1,Ri,7,4,"li",71),e.ALo(2,"orderBy"),e.ALo(3,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,2,t.tabNextSlots,e.DdM(7,Qi)))("ngForTrackBy",e.lcZ(3,5,"$index"))}}function Gi(i,s){1&i&&(e.TgZ(0,"div",67)(1,"button",68),e._uU(2," Enregistrer puis saisir le travail pour "),e.qZA(),e.YNc(3,Vi,4,8,"ul",69),e.qZA())}function Bi(i,s){1&i&&(e.TgZ(0,"div",54),e._uU(1,"L'ajout de document sera disponible apr\xe8s l'enregistrement."),e.qZA())}const ji=function(i){return{"has-error":i}},$i=function(i,s){return{"col-lg-6":i,"col-lg-12":s}};function Hi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"form",29)(1,"div"),e.YNc(2,wi,3,6,"h2",30),e._UZ(3,"span",31),e.TgZ(4,"div",32),e.YNc(5,Ji,8,4,"div",33),e.YNc(6,Fi,5,0,"div",34),e.YNc(7,Ni,4,0,"div",34),e.TgZ(8,"div",35)(9,"div",36),e._UZ(10,"input",37),e.TgZ(11,"label",38),e._uU(12,"Interrogation ou contr\xf4le"),e.qZA(),e.YNc(13,qi,2,1,"button",39),e.qZA()()(),e.YNc(14,Yi,2,1,"div",40),e.qZA(),e.TgZ(15,"div",41)(16,"ckeditor",42),e.NdJ("change",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.editSlotForm.markAsDirty())}),e.qZA(),e.TgZ(17,"label",43),e._uU(18,"Si ce contenu est vide, rien ne sera affich\xe9 aux \xe9l\xe8ves"),e.qZA()(),e.YNc(19,Gi,4,0,"div",44),e.TgZ(20,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.save())}),e._uU(21," Enregistrer "),e.qZA(),e.TgZ(22,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.cancel())}),e._uU(23,"Annuler"),e.qZA(),e._UZ(24,"div",31),e.YNc(25,Bi,2,0,"div",47),e.qZA()}if(2&i){const t=e.oxw().ngIf,n=e.oxw();e.Q6J("formGroup",n.editSlotForm),e.xp6(2),e.Q6J("ngIf",n.typeViewCDT===n.TYPES_VIEW.EDT),e.xp6(2),e.Q6J("ngClass",e.VKq(14,ji,n.side===n.sideCDT.AFAIRE&&n.editSlotForm.get("donneLe").invalid)),e.xp6(1),e.Q6J("ngIf",n.side===n.sideCDT.AFAIRE),e.xp6(1),e.Q6J("ngIf",n.side===n.sideCDT.AFAIRE&&n.parametrage.cloud),e.xp6(1),e.Q6J("ngIf",n.side===n.sideCDT.AFAIRE&&!n.parametrage.cloud),e.xp6(1),e.Q6J("ngClass",e.WLB(16,$i,n.side===n.sideCDT.AFAIRE,n.side===n.sideCDT.SEANCE)),e.xp6(5),e.Q6J("ngIf",n.side===n.sideCDT.AFAIRE&&n.isClasseOrGroupeDefined()),e.xp6(1),e.Q6J("ngIf",n.side===n.sideCDT.AFAIRE),e.xp6(2),e.Q6J("config",n.ckeditorOptions)("required",!0),e.xp6(3),e.Q6J("ngIf",n.side===n.sideCDT.SEANCE&&n.tabNextSlots&&n.tabNextSlots.length>0),e.xp6(1),e.Q6J("disabled",n.side===n.sideCDT.AFAIRE&&n.editSlotForm.invalid),e.xp6(5),e.Q6J("ngIf",!t.idCDT)}}function Ki(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",21),e.YNc(2,Ai,3,2,"div",22),e.YNc(3,Hi,26,19,"form",23),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.isModeEdit),e.xp6(1),e.Q6J("ngIf",t.isModeEdit)}}function zi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"h4")(2,"button",77),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.dashBoardCopiesCorrectifs())}),e._UZ(3,"i",78),e._uU(4," G\xe9rer les copies / correctifs "),e.qZA()()()}}function Wi(i,s){if(1&i&&e._UZ(0,"ed-cdt-qcm",84),2&i){const t=e.oxw(5);e.Q6J("aFaire",t.sideContent)}}function Xi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ed-cdt-elems-prog",85),e.NdJ("afterSlotUpdate",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.afterSlotUpdate.emit())})("beforeSlotUpdate",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.beforeSlotUpdate.emit())}),e.qZA()}if(2&i){const t=e.oxw(4).ngIf,n=e.oxw();e.Q6J("selectedItem",t)("prof",n.prof)("side",n.side)("elementsProg",n.sideContent.elementsProg)}}function en(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ed-cdt-ressources-biblio-manuel",86),e.NdJ("afterSlotUpdate",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.afterSlotUpdate.emit())})("beforeSlotUpdate",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.beforeSlotUpdate.emit())}),e.qZA()}if(2&i){const t=e.oxw(4).ngIf,n=e.oxw();e.Q6J("side",n.side)("slot",t)}}function tn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ed-bloc-commentaires",87),e.NdJ("commentaireAdded",function(o){e.CHM(t);const a=e.oxw(5);return e.KtG(a.onCommentaireAdded(o))})("commentaireDeleted",function(o){e.CHM(t);const a=e.oxw(5);return e.KtG(a.onCommentaireDeleted(o))}),e.qZA()}if(2&i){const t=e.oxw(4).ngIf,n=e.oxw();e.Q6J("afficherCommentaires",!0)("afficherFormulaireCommentaires",!0)("idSupport",t.idCDT)("isModerateur",!0)("tabCommentaires",n.sideContent.commentaires)("typeSupport",n.side)}}function nn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,Wi,1,1,"ed-cdt-qcm",79),e.TgZ(2,"ed-cdt-documents",80),e.NdJ("deleteDocument",function(o){e.CHM(t);const a=e.oxw(4);return e.KtG(a.deleteDocument(o))})("successUpload",function(o){e.CHM(t);const a=e.oxw(4);return e.KtG(a.onUploadSuccess(o))}),e.qZA(),e.YNc(3,Xi,1,4,"ed-cdt-elems-prog",81),e.YNc(4,en,1,2,"ed-cdt-ressources-biblio-manuel",82),e.YNc(5,tn,1,6,"ed-bloc-commentaires",83),e._UZ(6,"div",31),e.qZA()}if(2&i){const t=e.oxw(3).ngIf,n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.sideContent.hasQCM),e.xp6(1),e.MGl("dropzoneContainer","#cdt-",n.side,""),e.Q6J("canAddDocuments",!0)("canDeleteDocuments",!0)("documents",n.sideContent.documents)("fromCloudEnabled",n.parametrage.cloud)("idContext",t.idCDT)("typeContext",n.side),e.xp6(1),e.Q6J("ngIf",t.idCycleEtab>0),e.xp6(1),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire&&n.parametrage.lienBiblioManuel),e.xp6(1),e.Q6J("ngIf",n.parametrage.commentaires)}}function on(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,zi,5,0,"div",3),e.YNc(2,nn,7,11,"div",3),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.sideContent.rendreEnLigne),e.xp6(1),e.Q6J("ngIf",!t.isModeEdit)}}function rn(i,s){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,on,3,2,"div",3),e.qZA()),2&i){const t=e.oxw().ngIf,n=e.oxw();e.MGl("id","cdt-",n.side,""),e.xp6(1),e.Q6J("ngIf",t.idCDT)}}function sn(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",74),e.YNc(2,rn,2,2,"div",75),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.sideContent&&!t.isModeEdit)}}const an=function(i,s,t,n){return{"colonne-travail-a-faire":i,"colonne-contenu-de-seance":s,"view-edt":t,"with-epingle":n}};let xe=(()=>{class i{constructor(t,n,o,a,c,p,h){this.modalService=t,this.formBuilder=n,this.cdtUserService=o,this.uiService=a,this.cahierDeTexteService=c,this.cahierDeTexteStore=p,this.authStore=h,this.TYPES_VIEW=r.a7m,this.sideCDT=r.P2J,this.ckeditorOptions=w.x$,this.edTypeClasseGroupeEntity=r.JBS,this.isDatePickerOpen=!1,this._datePipe=new r.ifA,this.beforeSlotUpdate=new e.vpe,this.afterSlotUpdate=new e.vpe}get isModeEdit(){return Object.isExists(this.sideContent)&&!0===this.sideContent.modeEdit}ngOnInit(){this.datePickerConfig=w.gL,this.slot$=this.cdtUserService.cdtProf.selectedSlot$.pipe((0,ne.U)(t=>{if(Object.isExists(t))return this._slot=new r.B5X(t),this.sideContent=this.getSideContent(),this.updateViewModeEdit(this.isModeEdit),this.prof={matiere:new r.vcu,devoirsClasse:[],id:this.authStore.currentUser.id,parametrages:void 0},new r.B5X(t)}),He(1),(0,Ke.x)())}ngOnDestroy(){this.isModeEdit&&this._slot.setModeEdit(this.side,!1)}updateViewModeEdit(t){!Object.isExists(this.sideContent)||(t?this.editSlotForm=this.formBuilder.group(this.side===r.P2J.AFAIRE?{donneLe:[new Date(this.sideContent.donneLe+"T00:00:00"),_.kI.required],rendreEnLigne:[this.sideContent.rendreEnLigne],interrogation:[this._slot.interrogation],contenu:[r.YC.base64decode(this.sideContent.contenu),_.kI.required]}:{interrogation:[this._slot.interrogation],contenu:[r.YC.base64decode(this.sideContent.contenu),_.kI.required]}):Object.isExists(this.editSlotForm)&&this.editSlotForm.reset(),this.side===r.P2J.SEANCE&&t&&(this.tabNextSlots=this.getNextSlots()))}setModeEdit(t){const n=new r.B5X(this._slot);n.setModeEdit(this.side,t),this.cdtUserService.selectSlot(n)}save(t){if(this.editSlotForm.value.contenu>1572864)return void this.uiService.notifyEvent(r.DOJ.genericError,"Enregistrement impossible. Votre saisie est trop grande (>1.5Mo). Utilisez plut\xf4t les documents joints.","Erreur");const n=new r.B5X(this._slot);n.interrogation=this.editSlotForm.value.interrogation,n[this.side].modeEdit=!1,this.side===r.P2J.AFAIRE?(n.aFaire.contenu=r.YC.base64encode(this.editSlotForm.value.contenu),n.aFaire.rendreEnLigne=this.editSlotForm.value.rendreEnLigne,n.aFaire.donneLe=this._datePipe.transform(this.editSlotForm.value.donneLe,"y-MM-dd"),n.travailAFaire=n.aFaire.contenu.length>0):(n.seance.contenu=r.YC.base64encode(this.editSlotForm.value.contenu),n.contenuDeSeance=n.seance.contenu.length>0),this.beforeSlotUpdate.emit(),this.cahierDeTexteService.save(n,this.side).pipe((0,u.b)(()=>{if(this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre saisie a bien \xe9t\xe9 prise en compte","Enregistrement effectu\xe9","icon-ed_cahierdetexte"),Object.isExists(t)){const o=new r.B5X(t);o.setModeEdit(this.sideCDT.AFAIRE,!0),this.cdtUserService.selectSlot(o)}}),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Erreur")),(0,C.x)(()=>this.afterSlotUpdate.emit())).subscribe()}cancel(){this.setModeEdit(!1)}openDuplication(){const t={id:this.modalService.getModalsCount()+1,initialState:{slot:this._slot,side:this.side},class:"modal-lg",providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(_e,t)}openSuppression(){const t={id:this.modalService.getModalsCount()+1,initialState:{btnCancel:"Annuler",btnConfirm:"Supprimer",lastChanceMessage:`<span class="text-danger">Attention : vous \xeates sur le point de supprimer le ${this.side===r.P2J.AFAIRE?"travail \xe0 faire":"contenu de s\xe9ance"}</span>`,title:`<i class="fa fa-warning"></i><span class="margin-whitespace">Suppression d'un ${this.side===r.P2J.AFAIRE?"travail \xe0 faire":"contenu de s\xe9ance"}</span>`,message:`<h4 class="text-danger">${this._slot.entityLibelle}${this._slot.matiereLibelle?" en "+this._slot.matiereLibelle:""} pour le ${this._datePipe.transform(this._slot.date,"d MMMM")}</h4><p class="text-danger">L'ensemble de la saisie, des \xe9ventuels commentaires, et les documents associ\xe9s seront supprim\xe9s d\xe9finitivement.</p>`},class:"modal-lg"};this.modalService.show(O.z,t),this.modalService.onHide.pipe((0,A.q)(1),(0,D.w)(n=>n===E.G.validation?(this.beforeSlotUpdate.emit(),this.cahierDeTexteService.delete(this._slot,this.side)):b.E),(0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"La saisie a bien \xe9t\xe9 supprim\xe9e","Effacement effectu\xe9","icon-ed_cahierdetexte")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur est survenu lors de la suppression","Erreur"),b.E)),(0,C.x)(()=>this.afterSlotUpdate.emit())).subscribe()}isEmpty(){return!0}dashBoardCopiesCorrectifs(){const t={id:this.modalService.getModalsCount()+1,class:"modal-lg",ignoreBackdropClick:!0,initialState:{currentCDT:this._slot}};this.modalService.show(Bt,t)}isClasseOrGroupeDefined(){return this.cdtUserService.cdtProf.classesGroupes.findIndex(t=>t.code===this._slot.entityCode)>-1}showInterrogationsClasse(){const t={id:this.modalService.getModalsCount()+1,initialState:{entity:new r.trj({id:this._slot.entityId,typeEntity:this._slot.entityType,libelle:this._slot.entityLibelle})}};this.modalService.show(Xt,t)}toggleDatePicker(){this.isDatePickerOpen=!this.isDatePickerOpen}onUploadSuccess(t){this.cahierDeTexteStore.addFile(t,this._slot,this.side)}deleteDocument(t){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Supprimer le fichier",message:`Confirmez-vous la suppression du fichier <strong>${t.libelle}</strong> ?`}};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,B.h)(o=>o===E.G.validation),(0,D.w)(o=>(this.beforeSlotUpdate.emit(),this.cahierDeTexteService.deleteFile(t,this._slot,this.side).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Le fichier a bien \xe9t\xe9 supprim\xe9 !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterSlotUpdate.emit())))),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Erreur","fa fa-warning"))).subscribe()}onCommentaireAdded(t){let n;this.beforeSlotUpdate.emit(),n=0===t.id?this.cahierDeTexteService.addComment(this._slot,this.side,t):this.cahierDeTexteService.updateComment(this._slot,this.side,t),n.pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,`Votre commentaire a bien \xe9t\xe9 ${0===t.id?"enregistr\xe9":"modifi\xe9"} !`,"Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterSlotUpdate.emit()),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Cahier de texte","fa fa-warning"))).subscribe()}onCommentaireDeleted(t){this.beforeSlotUpdate.emit(),this.cahierDeTexteService.deleteComment(this._slot,this.side,t).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre commentaire a bien \xe9t\xe9 supprim\xe9 !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterSlotUpdate.emit()),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Cahier de texte","fa fa-warning"))).subscribe()}isCurrentSlotInFuture(){return r.C_1.isDateFuture(this._slot.date)}getNextSlots(t=5){const n=this.cahierDeTexteStore.getCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id).filter(o=>o.entityCode===this._slot.entityCode&&o.matiereCode===this._slot.matiereCode&&o.date>this._slot.date).edUniq(["date","entityCode","matiereCode","idCDT"]).edSortBy("date");return n.length<=t?n:n.slice(0,t)}getSideContent(){let t;return Object.isExists(this._slot)||(t=void 0),this.side===r.P2J.AFAIRE&&Object.isExists(this._slot.aFaire)&&(t=this._slot.aFaire),this.side===r.P2J.SEANCE&&Object.isExists(this._slot.seance)&&(t=this._slot.seance),t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.tT),e.Y36(_.qu),e.Y36(m),e.Y36(r.VLf),e.Y36(r.mYE),e.Y36(r.x1h),e.Y36(r.CnD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-taf-seance"]],inputs:{parametrage:"parametrage",side:"side",typeViewCDT:"typeViewCDT"},outputs:{beforeSlotUpdate:"beforeSlotUpdate",afterSlotUpdate:"afterSlotUpdate"},decls:10,vars:18,consts:[[1,"ed-cdt-taf-seance","ed-card","card",3,"ngClass"],[1,"card-header"],["class","bloc-titre d-block",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"bloc-titre","d-block",3,"ngClass"],["role","separator"],[1,"bloc-titre",3,"ngClass"],["class","btn-group",4,"ngIf"],["role","separator",4,"ngIf"],["class","date devoir",3,"ngClass",4,"ngIf"],[1,"btn-group"],["type","button","class","btn btn-danger-color p-1 d-print-none","title","Supprimer","aria-label","Supprimer le contenu de s\xe9ance",3,"click",4,"ngIf"],["type","button","class","btn btn-primary-color p-1 trav d-print-none","aria-label","Dupliquer le contenu de s\xe9ance","title","Dupliquer",3,"click",4,"ngIf"],["type","button","class","btn btn-primary-color p-1 trav d-print-none","title","Modifier","aria-label","Modifier le contenu de s\xe9ance",3,"click",4,"ngIf"],["type","button","title","Supprimer","aria-label","Supprimer le contenu de s\xe9ance",1,"btn","btn-danger-color","p-1","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],["type","button","aria-label","Dupliquer le contenu de s\xe9ance","title","Dupliquer",1,"btn","btn-primary-color","p-1","trav","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-clone"],["type","button","title","Modifier","aria-label","Modifier le contenu de s\xe9ance",1,"btn","btn-primary-color","p-1","trav","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],[1,"date","devoir",3,"ngClass"],[1,"card-body"],["class","bloc-content flex-grow dblclick",3,"dblclick",4,"ngIf"],["name","editSlotForm",3,"formGroup","noValidate",4,"ngIf"],[1,"bloc-content","flex-grow","dblclick",3,"dblclick"],["class","contenu-non-maitrise ed-cke","edMathjax","",3,"content","innerHTML",4,"ngIf"],["class","contenu-non-maitrise dblclick",4,"ngIf"],["edMathjax","",1,"contenu-non-maitrise","ed-cke",3,"content","innerHTML"],[1,"contenu-non-maitrise","dblclick"],["name","editSlotForm",3,"formGroup","noValidate"],["class","float-start",4,"ngIf"],[1,"clearfix"],[1,"row",3,"ngClass"],["class","col-lg-12 mb-3",4,"ngIf"],["class","col-lg-6",4,"ngIf"],[3,"ngClass"],[1,"form-check"],["formControlName","interrogation","id","tafinterro","name","interrogation","type","checkbox",1,"form-check-input"],["for","tafinterro",1,"form-check-label"],["class","btn btn-primary-color ms-2 mt-0 no-background","id","show-interrogations",3,"title","click",4,"ngIf"],["class","col-lg-12",4,"ngIf"],[1,"mt-3"],["formControlName","contenu","id","contenu","name","contenu",3,"config","required","change"],["for","contenu",1,"form-label"],["class","float-end btn-group margin-whitespace","dropdown","",4,"ngIf"],["id","buttonModif","name","button1id",1,"btn","btn-success","float-end",3,"disabled","click"],["type","button","id","buttonSaveAFaire","name","buttonSaveAFaire",1,"btn","btn-danger","float-start",3,"click"],["class","form-text",4,"ngIf"],[1,"float-start"],[1,"col-lg-12","mb-3"],["for","donneLe",1,"form-label"],[1,"input-group"],["bsDatepicker","","class","input-calendar form-control","formControlName","donneLe","id","donneLe","name","donneLe","required","","type","text",3,"bsConfig","daysDisabled","isOpen",4,"ngIf"],["class","input-group-text input-group-md no-background",4,"ngIf"],[1,"form-text"],["bsDatepicker","","formControlName","donneLe","id","donneLe","name","donneLe","required","","type","text",1,"input-calendar","form-control",3,"bsConfig","daysDisabled","isOpen"],[1,"input-group-text","input-group-md","no-background"],["type","button",1,"btn","btn-primary-color","no-background",3,"click"],["aria-hidden","true",1,"fa","fa-calendar"],[1,"col-lg-6"],["formControlName","rendreEnLigne","name","rendreEnLigne","type","checkbox","id","checkRendreEnLigne",1,"form-check-input"],["title","Les \xe9l\xe8ves auront un formulaire pour rendre leur devoir en ligne.","for","checkRendreEnLigne",1,"form-check-label"],["title","Cette option n'est pas disponible, contactez votre \xe9tablissement"],["disabled","","type","checkbox",1,"form-check-input"],["id","show-interrogations",1,"btn","btn-primary-color","ms-2","mt-0","no-background",3,"title","click"],["aria-hidden","true",1,"fa","fa-eye"],[1,"col-lg-12"],["dropdown","",1,"float-end","btn-group","margin-whitespace"],["dropdownToggle","","id","dropdownSlots","type","button","aria-controls","dropdown-slots",1,"btn","btn-success","dropdown-toggle"],["aria-labelledby","dropdownSlots","class","dropdown-menu","id","dropdown-slots",4,"dropdownMenu"],["aria-labelledby","dropdownSlots","id","dropdown-slots",1,"dropdown-menu"],[4,"ngFor","ngForOf","ngForTrackBy"],["name","button1id","type","button",1,"dropdown-item",3,"click"],["aria-hidden","true",1,"icon-ed_save"],[1,"card-footer","legende"],["class","bloc-plus d-print-none dropzone-container",3,"id",4,"ngIf"],[1,"bloc-plus","d-print-none","dropzone-container",3,"id"],["type","button",1,"btn","btn-link",3,"click"],["aria-hidden","true",1,"i-small","fa","fa-graduation-cap"],[3,"aFaire",4,"ngIf"],["title","Documents",3,"canAddDocuments","canDeleteDocuments","documents","fromCloudEnabled","idContext","typeContext","dropzoneContainer","deleteDocument","successUpload"],[3,"selectedItem","prof","side","elementsProg","afterSlotUpdate","beforeSlotUpdate",4,"ngIf"],[3,"side","slot","afterSlotUpdate","beforeSlotUpdate",4,"ngIf"],[3,"afficherCommentaires","afficherFormulaireCommentaires","idSupport","isModerateur","tabCommentaires","typeSupport","commentaireAdded","commentaireDeleted",4,"ngIf"],[3,"aFaire"],[3,"selectedItem","prof","side","elementsProg","afterSlotUpdate","beforeSlotUpdate"],[3,"side","slot","afterSlotUpdate","beforeSlotUpdate"],[3,"afficherCommentaires","afficherFormulaireCommentaires","idSupport","isModerateur","tabCommentaires","typeSupport","commentaireAdded","commentaireDeleted"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,hi,4,5,"div",2),e.ALo(3,"async"),e.YNc(4,Mi,6,8,"ng-container",3),e.ALo(5,"async"),e.qZA(),e.YNc(6,Ki,4,2,"ng-container",3),e.ALo(7,"async"),e.YNc(8,sn,3,1,"ng-container",3),e.ALo(9,"async"),e.qZA()),2&t&&(e.Q6J("ngClass",e.l5B(13,an,n.side===n.sideCDT.AFAIRE,n.side===n.sideCDT.SEANCE,n.typeViewCDT===n.TYPES_VIEW.EDT,n.typeViewCDT!==n.TYPES_VIEW.EDT)),e.xp6(2),e.Q6J("ngIf",void 0===e.lcZ(3,5,n.slot$)&&!n.isModeEdit&&n.typeViewCDT===n.TYPES_VIEW.LIST),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,7,n.slot$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,9,n.slot$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,11,n.slot$)))},dependencies:[l.mk,l.sg,l.O5,_._Y,_.Fj,_.Wl,_.JJ,_.JL,_.Q7,_.sg,_.u,L.Np,L.Y5,M.Hz,M.Mq,M.TO,he.u,ce.L,K.M,z.C,ge,be,Ci,l.Ov,r.YC,r.d0N,r.ifA,de.w,Z.$],styles:["div.ed-cdt-taf-seance{margin-top:0}div.ed-cdt-taf-seance.view-edt{margin-top:20px}div.ed-cdt-taf-seance.view-edt .bloc-titre{display:block;float:right}div.ed-cdt-taf-seance .card-header .bloc-titre{position:relative;padding:1px 0 0;display:flex;justify-content:space-between;align-items:flex-end}div.ed-cdt-taf-seance .card-header .bloc-titre+hr,div.ed-cdt-taf-seance .card-header .bloc-titre hr{opacity:1}div.ed-cdt-taf-seance .card-header .bloc-titre.travail:before{background:var(--travail-color)}div.ed-cdt-taf-seance .card-header .bloc-titre.travail h3{color:var(--travail-color)}div.ed-cdt-taf-seance .card-header .bloc-titre.travail+hr,div.ed-cdt-taf-seance .card-header .bloc-titre.travail hr{margin-top:0;border:0;border-top:2px solid var(--travail-color)}div.ed-cdt-taf-seance .card-header .bloc-titre.travail+hr+.date,div.ed-cdt-taf-seance .card-header .bloc-titre.travail hr+.date{margin-top:-10px;font-style:italic;font-weight:700}div.ed-cdt-taf-seance .card-header .bloc-titre.contenu:before{background:var(--contenu-color)}div.ed-cdt-taf-seance .card-header .bloc-titre.contenu h3{color:var(--contenu-color)}div.ed-cdt-taf-seance .card-header .bloc-titre.contenu+hr,div.ed-cdt-taf-seance .card-header .bloc-titre.contenu hr{margin-top:0;border:0;border-top:2px solid var(--contenu-color)}div.ed-cdt-taf-seance .card-footer{padding:0}div.ed-cdt-taf-seance .card-footer .bloc-plus{position:relative;padding:20px 40px}div.ed-cdt-taf-seance .card-footer .bloc-plus h4{margin:13px 0 20px;font-size:15px}div.ed-cdt-taf-seance .card-footer .bloc-plus h4 a.btn{padding-left:0;padding-bottom:0;vertical-align:sub}div.ed-cdt-taf-seance .card-footer .bloc-plus h4 button{margin-bottom:-7px;margin-left:-1px}div.ed-cdt-taf-seance .card-footer .bloc-plus h4 button i{border:1px solid transparent}div.ed-cdt-taf-seance .card-footer .bloc-plus .commentaires a i{color:var(--light-primary-color)}div.ed-cdt-taf-seance .card-footer .bloc-plus .list-elem{margin:-5px 0 20px 30px}div.ed-cdt-taf-seance .card-footer .bloc-plus .list-elem li{display:list-item;margin:10px 0;line-height:1}div.ed-cdt-taf-seance.colonne-travail-a-faire .card-footer .bloc-plus h4,div.ed-cdt-taf-seance.colonne-travail-a-faire .card-footer .bloc-plus h4 a{color:var(--travail-color)}div.ed-cdt-taf-seance.colonne-contenu-de-seance .card-footer .bloc-plus h4,div.ed-cdt-taf-seance.colonne-contenu-de-seance .card-footer .bloc-plus h4 a{color:var(--contenu-color)}div.ed-cdt-taf-seance .bloc-content{min-height:200px}div.ed-cdt-taf-seance div[dropdown].open>.dropdown-toggle.btn-success{background-color:var(--light-primary-color);border-color:#137ed1}div.ed-cdt-taf-seance div[dropdown].open>.dropdown-toggle.btn-success:focus{background-color:var(--light-primary-color);border-color:#137ed1}div.ed-cdt-taf-seance div[dropdown] .btn-success:active{background-color:var(--light-primary-color);border-color:#137ed1}div.ed-cdt-taf-seance div[dropdown] .btn-success:focus{background-color:var(--light-primary-color);border-color:#137ed1}div.ed-cdt-taf-seance div[dropdown] .btn-success:hover{background-color:var(--light-primary-color);border-color:#137ed1}div.ed-cdt-taf-seance div[dropdown] .dropdown-menu button.btn{text-align:left}div.ed-cdt-taf-seance .bs-datepicker.theme-ed .bs-datepicker-container{padding:0}div.ed-cdt-taf-seance .bs-datepicker.theme-ed .bs-datepicker-container .bs-datepicker-head{background-color:var(--travail-color)}div.ed-cdt-taf-seance .bs-datepicker.theme-ed .bs-datepicker-container .bs-datepicker-head button{color:#fff}div.ed-cdt-taf-seance .contenu-non-maitrise{word-break:break-word}div.ed-cdt-taf-seance .contenu-non-maitrise a{color:#00f;text-decoration:underline}div.ed-cdt-taf-seance .contenu-non-maitrise img{max-width:100%}div.ed-cdt-taf-seance .contenu-non-maitrise ul{list-style:disc;padding:revert}div.ed-cdt-taf-seance .contenu-non-maitrise ol{padding:revert}@media (min-width: 1200px){div.ed-cdt-taf-seance{box-shadow:none;border:0 none}div.ed-cdt-taf-seance.colonne-travail-a-faire .card-footer{margin-right:-10px}div.ed-cdt-taf-seance.colonne-contenu-de-seance .card-footer{margin-left:-10px}}\n"],encapsulation:2,changeDetection:0}),i})();class F{constructor(s={matiereCode:"",matiereLibelle:"",entityCode:"",entityLibelle:"",entityType:"",entityId:0,selectedDate:void 0}){this.matiereCode=s.matiereCode,this.matiereLibelle=s.matiereLibelle,this.entityCode=s.entityCode,this.entityLibelle=s.entityLibelle,this.entityType=s.entityType,this.entityId=s.entityId,this.selectedDate=s.selectedDate}get selectedDateToString(){return(new r.ifA).transform(this.selectedDate,"y-MM-dd")}}var R=d(34813),cn=d(62843);function dn(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1,"Aucun devoir \xe0 venir"),e.qZA())}function ln(i,s){1&i&&(e.TgZ(0,"span",13),e._uU(1,"(Contr\xf4le)"),e.qZA())}function un(i,s){if(1&i&&(e.TgZ(0,"span",14),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("Donn\xe9 le ",e.xi3(2,1,t.donneLe,"EEEE d LLLL"),"")}}function pn(i,s){if(1&i&&(e.TgZ(0,"p")(1,"span",10),e._uU(2),e.YNc(3,ln,2,0,"span",11),e.qZA(),e.YNc(4,un,3,4,"span",12),e.qZA()),2&i){const t=s.$implicit,n=e.oxw(3);e.xp6(2),e.hij(" ",t.matiere?t.matiere:t.codeMatiere," "),e.xp6(1),e.Q6J("ngIf",t.interrogation),e.xp6(1),e.Q6J("ngIf",n.parametrage.compteRenduSeance)}}function _n(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",4),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.selectDay(a))}),e.TgZ(1,"div",5)(2,"h3",6),e._uU(3),e.ALo(4,"edDate"),e.qZA(),e.TgZ(5,"button",7),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.selectDay(a))}),e.ALo(6,"edDate"),e.qZA()(),e.TgZ(7,"div",8),e.YNc(8,pn,5,3,"p",9),e.ALo(9,"trackByProperty"),e.qZA()()}if(2&i){const t=s.$implicit,n=e.oxw(2);e.xp6(3),e.Oqu(e.xi3(4,4,t,"EEEE d MMMM")),e.xp6(2),e.uIk("aria-label","Consulter le cahier de textes du "+e.xi3(6,7,t,"EEEE d MMMM")),e.xp6(3),e.Q6J("ngForOf",n.cdtAVenir[t])("ngForTrackBy",e.lcZ(9,10,"$index"))}}function mn(i,s){if(1&i&&(e.TgZ(0,"div")(1,"h3",2),e._uU(2,"Tous les devoirs \xe0 venir"),e.qZA(),e.YNc(3,dn,2,0,"div",1),e.YNc(4,_n,10,12,"div",3),e.ALo(5,"keys"),e.ALo(6,"trackByProperty"),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.noDevoir),e.xp6(1),e.Q6J("ngForOf",e.lcZ(5,3,t.cdtAVenir))("ngForTrackBy",e.lcZ(6,5,"$index"))}}let fn=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h){super(),this.cahierDeTexteStore=t,this.authStore=n,this.loaderService=o,this.uiService=a,this.cahierDeTexteService=c,this.cdtUserService=p,this.cd=h,this.noDevoir=!0}ngOnChanges(t){(Object.isExists(t.idEntity)||Object.isExists(t.typeEntity))&&(Object.isExists(this._aVenirSubscription)&&this._aVenirSubscription.unsubscribe(),this._aVenirSubscription=this.cahierDeTexteStore.selectCahierDeTexteEleveAVenir(this.typeEntity,this.idEntity).pipe((0,u.b)(n=>{this.cdtAVenir=Object.isExists(n)?new r.sIb(n):void 0,this.noDevoir=!Object.isExists(n)||0===Object.keys(n).length,this.cd.markForCheck()}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.loadCdtEleve())}loadCdtEleve(){this.loader=this.loaderService.show(this),this.cahierDeTexteService.cahierDeTexte(this.idEntity,this.typeEntity).pipe((0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration du cahier de texte impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}selectDay(t){this.cdtUserService.selectDate(new Date(t))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.x1h),e.Y36(r.CnD),e.Y36(y.S),e.Y36(r.VLf),e.Y36(r.mYE),e.Y36(m),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-avenir"]],inputs:{idEntity:"idEntity",typeEntity:"typeEntity",parametrage:"parametrage"},features:[e.qOj,e.TTD],decls:2,vars:2,consts:[["id","tab-devoirs-a-venir",1,"tab-pane","active",3,"ngBusy"],[4,"ngIf"],[1,"all-devoirs"],["class","ed-card card with-epingle cliquable devoiravenir boite-devoirs",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"ed-card","card","with-epingle","cliquable","devoiravenir","boite-devoirs",3,"click"],[1,"card-header"],[1,"date"],["type","button",1,"screen-reader",3,"click"],[1,"card-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"subject"],["class","text-danger",4,"ngIf"],["class","float-end",4,"ngIf"],[1,"text-danger"],[1,"float-end"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,mn,7,7,"div",1),e.qZA()),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",n.cdtAVenir))},dependencies:[l.sg,l.O5,T.DC,r.ifA,r.VOG,Z.$],styles:[".ed-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--light-primary-color)}"],changeDetection:0}),i})();var Ee=d(7526),ye=d(4128),Cn=d(78231),le=d(11822);function hn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",17)(1,"button",18),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.onSelectMatiere(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t.libelle)}}function gn(i,s){if(1&i&&(e.TgZ(0,"ul",15),e.YNc(1,hn,3,1,"li",16),e.ALo(2,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.classeGroupeSelected.matieres)("ngForTrackBy",e.lcZ(2,2,"id"))}}function vn(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",10)(2,"ed-select-entity",11),e.NdJ("entityChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectClasseGroupe(o))}),e.qZA()(),e.TgZ(3,"div",12)(4,"button",13),e._uU(5),e.qZA(),e.YNc(6,gn,3,4,"ul",14),e.qZA(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("displayClasses",!0)("displayGroupes",!0)("displaySalles",!1)("entity",t.classeGroupeSelected)("displayAllClasses",!1),e.xp6(1),e.Q6J("isDisabled",!t.classeChoose),e.xp6(2),e.hij(" ",t.matiereSelected?t.matiereSelected.libelle:"Choisir une matiere"," ")}}function bn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",17)(1,"button",18),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.onSelectRessourceEleve(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t.libelle)}}function Tn(i,s){if(1&i&&(e.TgZ(0,"ul",23),e.YNc(1,bn,3,1,"li",16),e.ALo(2,"trackByProperty"),e.qZA()),2&i){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",e.lcZ(2,2,"id"))}}function xn(i,s){if(1&i&&(e.TgZ(0,"div",20)(1,"button",21),e._uU(2),e.qZA(),e.YNc(3,Tn,3,4,"ul",22),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.ressource?t.ressource.libelle:"Choisir une matiere"," ")}}function En(i,s){if(1&i&&(e.YNc(0,xn,4,1,"div",19),e.ALo(1,"async")),2&i){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.ressourcesEleve$))}}function yn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.openDuplication())}),e._uU(1," Dupliquer "),e.qZA()}}function Sn(i,s){1&i&&(e.TgZ(0,"div",39),e._uU(1,"L'ajout de document sera disponible apr\xe8s l'enregistrement."),e.qZA())}function Mn(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",30)(2,"div",31)(3,"ckeditor",32),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(2);return e.KtG(a.ressourceContenuDecode=o)}),e.qZA()()(),e.TgZ(4,"div",33)(5,"button",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.save())}),e._uU(6," Enregistrer "),e.qZA(),e.YNc(7,yn,2,0,"button",35),e.TgZ(8,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.close())}),e._uU(9,"Annuler"),e.qZA()(),e._UZ(10,"div",29),e.YNc(11,Sn,2,0,"div",37),e.BQk()}if(2&i){e.oxw();const t=e.MAs(1),n=e.oxw();e.xp6(3),e.Q6J("ngModel",n.ressourceContenuDecode)("required",!0)("config",n.ckeditorOptions),e.xp6(2),e.Q6J("disabled",!t.dirty),e.xp6(2),e.Q6J("ngIf",n.ressource.idCDT>0),e.xp6(4),e.Q6J("ngIf",!n.ressource.idCDT)}}function Dn(i,s){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"div",41),e.ALo(2,"filterHtml"),e._UZ(3,"hr",42),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("content",t.ressourceContenuDecode)("innerHTML",e.lcZ(2,2,t.ressourceContenuDecode),e.oJD)}}function Zn(i,s){if(1&i&&e.YNc(0,Dn,4,4,"div",40),2&i){const t=e.oxw(2);e.Q6J("ngIf",""!==t.ressourceContenuDecode)}}function An(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ed-bloc-commentaires",46),e.NdJ("commentaireAdded",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCommentaireAdded(o))})("commentaireDeleted",function(o){e.CHM(t);const a=e.oxw(3);return e.KtG(a.onCommentaireDeleted(o))}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("afficherCommentaires",!0)("isModerateur",!t.isCdtEleve)("typeSupport",t.side)("idSupport",t.ressource.idCDT)("afficherFormulaireCommentaires",!t.isCdtEleve)("tabCommentaires",t.ressource.commentaires)}}function wn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",43)(1,"ed-cdt-documents",44),e.NdJ("deleteDocument",function(o){e.CHM(t);const a=e.oxw(2);return e.KtG(a.deleteDocument(o))})("successUpload",function(o){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onUploadSuccess(o))}),e.qZA(),e.YNc(2,An,1,6,"ed-bloc-commentaires",45),e.qZA()}if(2&i){const t=e.oxw(2);e.MGl("id","cdt-",t.side,""),e.xp6(1),e.MGl("dropzoneContainer","#cdt-",t.side,""),e.Q6J("documents",t.isCdtEleve?t.ressource.fichiers:t.ressource.documents)("fromCloudEnabled",t.parametrage.cloud)("idContext",t.ressource.idCDT)("typeContext",t.side)("canAddDocuments",!t.isCdtEleve)("canDeleteDocuments",!t.isCdtEleve),e.xp6(1),e.Q6J("ngIf",t.parametrage.commentaires||t.isCdtEleve&&t.ressource.commentaires.length>0)}}function Un(i,s){if(1&i&&(e.TgZ(0,"form",24,25)(2,"fieldset",26),e.YNc(3,Mn,12,6,"ng-container",4),e.YNc(4,Zn,1,1,"ng-template",null,27,e.W1O),e.YNc(6,wn,3,9,"div",28),e._UZ(7,"div",29),e.qZA()()),2&i){const t=e.MAs(5),n=e.oxw();e.xp6(3),e.Q6J("ngIf",!n.isCdtEleve)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",n.ressource.idCDT)}}function On(i,s){1&i&&(e.TgZ(0,"div",47),e._uU(1,"Veuillez s\xe9lectionner une classe et une mati\xe8re"),e.qZA())}let Se=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h,k,x){super(),this.authStore=t,this.modalService=n,this.cahierDeTexteStore=o,this.loaderService=a,this.uiService=c,this.modalRef=p,this.cahierDeTexteService=h,this.cdtUserService=k,this.etablissementService=x,this.isCdtEleve=!0,this.side=r.ce3.RESSOURCE,this.classeChoose=!1,this.ckeditorOptions=w.x$,this.typeFichierTelechargement=r.Y9E,this._base64=new r.YC}ngOnInit(){if(this.isCdtEleve)this.ressourcesEleve$=this.cahierDeTexteStore.selectListeRessourcesEleve(this.typeEntity,this.idEntity);else{const t=this.cdtUserService.cdtProf.selectedSlot;let n=(0,U.of)(void 0);Object.isExists(t)&&(n=this.etablissementService.getClasseGroupeById(t.entityId,t.entityType).pipe((0,u.b)(o=>{this.classeGroupeSelected=o,this.matiereSelected=o.matieres.find(a=>a.code===t.matiereCode)}))),n.pipe((0,D.w)(o=>(Object.isExists(o)&&(this.classeGroupeSelected=o,this.matiereSelected=o.matieres.find(a=>a.code===t.matiereCode)),this.cahierDeTexteStore.select$())),(0,u.b)(o=>{if(!Object.isExists(this.classeGroupeSelected)||!Object.isExists(this.matiereSelected))return;const a=Object.getEntity(o,this.authStore.variantForCurrentUser);if(!Object.isExpired(a)&&Array.isArray(a.ressources)){const c=a.ressources.find(p=>p.entityCode===this.classeGroupeSelected.code&&p.matiereCode===this.matiereSelected.code);this.ressource=new r.E5w(c),this.ressourceContenuDecode=this._base64.transform(this.ressource.contenu,"decode")}}),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Erreur","fa fa-warning")),(0,v.R)(this.componentDestroyed$)).subscribe()}}onSelectClasseGroupe(t){let n;if(this.classeGroupeSelected=t,this.classeChoose=!0,Object.isExists(this.matiereSelected)&&(n=t.matieres.find(o=>o.code===this.matiereSelected.code),!Object.isExists(n)))return this.matiereSelected=void 0,void(this.ressource=void 0);Object.isExists(this.matiereSelected)&&Object.isExists(n)&&n.code===this.matiereSelected.code?this.onSelectMatiere(this.matiereSelected):1===t.matieres.length&&this.matiereSelected!==t.matieres[0]&&this.onSelectMatiere(t.matieres[0])}close(){this.modalRef.hide()}onSelectMatiere(t){this.isCdtEleve||(this.matiereSelected=t,this.loader=this.loaderService.show(this),this.cahierDeTexteService.getResources(this.classeGroupeSelected.code,t.code).pipe((0,j.d)((()=>Object.getEntity(this.cahierDeTexteStore.snapshot,this.authStore.variantForCurrentUser))()),(0,u.b)(n=>{!Object.isExpired(n)&&Array.isArray(n.ressources)&&(this.ressource=n.ressources.find(o=>o.entityCode===this.classeGroupeSelected.code&&o.matiereCode===this.matiereSelected.code),this.ressourceContenuDecode=this._base64.transform(this.ressource.contenu,"decode"))}),(0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Erreur","fa fa-warning"))).subscribe())}onSelectRessourceEleve(t){this.ressource=new r.td2(t),this.ressourceContenuDecode=this._base64.transform(this.ressource.contenu,"decode")}save(){if(this.isCdtEleve)return;let t;t=new r.E5w(this.ressource),t.contenu=(0,Cn.cv)(this.ressourceContenuDecode),this.loader=this.loaderService.show(this),this.cahierDeTexteService.saveContenu(t,this.classeGroupeSelected.code,this.matiereSelected.code).pipe((0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Erreur","fa fa-warning"))).subscribe()}deleteDocument(t){if(this.isCdtEleve)return;const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Supprimer le fichier",message:`Confirmez-vous la suppression du fichier <strong>${t.libelle}</strong> ?`}};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,u.b)(o=>{o===E.G.validation&&this.cahierDeTexteService.deleteFile(t,this.ressource,this.side).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Le fichier a bien \xe9t\xe9 supprim\xe9 !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(a=>this.uiService.notifyErrorThenEmpty(a,!0,"Erreur","fa fa-warning"))).subscribe()})).subscribe()}onUploadSuccess(t){this.isCdtEleve||this.cahierDeTexteStore.addFile(t,this.ressource,this.side)}onCommentaireAdded(t){if(this.isCdtEleve)return;let n;n=0===t.id?this.cahierDeTexteService.addComment(this.ressource,this.side,t):this.cahierDeTexteService.updateComment(this.ressource,this.side,t),this.loader=this.loaderService.show(this),n.pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,`Votre commentaire a bien \xe9t\xe9 ${0===t.id?"enregistr\xe9":"modifi\xe9"} !`,"Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Cahier de texte","fa fa-warning"))).subscribe()}onCommentaireDeleted(t){this.isCdtEleve||(this.loader=this.loaderService.show(this),this.cahierDeTexteService.deleteComment(this.ressource,this.side,t).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre commentaire a bien \xe9t\xe9 supprim\xe9 !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Cahier de texte","fa fa-warning"))).subscribe())}openDuplication(){const t={id:this.modalService.getModalsCount()+1,initialState:{entity:this.classeGroupeSelected,matiere:this.matiereSelected,side:r.ce3.RESSOURCE,ressource:this.ressource},class:"modal-lg",providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(_e,t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(g.tT),e.Y36(r.x1h),e.Y36(y.S),e.Y36(r.VLf),e.Y36(g.UZ),e.Y36(r.mYE),e.Y36(m),e.Y36(r.Xmb))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-ressources-modal"]],inputs:{parametrage:"parametrage",isCdtEleve:"isCdtEleve",idEntity:"idEntity",typeEntity:"typeEntity",idClasse:"idClasse"},features:[e.qOj],decls:13,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],[4,"ngIf","ngIfElse"],["selectRessourceEleve",""],["name","ressourceForm","class","margin-top-10",4,"ngIf"],["class","jumbotron",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-primary","float-end",3,"click"],[1,"btn-group"],["placeholder","Chosir une classe",3,"displayClasses","displayGroupes","displaySalles","entity","displayAllClasses","entityChange"],["dropdown","",1,"btn-group","margin-whitespace",3,"isDisabled"],["id","dropdownMenuMatiere","type","button","dropdownToggle","","aria-controls","dropdown-matiere",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownMenuMatiere","class","dropdown-menu","id","dropdown-matiere","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuMatiere","id","dropdown-matiere","role","menu",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf","ngForTrackBy"],["role","menuitem"],["type","button",1,"dropdown-item",3,"click"],["class","btn-group margin-whitespace","dropdown","",4,"ngIf"],["dropdown","",1,"btn-group","margin-whitespace"],["type","button","dropdownToggle","","aria-controls","dropdown-matiereRE","id","dropdownMenuRE",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownMenuRE","class","dropdown-menu","id","dropdown-matiereRE","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuRE","id","dropdown-matiereRE","role","menu",1,"dropdown-menu"],["name","ressourceForm",1,"margin-top-10"],["ressourceForm","ngForm"],["id","container-ressources",1,"dropzone-container"],["contenuRessourceEleve",""],["class","ajout-ressources dropzone-container",3,"id",4,"ngIf"],[1,"clearfix"],[1,"row"],[1,"controls"],["name","description",3,"ngModel","required","config","ngModelChange"],[1,"margin-top-10"],["id","buttonModif","name","buttonModif","type","button",1,"btn","btn-success","float-end","margin-whitespace",3,"disabled","click"],["id","buttonDuplication","name","buttonDuplication","class","btn btn-success float-end","type","button",3,"click",4,"ngIf"],["id","buttonSaveAFaire","name","buttonSaveAFaire","type","button",1,"btn","btn-danger","float-start",3,"click"],["class","form-text",4,"ngIf"],["id","buttonDuplication","name","buttonDuplication","type","button",1,"btn","btn-success","float-end",3,"click"],[1,"form-text"],[4,"ngIf"],["edMathjax","",1,"ed-cke",3,"content","innerHTML"],["role","separator"],[1,"ajout-ressources","dropzone-container",3,"id"],[3,"documents","fromCloudEnabled","idContext","typeContext","canAddDocuments","canDeleteDocuments","dropzoneContainer","deleteDocument","successUpload"],[3,"afficherCommentaires","isModerateur","typeSupport","idSupport","afficherFormulaireCommentaires","tabCommentaires","commentaireAdded","commentaireDeleted",4,"ngIf"],[3,"afficherCommentaires","isModerateur","typeSupport","idSupport","afficherFormulaireCommentaires","tabCommentaires","commentaireAdded","commentaireDeleted"],[1,"jumbotron"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Consultation des ressources"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,vn,7,7,"ng-container",4),e.YNc(6,En,2,3,"ng-template",null,5,e.W1O),e.YNc(8,Un,8,3,"form",6),e.YNc(9,On,2,0,"div",7),e.qZA(),e.TgZ(10,"div",8)(11,"button",9),e.NdJ("click",function(){return n.close()}),e._uU(12,"Fermer"),e.qZA()()),2&t){const o=e.MAs(7);e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",!n.isCdtEleve)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",n.ressource),e.xp6(1),e.Q6J("ngIf",!n.classeGroupeSelected&&!n.isCdtEleve)}},dependencies:[l.sg,l.O5,_._Y,_.JJ,_.JL,_.Q7,_.On,_.F,M.Hz,M.Mq,M.TO,he.u,T.DC,ce.L,K.M,le.h,z.C,l.Ov,de.w,Z.$],encapsulation:2}),i})();var ue=d(38819);function kn(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"ed-select-entity",6),e.NdJ("entityChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.selectEntity(o))}),e.qZA(),e._UZ(2,"br"),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("displayClassesOfGroupe",t.idEntity)("displayClasses",!1)("displayGroupes",!1)}}function Pn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"bs-datepicker-inline",7),e.NdJ("bsValueChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.selectDay(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("bsValue",t.dateSelected)("bsConfig",t.configDatePicker)}}function In(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRessource("Manuels"))}),e.TgZ(1,"div",9),e._UZ(2,"i",10),e._uU(3," Manuels scolaires "),e.qZA()()}}function Jn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRessource("Multimedia"))}),e.TgZ(1,"div",9),e._UZ(2,"i",11),e._uU(3," Canaux multim\xe9dia "),e.qZA()()}}function Fn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showRessource("Ressources"))}),e.TgZ(1,"div",9),e._UZ(2,"i",12),e._uU(3," Ressources "),e.qZA()()}}function Nn(i,s){1&i&&e._UZ(0,"ed-connecteur-robert-dico-en-ligne")}let qn=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h,k,x,ua){super(),this.cdtUserService=t,this.modalService=n,this.manuelsNumeriquesStore=o,this.manuelsNumeriquesService=a,this.cahierDeTexteStore=c,this.cahierDeTexteService=p,this.loaderService=h,this.uiService=k,this.cd=x,this.authStore=ua,this.selectClasseOfGroupe=new e.vpe,this.edTypeClasseGroupeEntity=r.JBS,this.isCdtClasseOfGroupe=!1,this.configDatePicker={...w.gL,showWeekNumbers:!1,daysDisabled:[0],adaptivePosition:!1},this._displayDatePicker$=new J.X(!1),this.displayDatePicker$=this._displayDatePicker$.asObservable()}get isCdtGroupeFlexible(){return Object.isExists(this.entity)&&this.entity instanceof r.oQM}ngOnChanges(t){if(Object.isExists(t.dateSelected)&&setTimeout(()=>{this._displayDatePicker$.next(!1)},0),Object.isExists(t.idEntity)||Object.isExists(t.typeEntity)){Object.isExists(this._subManuels)&&this._subManuels.unsubscribe(),this._subManuels=this.manuelsNumeriquesStore.selectListeManuelsNumeriques(r.$ej.edDBUserSpecificKey(this.authStore.currentUser.codeOgec,this.typeEntity,this.idEntity,["","D",0,"ALL",0])).pipe((0,u.b)(p=>{Array.isArray(p)?(this.tabManuels=p.filter(h=>!h.isCanalMultimedia),this.tabManuelsMultimedia=p.filter(h=>h.isCanalMultimedia)):(this.tabManuels=void 0,this.tabManuelsMultimedia=void 0),this.cd.markForCheck()}),(0,v.R)(this.componentDestroyed$)).subscribe(),Object.isExists(this._subRessources)&&this._subRessources.unsubscribe(),this._subRessources=this.cahierDeTexteStore.selectListeRessourcesEleve(this.typeEntity,this.idEntity).pipe((0,u.b)(p=>{this.ressources=Array.isArray(p)?[...p]:void 0,this.cd.markForCheck()}),(0,v.R)(this.componentDestroyed$)).subscribe();const n=[];let o,a;this.typeEntity!==r.meW.CLASSE&&this.typeEntity!==r.meW.GROUPE?(o=r.meW.ELEVE,a=this.idEntity):(o=r.meW.ENSEIGNANT,a=this.authStore.currentUser.id),n.push(this.manuelsNumeriquesService.manuelsNumeriques(a,o));let c=0;this.typeEntity===r.meW.ELEVE&&(this.entity instanceof r.Dfc?c=this.entity.classe.id:this.entity instanceof r.XPO&&(c=this.entity.profile.classe.id)),c>0&&n.push(this.cahierDeTexteService.getRessourcesEleve(this.idEntity,this.typeEntity,c)),this.loader=this.loaderService.show(this),(0,ye.D)(n).pipe((0,f.K)(p=>this.uiService.notifyErrorThenEmpty(p,!0,"Cahier de texte","fa fa-warning")),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}Object.isExists(t.dateSelected)&&setTimeout(()=>{this._displayDatePicker$.next(!0)},0)}selectDay(t){this.dateSelected&&r.C_1.isSameDay(t,this.dateSelected)||(this._displayDatePicker$.next(!1),this.cdtUserService.selectDate(t))}selectEntity(t){this.selectClasseOfGroupe.emit(t),this.isCdtClasseOfGroupe=t instanceof r.Mn7&&t.typeEntity===r.meW.CLASSE}showRessource(t){if("Manuels"===t||"Multimedia"===t){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Manuels"===t?"Manuels scolaires":"Canaux multim\xe9dias",injectComponentInputs:{idEntity:this.idEntity,typeEntity:this.typeEntity,canauxMultimedia:"Multimedia"===t,customClass:"align-center"},close:"Fermer",injectComponentClass:Ee.c},class:"modal-xlg"};this.modalService.show(R.z,n)}else if("Ressources"===t){const n={id:this.modalService.getModalsCount()+1,initialState:{parametrage:this.parametrage,idEntity:this.idEntity,typeEntity:this.typeEntity,entity:this.entity},providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(Se,n)}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(g.tT),e.Y36(r.Fh3),e.Y36(r.rP1),e.Y36(r.x1h),e.Y36(r.mYE),e.Y36(y.S),e.Y36(r.VLf),e.Y36(e.sBO),e.Y36(r.CnD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-navigation"]],inputs:{idEntity:"idEntity",typeEntity:"typeEntity",entity:"entity",dateSelected:"dateSelected",parametrage:"parametrage"},outputs:{selectClasseOfGroupe:"selectClasseOfGroupe"},features:[e.qOj,e.TTD],decls:10,vars:9,consts:[[3,"ngBusy"],[4,"ngIf"],["id","cdtnavigation-calendar"],[3,"bsValue","bsConfig","bsValueChange",4,"ngIf"],["id","cdtnavigation-action",1,"list-group"],["class","list-group-item list-group-item-action no-style-hover","type","button",3,"click",4,"ngIf"],[3,"displayClassesOfGroupe","displayClasses","displayGroupes","entityChange"],[3,"bsValue","bsConfig","bsValueChange"],["type","button",1,"list-group-item","list-group-item-action","no-style-hover",3,"click"],[1,"row-action-primary"],["aria-hidden","true",1,"fa","fa-book"],["aria-hidden","true",1,"fa","fa-play-circle-o"],["aria-hidden","true",1,"fa","fa-database"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,kn,3,3,"ng-container",1),e.TgZ(2,"div",2),e.YNc(3,Pn,1,2,"bs-datepicker-inline",3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,In,4,0,"button",5),e.YNc(7,Jn,4,0,"button",5),e.YNc(8,Fn,4,0,"button",5),e.YNc(9,Nn,1,0,"ed-connecteur-robert-dico-en-ligne",1),e.qZA()()),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",!n.isCdtGroupeFlexible&&(n.typeEntity===n.edTypeClasseGroupeEntity.GROUPE||n.isCdtClasseOfGroupe)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,7,n.displayDatePicker$)),e.xp6(3),e.Q6J("ngIf",(null==n.tabManuels?null:n.tabManuels.length)>0),e.xp6(1),e.Q6J("ngIf",(null==n.tabManuelsMultimedia?null:n.tabManuelsMultimedia.length)>0),e.xp6(1),e.Q6J("ngIf",(null==n.ressources?null:n.ressources.length)>0),e.xp6(1),e.Q6J("ngIf",n.authStore.currentUser.dicoEnLigneLeRobert))},dependencies:[l.O5,L.nf,T.DC,ue.C,le.h,l.Ov],styles:['@charset "UTF-8";#cdtnavigation-action{margin:40px 0}#cdtnavigation-action .list-group-item{cursor:pointer;padding:10px;background:none;border:none;border-bottom:1px solid #000;border-radius:0;text-align:left}#cdtnavigation-action .list-group-item:first-child{border-top:1px solid #000}#cdtnavigation-action .list-group-item:hover{background:#fff}#cdtnavigation-calendar{text-align:center;height:319px}#cdtnavigation-calendar .bs-datepicker-head,#cdtnavigation-calendar .bs-datepicker-body{padding:10px 0}#cdtnavigation-calendar .picker-day.today,#cdtnavigation-calendar .picker-day.today:hover,#cdtnavigation-calendar .picker-day.today.picker-selected,#cdtnavigation-calendar .picker-day.today.picker-off,#cdtnavigation-calendar .picker-day.today.picker-off:hover{color:#62c6ff}\n'],encapsulation:2,changeDetection:0}),i})();function Ln(i,s){if(1&i&&(e.TgZ(0,"span",13),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Oqu(n.badges[e.xi3(2,1,t,"yyyy-MM-dd")].valeur)}}const Yn=function(i,s){return{active:i,today:s}};function Rn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",10)(1,"button",11),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.selectDay(a))}),e.YNc(2,Ln,3,4,"span",12),e.ALo(3,"edDate"),e._uU(4),e.ALo(5,"edDate"),e.qZA()()}if(2&i){const t=s.$implicit,n=e.oxw();e.Q6J("ngClass",e.WLB(9,Yn,n.isSameDay(t,n.dateSelected),n.isNow(t))),e.xp6(2),e.Q6J("ngIf",(null==n.badges[e.xi3(3,3,t,"yyyy-MM-dd")]?null:n.badges[e.xi3(3,3,t,"yyyy-MM-dd")].valeur)>0),e.xp6(2),e.hij(" ",e.xi3(5,6,t,"EEEE d")," ")}}const Me=function(i){return{active:i}};function Qn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",14)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.selectTypeView(o.CONST_TYPE_VUE_CDT_ELEVE.AVENIR))}),e._uU(2," \xc0 "),e._UZ(3,"br"),e._uU(4," venir "),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,Me,t.typeVueCDT===t.CONST_TYPE_VUE_CDT_ELEVE.AVENIR))}}function Vn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",16)(1,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.selectTypeView(o.CONST_TYPE_VUE_CDT_ELEVE.SEMAINE))}),e._uU(2," Devoirs de "),e._UZ(3,"br"),e._uU(4," la semaine "),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,Me,t.typeVueCDT===t.CONST_TYPE_VUE_CDT_ELEVE.SEMAINE))}}const Gn=function(i){return{"cdt-primaire":i}};let Bn=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o){super(),this.cdtUserService=t,this.cahierDeTexteStore=n,this.cd=o,this.isCDTPrimaire=!1,this.CONST_TYPE_VUE_CDT_ELEVE=r.Rcf,this.joursSemaine=[]}ngOnChanges(t){(Object.isExists(t.typeEntity)||Object.isExists(t.idEntity))&&(Object.isExists(this._badgesSubscription)&&this._badgesSubscription.unsubscribe(),this._badgesSubscription=this.cahierDeTexteStore.selectBadgesCahierDeTexteEleve(this.typeEntity,this.idEntity).pipe((0,u.b)(n=>{this.badges=Object.isExists(n)?new r.dv9(n):void 0,this.cd.markForCheck()}),(0,v.R)(this.componentDestroyed$)).subscribe()),Object.isExists(t.periodeCDT)&&t.periodeCDT.previousValue!==t.periodeCDT.currentValue&&(this.joursSemaine=r.C_1.getDaysOfWeek(this.periodeCDT.periode.dateDebut),this.joursSemaine.pop(),this.typeVueCDT===r.Rcf.JOUR&&Object.isExists(this.dateSelected)&&!r.C_1.isBetween(this.dateSelected,this.periodeCDT.periode.dateDebut,this.periodeCDT.periode.dateFin)&&this.selectDay(this.periodeCDT.periode.dateDebut))}isSameDay(t,n){return Object.isExists(t)&&Object.isExists(n)&&t.getDay()===n.getDay()}isNow(t){return r.C_1.isToday(t)}changeWeek(t="+"){let n=this.cdtUserService.cdtEleve.selectedDate||new Date;"+"===t?n=r.C_1.addNbJourToDate(n,7):"-"===t&&(n=r.C_1.addNbJourToDate(n,-7)),this.selectDay(n)}selectDay(t){this.cdtUserService.selectDate(t)}selectTypeView(t){this.cdtUserService.selectTypeVueCDTEleve(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(r.x1h),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-onglets"]],inputs:{dateSelected:"dateSelected",periodeCDT:"periodeCDT",typeVueCDT:"typeVueCDT",idEntity:"idEntity",typeEntity:"typeEntity",isCDTPrimaire:"isCDTPrimaire"},features:[e.qOj,e.TTD],decls:11,vars:9,consts:[[1,"cdt-eleve-onglets","nav","nav-tabs","flex-column","align-items-center",3,"ngClass"],[1,"fleche","nav-item","previous"],["title","Semaine pr\xe9c\xe9dente","type","button",1,"btn","border","border-0","nav-link",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-circle-up","btn-primary-color"],["class","onglet-jour nav-item",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"fleche","nav-item","next"],["title","Semaine suivante","type","button",1,"btn","border","border-0","nav-link",3,"click"],["aria-hidden","true",1,"fa","fa-arrow-circle-down","btn-primary-color"],["class","secondary onglet-secondary nav-item",3,"ngClass",4,"ngIf"],["class","onglet-secondary nav-item",3,"ngClass",4,"ngIf"],[1,"onglet-jour","nav-item",3,"ngClass"],["data-bs-toggle","tab","type","button",1,"btn","btn-primary","border","border-0","nav-link",3,"click"],["class","badge alert-danger",4,"ngIf"],[1,"badge","alert-danger"],[1,"secondary","onglet-secondary","nav-item",3,"ngClass"],["data-bs-toggle","tab","type","button",1,"btn","btn-primary-color","border","border-0","nav-link",3,"click"],[1,"onglet-secondary","nav-item",3,"ngClass"]],template:function(t,n){1&t&&(e.TgZ(0,"ul",0)(1,"li",1)(2,"button",2),e.NdJ("click",function(){return n.changeWeek("-")}),e._UZ(3,"i",3),e.qZA()(),e.YNc(4,Rn,6,12,"li",4),e.ALo(5,"trackByProperty"),e.TgZ(6,"li",5)(7,"button",6),e.NdJ("click",function(){return n.changeWeek("+")}),e._UZ(8,"i",7),e.qZA()(),e.YNc(9,Qn,5,3,"li",8),e.YNc(10,Vn,5,3,"li",9),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(7,Gn,n.isCDTPrimaire)),e.xp6(4),e.Q6J("ngForOf",n.joursSemaine)("ngForTrackBy",e.lcZ(5,5,"$index")),e.xp6(5),e.Q6J("ngIf",!n.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",!n.isCDTPrimaire))},dependencies:[l.mk,l.sg,l.O5,r.ifA,Z.$],styles:["ul.cdt-eleve-onglets[_ngcontent-%COMP%]{margin-left:-10px}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.fleche[_ngcontent-%COMP%]{border:none}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.fleche.previous[_ngcontent-%COMP%]{margin-bottom:35px}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.fleche.next[_ngcontent-%COMP%]{margin-top:-40px;margin-bottom:30px}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.fleche[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.onglet-jour[_ngcontent-%COMP%]{transform:rotate(90deg);writing-mode:lr-tb;margin-bottom:75px;width:108px;padding-bottom:2px}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.onglet-secondary[_ngcontent-%COMP%]{transform:rotate(90deg);writing-mode:lr-tb;margin-bottom:62px;width:108px;padding-bottom:2px}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{border-bottom:2px solid var(--light-primary-color)}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:700;color:var(--light-primary-color)}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]:after{content:none}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{white-space:nowrap;background-color:var(--footer-primary-color);font-size:13px;text-align:center;padding:10px 15px;position:relative;transition:none;width:100%;line-height:1}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-letter, ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:first-letter{text-transform:uppercase}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none}ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span.badge[_ngcontent-%COMP%], ul.cdt-eleve-onglets[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span.badge[_ngcontent-%COMP%]{position:fixed;top:-10px;left:45px;transform:rotate(270deg)}@media (max-width: 991px){ul.cdt-eleve-onglets[_ngcontent-%COMP%]{margin-left:-30px}}"],changeDetection:0}),i})();function jn(i,s){if(1&i&&(e._UZ(0,"ed-cdt-taf-rendus-eleve",7),e.ALo(1,"edDate")),2&i){const t=e.oxw();e.Q6J("idCDT",t.cdtMatiere.id)("eleveDCC",t.eleveDCC)("dateDevoir",e.xi3(1,4,t.dateDevoir,"yyyy-MM-dd"))("cdtMatiere",t.cdtMatiere)}}let $n=(()=>{class i{constructor(t,n,o,a){this.loaderService=t,this.cahierDeTexteService=n,this.uiService=o,this.modalRef=a}ngOnInit(){this.loader=this.loaderService.show(this),this.cahierDeTexteService.getEleveCopiesCorrectifs(this.cdtMatiere.id,this.idEleve).pipe((0,u.b)(t=>{this.eleveDCC=t}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration des rendus impossible","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>{this.loaderService.hide(this)})).subscribe()}close(){this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.S),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-taf-rendus-modal"]],inputs:{idEleve:"idEleve",cdtMatiere:"cdtMatiere",dateDevoir:"dateDevoir"},decls:11,vars:7,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],[3,"idCDT","eleveDCC","dateDevoir","cdtMatiere",4,"ngIf"],[1,"modal-footer"],[3,"idCDT","eleveDCC","dateDevoir","cdtMatiere"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div")(2,"h3",1),e._uU(3,"G\xe9rer mes documents rendus"),e.qZA(),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"edDate"),e.qZA()(),e.TgZ(7,"button",3),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(8,"div",4),e.YNc(9,jn,2,7,"ed-cdt-taf-rendus-eleve",5),e.qZA(),e._UZ(10,"div",6)),2&t&&(e.xp6(5),e.AsE(" ",n.cdtMatiere.matiere?n.cdtMatiere.matiere:n.cdtMatiere.codeMatiere," - ",e.xi3(6,4,n.dateDevoir,"EEEE d MMMM")," "),e.xp6(3),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",n.eleveDCC))},dependencies:[l.O5,T.DC,se,r.ifA]}),i})();const Hn=function(i){return[i]};function Kn(i,s){if(1&i&&(e.TgZ(0,"div",1)(1,"h4",2),e._UZ(2,"i",3),e._uU(3," Commentaire concernant le devoir rendu "),e.qZA(),e._UZ(4,"ed-bloc-commentaires",4),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.Q6J("tabCommentaires",e.VKq(3,Hn,t.commentaire))("afficherFormulaireCommentaires",!1)("afficherCommentaires",!1)}}let zn=(()=>{class i{constructor(){}ngOnInit(){this.commentaire=new r.j2C({auteur:this.cdtMatiere.nomProf,profilAuteur:r.dcH.ENSEIGNANT,message:this.cdtMatiere.aFaire.correctifs.commentaire})}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-commentaires-devoir-rendu"]],inputs:{cdtMatiere:"cdtMatiere"},decls:1,vars:1,consts:[["class","taf-correctifs",4,"ngIf"],[1,"taf-correctifs"],[1,"d-print-none"],["aria-hidden","true",1,"fa","fa-comments"],[3,"tabCommentaires","afficherFormulaireCommentaires","afficherCommentaires"]],template:function(t,n){1&t&&e.YNc(0,Kn,5,5,"div",0),2&t&&e.Q6J("ngIf",n.cdtMatiere.aFaire.correctifs&&n.cdtMatiere.aFaire.correctifs.commentaire)},dependencies:[l.O5,K.M],styles:[".taf-correctifs[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:var(--light-primary-color);text-transform:uppercase}"],changeDetection:0}),i})();function Wn(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"ed-cdt-taf-correctifs-prof",7),e.ALo(2,"edDate"),e._UZ(3,"ed-cdt-eleve-commentaires-devoir-rendu",8),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("idCDT",t.cdtMatiere.id)("eleveDCC",t.eleveDCC)("dateDevoir",e.xi3(2,4,t.dateDevoir,"yyyy-MM-dd")),e.xp6(2),e.Q6J("cdtMatiere",t.cdtMatiere)}}let Xn=(()=>{class i{constructor(t,n,o,a){this.loaderService=t,this.cahierDeTexteService=n,this.uiService=o,this.modalRef=a}ngOnInit(){this.loader=this.loaderService.show(this),this.cahierDeTexteService.getEleveCopiesCorrectifs(this.cdtMatiere.id,this.idEleve).pipe((0,u.b)(t=>{this.eleveDCC=t}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration des correctifs impossible","Erreur","fa fa-warning"),b.E)),(0,C.x)(()=>{this.loaderService.hide(this)})).subscribe()}close(){this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.S),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-taf-correctifs-modal"]],inputs:{idEleve:"idEleve",cdtMatiere:"cdtMatiere",dateDevoir:"dateDevoir"},decls:11,vars:7,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],[4,"ngIf"],[1,"modal-footer"],[3,"idCDT","eleveDCC","dateDevoir"],[3,"cdtMatiere"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div")(2,"h3",1),e._uU(3,"Liste des correctifs"),e.qZA(),e.TgZ(4,"span",2),e._uU(5),e.ALo(6,"edDate"),e.qZA()(),e.TgZ(7,"button",3),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(8,"div",4),e.YNc(9,Wn,4,7,"ng-container",5),e.qZA(),e._UZ(10,"div",6)),2&t&&(e.xp6(5),e.AsE(" ",n.cdtMatiere.matiere?n.cdtMatiere.matiere:n.cdtMatiere.codeMatiere," - ",e.xi3(6,4,n.dateDevoir,"EEEE d MMMM")," "),e.xp6(3),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",n.eleveDCC))},dependencies:[l.O5,T.DC,zn,ae,r.ifA]}),i})();function eo(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("- Termin\xe9 le ",e.xi3(2,1,t.aFaire.qcm.fini,"EEEE d MMMM y \xe0 HH:mm"),"")}}function to(i,s){if(1&i&&(e.TgZ(0,"small"),e._uU(1),e.ALo(2,"edDate"),e.YNc(3,eo,3,4,"span",1),e._uU(4," )\n"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" (D\xe9marr\xe9 le ",e.xi3(2,2,t.aFaire.qcm.debute,"EEEE d MMMM y \xe0 HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.aFaire.qcm.fini)}}let io=(()=>{class i{constructor(t,n){this.authStore=t,this.router=n}openQCM(){let t={idQCM:this.aFaire.qcm.idQCM,titre:this.aFaire.qcm.titre,idAssociation:this.aFaire.qcm.idAssociation};this.authStore.isFamille()&&(t.idEleve=this.idEntity),this.router.navigate(["",{outlets:{auxiliaryModal:["repondre-au-qcm"]}}],{skipLocationChange:!0,queryParams:t}).catch(()=>console.error("CdtEleveQcmComponent open qcm"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(q.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-qcm"]],inputs:{aFaire:"aFaire",idEntity:"idEntity"},decls:9,vars:2,consts:[["aria-hidden","true",1,"icon-ed_qcm"],[4,"ngIf"],["title","Afficher le questionnaire","type","button",1,"btn","btn-success","d-print-none","float-end",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h4"),e._UZ(1,"i",0),e._uU(2," Questionnaire\n"),e.qZA(),e._uU(3),e._UZ(4,"br"),e.YNc(5,to,5,5,"small",1),e.TgZ(6,"button",2),e.NdJ("click",function(){return n.openQCM()}),e._UZ(7,"i",0),e._uU(8," Afficher le questionnaire\n"),e.qZA()),2&t&&(e.xp6(3),e.hij("\n",n.aFaire.qcm.titre,"\n"),e.xp6(2),e.Q6J("ngIf",n.aFaire.qcm.debute))},dependencies:[l.O5,r.ifA],encapsulation:2,changeDetection:0}),i})();var no=d(935);function oo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.showRessource())}),e._UZ(1,"i",14),e.qZA()}}function ro(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.showContenuSeance())}),e.ALo(1,"edDate"),e._uU(2," Contenu de la s\xe9ance "),e.qZA()}if(2&i){const t=e.oxw(3);e.MGl("title","Contenu de la s\xe9ance du ",e.xi3(1,1,t.sideContent.donneLe,"d LLLL"),"")}}function so(i,s){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.cdtMatiere.matiere||t.cdtMatiere.codeMatiere===t.edTypeEntity.CLASSE?t.cdtMatiere.matiere:t.cdtMatiere.codeMatiere," ")}}function ao(i,s){1&i&&(e.TgZ(0,"span",16),e._uU(1,"(Contr\xf4le)"),e.qZA())}function co(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p",17)(1,"input",18),e.NdJ("ngModelChange",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.setEffectue())}),e.qZA(),e.TgZ(2,"label",19),e._uU(3,"Effectu\xe9"),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.sideContent.effectue)}}function lo(i,s){if(1&i&&(e.TgZ(0,"div",5),e.YNc(1,oo,2,0,"button",6),e.YNc(2,ro,3,4,"button",7),e.YNc(3,so,2,1,"h3",8),e.TgZ(4,"div",9),e.YNc(5,ao,2,0,"span",10),e.YNc(6,co,4,1,"p",11),e.qZA(),e._UZ(7,"div",12),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.cdtMatiere.aFaire&&(t.cdtMatiere.aFaire.ressource||t.cdtMatiere.aFaire.ressourceDocuments&&t.cdtMatiere.aFaire.ressourceDocuments.length>0)),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE&&t.parametrage.compteRenduSeance&&t.sideContent.contenuDeSeance.contenu.length>0),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE||t.side===t.sideCDT.SEANCE&&!t.isContenuDeSeanceTAF&&t.cdtUserService.isDatePast(t.date)),e.xp6(2),e.Q6J("ngIf",t.cdtMatiere.interrogation&&!t.isContenuDeSeanceTAF),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE&&!t.authStore.isProfOuPersonnel())}}function uo(i,s){if(1&i&&(e.TgZ(0,"em",24),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(t.cdtMatiere.entityLibelle)}}function po(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"p",22),e.ALo(2,"filterHtml"),e.ALo(3,"base64"),e._uU(4," contenu "),e.qZA(),e.YNc(5,uo,2,1,"em",23),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("content",t.sideContent.contenu)("innerHTML",e.lcZ(2,3,e.lcZ(3,5,t.sideContent.contenu)),e.oJD),e.xp6(4),e.Q6J("ngIf",t.cdtMatiere.entityType===t.edTypeEntity.GROUPE&&t.typeEntity===t.edTypeEntity.CLASSE)}}function _o(i,s){if(1&i&&(e.TgZ(0,"em",24),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(t.cdtMatiere.entityLibelle)}}function mo(i,s){if(1&i&&(e.TgZ(0,"em",31),e._uU(1),e.ALo(2,"edDate"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.AsE("Donn\xe9 le ",e.xi3(2,2,t.sideContent.donneLe,"d LLLL")," par ",t.cdtMatiere.nomProf,"")}}function fo(i,s){if(1&i&&(e.TgZ(0,"div",25)(1,"div",26)(2,"p",27),e.ALo(3,"filterHtml"),e.ALo(4,"detectUrl"),e.ALo(5,"base64"),e._uU(6," contenu "),e.qZA(),e.YNc(7,_o,2,1,"em",23),e.YNc(8,mo,3,5,"em",28),e._UZ(9,"div",12),e.qZA(),e.TgZ(10,"div",29),e._UZ(11,"ed-manuels-scolaires-eleve",30),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(2),e.Q6J("content",t.sideContent.contenu)("innerHTML",e.lcZ(3,7,e.lcZ(4,9,e.lcZ(5,11,t.sideContent.contenu))),e.oJD),e.xp6(5),e.Q6J("ngIf",t.cdtMatiere.entityType===t.edTypeEntity.GROUPE&&t.typeEntity===t.edTypeEntity.CLASSE),e.xp6(1),e.Q6J("ngIf",t.parametrage.compteRenduSeance),e.xp6(3),e.Q6J("idEntity",t.idEntity)("typeEntity",t.typeEntity)("cdtMatiere",t.cdtMatiere)}}function Co(i,s){if(1&i&&(e.TgZ(0,"div",20),e.YNc(1,po,6,7,"ng-container",8),e.YNc(2,fo,12,13,"div",21),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.SEANCE),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE)}}function ho(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.showDocumentsRendus())}),e._UZ(1,"i",44),e._uU(2),e.qZA()}if(2&i){const t=e.oxw(5);e.xp6(2),e.hij(" Rendre mes devoirs (",t.cdtMatiere.aFaire.documentsRendus.length,") ")}}function go(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.showDocumentsRendus())}),e._UZ(1,"i",44),e._uU(2," Mes devoirs rendus "),e.qZA()}}function vo(i,s){if(1&i&&(e.ynx(0),e.YNc(1,ho,3,1,"button",41),e.YNc(2,go,3,0,"button",42),e.BQk()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",!t.cdtMatiere.aFaire.hasCorrectifs&&!t.cdtMatiere.aFaire.documentsRendusDeposes&&!t.isEnRetard()),e.xp6(1),e.Q6J("ngIf",t.cdtMatiere.aFaire.hasCorrectifs||t.cdtMatiere.aFaire.documentsRendusDeposes)}}function bo(i,s){1&i&&e._UZ(0,"hr",38)}function To(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"h4",39),e._UZ(2,"i",40),e._uU(3," Correctifs "),e.qZA(),e.TgZ(4,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.showDocumentsCorrectifs())}),e._UZ(5,"i",44),e._uU(6),e.qZA(),e._UZ(7,"div",12),e.BQk()}if(2&i){const t=e.oxw(4);e.xp6(6),e.hij(" Voir la liste des correctifs ",t.cdtMatiere.aFaire.correctifs.combien>0?"("+t.cdtMatiere.aFaire.correctifs.combien+")":""," ")}}function xo(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"hr",38),e.TgZ(2,"h4",39),e._UZ(3,"i",40),e._uU(4," Rendre en ligne "),e.qZA(),e.YNc(5,vo,3,2,"ng-container",8),e._UZ(6,"div",12),e.YNc(7,bo,1,0,"hr",33),e.YNc(8,To,8,1,"ng-container",8),e.BQk()),2&i){const t=e.oxw(3);e.xp6(5),e.Q6J("ngIf",t.authStore.isEleve()||t.authStore.isFamille()),e.xp6(2),e.Q6J("ngIf",t.cdtMatiere.aFaire.hasCorrectifs),e.xp6(1),e.Q6J("ngIf",t.cdtMatiere.aFaire.correctifs&&(t.cdtMatiere.aFaire.correctifs.combien>0||""!==t.cdtMatiere.aFaire.correctifs.commentaire))}}function Eo(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"ed-cdt-eleve-qcm",47)(2,"div",12),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("aFaire",t.sideContent)("idEntity",t.idEntity)}}function yo(i,s){1&i&&e._UZ(0,"hr",38)}function So(i,s){if(1&i&&e._UZ(0,"ed-cdt-documents",48),2&i){const t=e.oxw(3);e.Q6J("documents",t.sideContent.documents)("canAddDocuments",!1)("canDeleteDocuments",!1)("idContext",t.sideContent.idDevoir)("typeContext",t.side)}}function Mo(i,s){1&i&&e._UZ(0,"hr",38)}function Do(i,s){if(1&i&&e._UZ(0,"ed-cdt-elems-prog",49),2&i){const t=e.oxw(3);e.Q6J("readonly",!0)("elementsProg",t.sideContent.elementsProg)}}function Zo(i,s){1&i&&e._UZ(0,"hr")}function Ao(i,s){if(1&i&&e._UZ(0,"ed-cdt-ressources-biblio-manuel",50),2&i){const t=e.oxw(3);e.Q6J("readonly",!0)("cdtMatiere",t.cdtMatiere)("side",t.side)}}function wo(i,s){1&i&&e._UZ(0,"hr",38)}function Uo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",32),e.YNc(1,xo,9,3,"ng-container",8),e.YNc(2,Eo,3,2,"ng-container",8),e.YNc(3,yo,1,0,"hr",33),e.YNc(4,So,1,5,"ed-cdt-documents",34),e.YNc(5,Mo,1,0,"hr",33),e.YNc(6,Do,1,2,"ed-cdt-elems-prog",35),e.YNc(7,Zo,1,0,"hr",8),e.YNc(8,Ao,1,3,"ed-cdt-ressources-biblio-manuel",36),e.YNc(9,wo,1,0,"hr",33),e.TgZ(10,"ed-bloc-commentaires",37),e.NdJ("commentaireAdded",function(o){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onCommentaireAdded(o))}),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.sideContent.rendreEnLigne),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE&&t.sideContent.hasQCM),e.xp6(1),e.Q6J("ngIf",t.sideContent.documents&&t.sideContent.documents.length>0),e.xp6(1),e.Q6J("ngIf",t.sideContent.documents&&t.sideContent.documents.length>0),e.xp6(1),e.Q6J("ngIf",t.sideContent.elementsProg&&t.sideContent.elementsProg.length>0),e.xp6(1),e.Q6J("ngIf",t.sideContent.elementsProg&&t.sideContent.elementsProg.length>0),e.xp6(1),e.Q6J("ngIf",t.sideContent.liensManuel&&t.sideContent.liensManuel.length>0),e.xp6(1),e.Q6J("ngIf",t.sideContent.liensManuel&&t.sideContent.liensManuel.length>0),e.xp6(1),e.Q6J("ngIf",t.authStore.isEleve()&&t.cdtMatiere.blogActif),e.xp6(1),e.Q6J("tabCommentaires",t.sideContent.commentaires)("afficherFormulaireCommentaires",t.cdtMatiere.blogActif&&!t.isContenuDeSeanceTAF&&t.authStore.isEleve())("afficherCommentaires",t.sideContent.commentaires&&t.sideContent.commentaires.length>0)("isModerateur",!1)("idSupport",t.sideContent.idDevoir)("typeSupport",t.side)}}const Oo=function(i){return{"ed-card with-epingle":i}};function ko(i,s){if(1&i&&(e.TgZ(0,"div",1),e.YNc(1,lo,8,5,"div",2),e.YNc(2,Co,3,2,"div",3),e.YNc(3,Uo,11,15,"div",4),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(4,Oo,t.side===t.sideCDT.AFAIRE||t.side===t.sideCDT.SEANCE&&t.cdtUserService.isDatePast(t.date))),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE||t.side===t.sideCDT.SEANCE&&(t.isContenuDeSeanceTAF||t.cdtUserService.isDatePast(t.date))),e.xp6(1),e.Q6J("ngIf",t.side===t.sideCDT.AFAIRE||t.side===t.sideCDT.SEANCE&&(t.isContenuDeSeanceTAF||t.cdtUserService.isDatePast(t.date))),e.xp6(1),e.Q6J("ngIf",t.sideContent.rendreEnLigne||t.sideContent.commentaires||t.sideContent.documents&&t.sideContent.documents.length>0||t.sideContent.qcm||t.sideContent.liensManuel||t.sideContent.elementsProg)}}let Po=(()=>{class i{constructor(t,n,o,a,c){this.cdtUserService=t,this.authStore=n,this.cahierDeTexteService=o,this.uiService=a,this.modalService=c,this.isContenuDeSeanceTAF=!1,this.beforeUpdate=new e.vpe,this.afterUpdate=new e.vpe,this.sideCDT=r.P2J,this.edTypeEntity=r.meW,this._datePipe=new r.ifA,this._base64=new r.YC}ngOnInit(){this.sideContent=this.getSideContent()}ngOnChanges(t){Object.isExists(t.cdtMatiere)&&!t.cdtMatiere.isFirstChange()&&t.cdtMatiere.previousValue!==t.cdtMatiere.currentValue&&(this.sideContent=this.getSideContent()),Object.isExists(t.side)&&!t.side.isFirstChange()&&t.side.previousValue!==t.side.currentValue&&(this.sideContent=this.getSideContent())}getSideContent(){if(Object.isExists(this.cdtMatiere)){if(this.side===r.P2J.AFAIRE&&Object.isExists(this.cdtMatiere.aFaire))return this.cdtMatiere.aFaire;if(this.side===r.ce3.SEANCE&&this.isContenuDeSeanceTAF&&Object.isExists(this.cdtMatiere.aFaire.contenuDeSeance))return this.cdtMatiere.aFaire.contenuDeSeance;if(this.side===r.P2J.SEANCE&&Object.isExists(this.cdtMatiere.contenuDeSeance))return this.cdtMatiere.contenuDeSeance}}showContenuSeance(){if(this.side!==r.P2J.AFAIRE)return;const t={id:this.modalService.getModalsCount()+1,initialState:{title:"Contenu de la s\xe9ance du "+this._datePipe.transform(this.sideContent.donneLe,"d LLLL"),injectComponentInputs:{side:r.ce3.SEANCE,date:this.date,cdtMatiere:this.cdtMatiere,parametrage:this.parametrage,idEntity:this.idEntity,typeEntity:this.typeEntity,isContenuDeSeanceTAF:!0},injectComponentClass:i},providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(R.z,t)}showRessource(){const t={id:this.modalService.getModalsCount()+1,initialState:{title:this.cdtMatiere.matiere,injectComponentInputs:{documents:this.cdtMatiere.aFaire.ressourceDocuments,idContext:this.cdtMatiere.id,typeContext:r.ce3.RESSOURCE},injectComponentClass:z.C,close:"Fermer",message:this._base64.transform(this.cdtMatiere.aFaire.ressource,"decode")}};this.modalService.show(R.z,t)}setEffectue(){this.beforeUpdate.emit(),this.cahierDeTexteService.setDevoirEffectue(this.idEntity,this.typeEntity,this.cdtMatiere.id,this._datePipe.transform(this.date,"yyyy-MM-dd"),!this.cdtMatiere.aFaire.effectue).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre mise \xe0 jour a bien \xe9t\xe9 prise en compte !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterUpdate.emit()),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Cahier de texte","fa fa-warning"))).subscribe()}onCommentaireAdded(t){this.beforeUpdate.emit(),this.cahierDeTexteService.addCommentDevoir(this.authStore.currentUser.id,this.authStore.currentUser.typeCompte,this.cdtMatiere.id,t,this.side).pipe((0,u.b)(()=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre commentaire a bien \xe9t\xe9 enregistr\xe9 !","Cahier de texte","icon-ed_cahierdetexte")}),(0,C.x)(()=>this.afterUpdate.emit()),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Cahier de texte","fa fa-warning"))).subscribe()}showDocumentsRendus(){const t={id:this.modalService.getModalsCount()+1,initialState:{idEleve:this.idEntity,cdtMatiere:this.cdtMatiere,dateDevoir:this.date},class:"modal-lg"};this.modalService.show($n,t)}showDocumentsCorrectifs(){const t={id:this.modalService.getModalsCount()+1,initialState:{idEleve:this.idEntity,cdtMatiere:this.cdtMatiere,dateDevoir:this.date},class:"modal-lg"};this.modalService.show(Xn,t)}isEnRetard(){const t=r.C_1.addNbJourToDate(this.date,this.cdtMatiere.nbJourMaxRenduDevoir);return r.C_1.isDatePassee(t,!1)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(r.CnD),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-taf-seance"]],inputs:{side:"side",date:"date",cdtMatiere:"cdtMatiere",parametrage:"parametrage",idEntity:"idEntity",typeEntity:"typeEntity",isContenuDeSeanceTAF:"isContenuDeSeanceTAF"},outputs:{beforeUpdate:"beforeUpdate",afterUpdate:"afterUpdate"},features:[e.TTD],decls:1,vars:1,consts:[["class","card",3,"ngClass",4,"ngIf"],[1,"card",3,"ngClass"],["class","px-0 panel-heading-devoir margin-bottom-10",4,"ngIf"],["class","card-body ps-3 pe-2",4,"ngIf"],["class","footer border-0 bg-white",4,"ngIf"],[1,"px-0","panel-heading-devoir","margin-bottom-10"],["class","float-end btn btn-primary-color btn-fab btn-raised d-print-none","type","button","title","Voir les ressources",3,"click",4,"ngIf"],["class","btn btn-secondary float-end","type","button",3,"title","click",4,"ngIf"],[4,"ngIf"],[1,"ps-3"],["class","text-danger",4,"ngIf"],["class","form-check d-print-none",4,"ngIf"],[1,"clearfix"],["type","button","title","Voir les ressources",1,"float-end","btn","btn-primary-color","btn-fab","btn-raised","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-database"],["type","button",1,"btn","btn-secondary","float-end",3,"title","click"],[1,"text-danger"],[1,"form-check","d-print-none"],["type","checkbox","id","checkEffectue",1,"form-check-input",3,"ngModel","ngModelChange"],["for","checkEffectue",1,"form-check-label"],[1,"card-body","ps-3","pe-2"],["class","row",4,"ngIf"],["edMathjax","",1,"contenu-non-maitrise","contenuSeance","ed-cke",3,"content","innerHTML"],["class","float-start",4,"ngIf"],[1,"float-start"],[1,"row"],[1,"col-lg-9"],["edMathjax","",1,"contenu-non-maitrise","contenuAfaire","ed-cke",3,"content","innerHTML"],["class","float-end",4,"ngIf"],[1,"col-lg-3"],[3,"idEntity","typeEntity","cdtMatiere"],[1,"float-end"],[1,"footer","border-0","bg-white"],["role","separator",4,"ngIf"],[3,"documents","canAddDocuments","canDeleteDocuments","idContext","typeContext",4,"ngIf"],[3,"readonly","elementsProg",4,"ngIf"],[3,"readonly","cdtMatiere","side",4,"ngIf"],[3,"tabCommentaires","afficherFormulaireCommentaires","afficherCommentaires","isModerateur","idSupport","typeSupport","commentaireAdded"],["role","separator"],["aria-hidden","true",1,"d-print-none"],[1,"fa","fa-file"],["type","button","class","btn btn-success btn-sm float-end d-print-none","title","Rendre mes devoirs",3,"click",4,"ngIf"],["type","button","class","btn btn-success btn-sm float-end d-print-none","title","Mes devoirs rendus",3,"click",4,"ngIf"],["type","button","title","Rendre mes devoirs",1,"btn","btn-success","btn-sm","float-end","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-upload","i-small"],["type","button","title","Mes devoirs rendus",1,"btn","btn-success","btn-sm","float-end","d-print-none",3,"click"],["type","button","title","Voir les correctifs",1,"btn","btn-success","btn-sm","float-end","d-print-none",3,"click"],[3,"aFaire","idEntity"],[3,"documents","canAddDocuments","canDeleteDocuments","idContext","typeContext"],[3,"readonly","elementsProg"],[3,"readonly","cdtMatiere","side"]],template:function(t,n){1&t&&e.YNc(0,ko,4,6,"div",0),2&t&&e.Q6J("ngIf",n.sideContent)},dependencies:[l.mk,l.O5,_.Wl,_.JJ,_.On,ce.L,K.M,z.C,Ee.c,ge,be,io,r.YC,r.ifA,no.p,de.w],styles:[".panel-heading-devoir h3{text-align:center;color:var(--light-primary-color)}.footer{margin-top:20px;padding:20px}.footer hr{margin-left:-20px;margin-right:-20px;color:#eee;opacity:1}.footer ul li,.footer ul.list-inline li{margin:0 0 0 15px;list-style:disc}.footer h4{color:var(--light-primary-color);text-transform:uppercase}.contenu-non-maitrise{word-break:break-word}.contenu-non-maitrise a{color:#00f;text-decoration:underline}.contenu-non-maitrise img{max-width:100%}.contenu-non-maitrise ul{list-style:disc;padding:revert}.contenu-non-maitrise ol{padding:revert}\n"],encapsulation:2,changeDetection:0}),i})();const De=function(i){return{active:i}};function Io(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.setModeActif(o.sideCDT.SEANCE))}),e._uU(1," Contenus de s\xe9ances "),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("ngClass",e.VKq(1,De,t.side===t.sideCDT.SEANCE))}}function Jo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"button",6),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.setModeActif(o.sideCDT.AFAIRE))}),e._uU(3,"Travail \xe0 faire"),e.qZA(),e.YNc(4,Io,2,3,"button",7),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngClass",e.VKq(2,De,t.side===t.sideCDT.AFAIRE)),e.xp6(2),e.Q6J("ngIf",t.cdtUserService.isDatePast(t.date)&&t.parametrage.compteRenduSeance)}}function Fo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ed-cdt-eleve-taf-seance",10),e.NdJ("beforeUpdate",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.onBeforeTafSeanceUpdate())})("afterUpdate",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.onAfterTafSeanceUpdate())}),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw(3);e.Q6J("side",n.side)("cdtMatiere",t)("date",n.date)("parametrage",n.parametrage)("idEntity",n.idEntity)("typeEntity",n.typeEntity)}}function No(i,s){if(1&i&&(e.TgZ(0,"div",8),e.ALo(1,"edDate"),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"edDate"),e.qZA(),e.YNc(5,Fo,1,6,"ed-cdt-eleve-taf-seance",9),e.ALo(6,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.s9C("id",e.xi3(1,4,t.date,"EEEE d MMMM")),e.xp6(3),e.Oqu(e.xi3(4,7,t.date,"EEEE d MMMM")),e.xp6(2),e.Q6J("ngForOf",t.cdtDuJour.matieres)("ngForTrackBy",e.lcZ(6,10,"matiere"))}}function qo(i,s){if(1&i&&(e.TgZ(0,"div",1),e.YNc(1,Jo,5,4,"div",2),e.YNc(2,No,7,12,"div",3),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngBusy",t.loader),e.xp6(1),e.Q6J("ngIf",t.typeVueCDT!==t.CONST_TYPE_VUE_CDT_ELEVE.SEMAINE),e.xp6(1),e.Q6J("ngIf",t.cdtDuJour)}}let Lo=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h){super(),this.cahierDeTexteStore=t,this.authStore=n,this.cahierDeTexteService=o,this.uiService=a,this.loaderService=c,this.cdtUserService=p,this.cd=h,this.typeVueCDT=r.Rcf.JOUR,this.sideCDT=r.P2J,this.CONST_TYPE_VUE_CDT_ELEVE=r.Rcf,this.side=r.P2J.AFAIRE,this._datePipe=new r.ifA}ngOnChanges(t){Object.isExists(this._cdtJourSubscription)&&this._cdtJourSubscription.unsubscribe(),this._cdtJourSubscription=this.cahierDeTexteStore.selectCahierDeTexte(this.typeEntity,this.idEntity,{dateDebut:this.date,dateFin:this.date}).pipe((0,u.b)(n=>{this.updateCdtJour(Array.isArray(n)&&n.length>0?n[0]:void 0)}),(0,v.R)(this.componentDestroyed$)).subscribe(),Object.isExists(t.date)&&(!Object.isExists(t.date.previousValue)||!r.C_1.isSameDay(t.date.previousValue,t.date.currentValue))&&(!this.cdtUserService.isDatePast(this.date)||!this.parametrage.compteRenduSeance)&&this.setModeActif(r.P2J.AFAIRE),this.loadCdtEleve(this.date)}loadCdtEleve(t){!Object.isExists(t)||(this.loader=this.loaderService.show(this),this.cahierDeTexteService.cahierDeTextesParDate(this.idEntity,this.typeEntity,this._datePipe.transform(t,"yyyy-MM-dd")).pipe((0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration du cahier de texte impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe())}setModeActif(t){this.side=t,this.cd.markForCheck()}updateCdtJour(t){this.cdtDuJour=Object.isExists(t)?new r.ftL(t):void 0,this.cd.markForCheck()}onBeforeTafSeanceUpdate(){this.loader=this.loaderService.show(this)}onAfterTafSeanceUpdate(){this.loaderService.hide(this)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.x1h),e.Y36(r.CnD),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(y.S),e.Y36(m),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve-view-day"]],inputs:{date:"date",idEntity:"idEntity",typeEntity:"typeEntity",typeVueCDT:"typeVueCDT",parametrage:"parametrage"},features:[e.qOj,e.TTD],decls:1,vars:1,consts:[["class","tab-pane active day","id","tab-devoirs-jour",3,"ngBusy",4,"ngIf"],["id","tab-devoirs-jour",1,"tab-pane","active","day",3,"ngBusy"],["class","text-center d-print-none",4,"ngIf"],["class","encartJour pt-4",3,"id",4,"ngIf"],[1,"text-center","d-print-none"],["id","switch-view",1,"btn-group"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],["type","button","class","btn btn-secondary",3,"ngClass","click",4,"ngIf"],[1,"encartJour","pt-4",3,"id"],[3,"side","cdtMatiere","date","parametrage","idEntity","typeEntity","beforeUpdate","afterUpdate",4,"ngFor","ngForOf","ngForTrackBy"],[3,"side","cdtMatiere","date","parametrage","idEntity","typeEntity","beforeUpdate","afterUpdate"]],template:function(t,n){1&t&&e.YNc(0,qo,3,3,"div",0),2&t&&e.Q6J("ngIf",n.date)},dependencies:[l.mk,l.sg,l.O5,T.DC,Po,r.ifA,Z.$],styles:["div.encartJour[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),i})();function Yo(i,s){if(1&i&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("(",t.libelleEntity,")")}}function Ro(i,s){if(1&i&&e._UZ(0,"ed-cdt-eleve-avenir",18),2&i){const t=e.oxw(2);e.Q6J("idEntity",t.idEntity)("typeEntity",t.typeEntity)("parametrage",t.parametrage)}}function Qo(i,s){if(1&i&&(e._UZ(0,"ed-cdt-eleve-view-day",19),e.ALo(1,"async")),2&i){const t=e.oxw(2);e.Q6J("date",e.lcZ(1,5,t.cdtUserService.cdtEleve.selectedDate$))("idEntity",t.idEntity)("typeEntity",t.typeEntity)("typeVueCDT",t.typeVueCDT)("parametrage",t.parametrage)}}function Vo(i,s){if(1&i&&e._UZ(0,"ed-cdt-eleve-view-day",19),2&i){const t=s.$implicit,n=e.oxw(3);e.Q6J("date",t)("idEntity",n.idEntity)("typeEntity",n.typeEntity)("typeVueCDT",n.typeVueCDT)("parametrage",n.parametrage)}}function Go(i,s){if(1&i&&(e.TgZ(0,"div",20),e.YNc(1,Vo,1,5,"ed-cdt-eleve-view-day",21),e.ALo(2,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.joursSemaine)("ngForTrackBy",e.lcZ(2,2,"$index"))}}function Bo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"ed-cdt-eleve-navigation",6),e.NdJ("selectClasseOfGroupe",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectClasseOfGroupe(o))}),e.ALo(3,"async"),e.qZA()(),e.TgZ(4,"div",7)(5,"div",8)(6,"div",9)(7,"div",10)(8,"button",11),e._UZ(9,"i",12),e.qZA(),e.YNc(10,Ro,1,3,"ed-cdt-eleve-avenir",13),e.YNc(11,Qo,2,7,"ed-cdt-eleve-view-day",14),e.YNc(12,Go,3,4,"div",15),e.qZA()(),e.TgZ(13,"div",16),e._UZ(14,"ed-cdt-eleve-onglets",17),e.ALo(15,"async"),e.ALo(16,"async"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Q6J("idEntity",t.idEntity)("typeEntity",t.typeEntity)("entity",t.entity)("dateSelected",e.lcZ(3,14,t.cdtUserService.cdtEleve.selectedDate$))("parametrage",t.parametrage),e.xp6(8),e.Q6J("ngIf",t.typeVueCDT===t.CONST_TYPE_VUE_CDT_ELEVE.AVENIR),e.xp6(1),e.Q6J("ngIf",t.typeVueCDT===t.CONST_TYPE_VUE_CDT_ELEVE.JOUR),e.xp6(1),e.Q6J("ngIf",t.typeVueCDT===t.CONST_TYPE_VUE_CDT_ELEVE.SEMAINE),e.xp6(2),e.Q6J("typeEntity",t.typeEntity)("idEntity",t.idEntity)("typeVueCDT",t.typeVueCDT)("dateSelected",e.lcZ(15,16,t.cdtUserService.cdtEleve.selectedDate$))("periodeCDT",e.lcZ(16,18,t.cdtUserService.cdtEleve.periodeCDT$))("isCDTPrimaire",t.parametrage.isCDTPrimaire)}}let Ze=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p){super(),this.authStore=t,this.cdtUserService=n,this.uiService=o,this.etablissementService=a,this.groupeFlexibleService=c,this.groupeFlexibleStore=p,this.CONST_TYPE_VUE_CDT_ELEVE=r.Rcf}get typeVueCDT(){return this.cdtUserService.cdtEleve.typeVue}get libelleEntity(){let t="";return Object.isExists(this.entity)?this.entity instanceof r.Mn7||this.entity instanceof r.zJg||this.entity instanceof r.oQM?this.entity.libelle:this.entity instanceof r.Dfc?(t+=this.entity.prenom+" - "+this.entity.classe.libelle,t):"":""}ngOnInit(){this.refreshCdtEleve(),this.cdtUserService.cdtEleve.periodeCDT$.pipe((0,u.b)(t=>{!Object.isExists(t)||(this.joursSemaine=r.C_1.getDaysOfWeek(t.periode.dateDebut),this.joursSemaine.pop())}),(0,v.R)(this.componentDestroyed$)).subscribe()}ngOnChanges(t){Object.values(t).some(o=>o.isFirstChange())||this.refreshCdtEleve()}ngOnDestroy(){return this.cdtUserService.resetCDTEleve(),super.ngOnDestroy()}refreshCdtEleve(){this.cdtUserService.initCdtEleve(this.typeEntity===r.meW.ELEVE&&(this.authStore.isFamille()||this.authStore.isEleve())?this.idEntity:void 0).pipe((0,D.w)(t=>{if(!t)return(0,cn._)(()=>new r.FwQ("Initialisation du cahier de texte impossible"));let n;return this.parametrage=this.cdtUserService.cdtEleve.parametrage,this.joursSemaine=r.C_1.getDaysOfWeek(),this.joursSemaine.pop(),n=this.typeEntity===r.meW.CLASSE||this.typeEntity===r.meW.GROUPE?this.etablissementService.getClasseGroupeById(this.idEntity,this.typeEntity):this.typeEntity===r.meW.ELEVE?this.authStore.getEleve(this.idEntity):(0,U.of)(void 0),n}),(0,D.w)(t=>this.typeEntity!==r.meW.GROUPE||Object.isExists(t)?(0,U.of)(t):this.groupeFlexibleService.getDetailGroupeFlexible(this.authStore.currentUser.id,this.authStore.currentUser.typeCompte,this.idEntity).pipe((0,j.d)(null),(0,ne.U)(()=>this.groupeFlexibleStore.getDetailGroupeFlexible(this.authStore.variantForCurrentUser,this.idEntity)))),(0,u.b)(t=>{this.entity=t instanceof r.Mn7?new r.Mn7(t):t instanceof r.zJg?new r.zJg(t):t instanceof r.oQM?new r.oQM(t):t instanceof r.Dfc?new r.Dfc(t):t instanceof r.XPO?new r.XPO(t):void 0}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning"))).subscribe()}onSelectClasseOfGroupe(t){this.idEntity=t.id,this.typeEntity=t instanceof r.oQM?r.meW.GROUPE:t.typeEntity}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(m),e.Y36(r.VLf),e.Y36(r.Xmb),e.Y36(r.K6q),e.Y36(r.WME))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-eleve"]],inputs:{idEntity:"idEntity",typeEntity:"typeEntity"},features:[e.qOj,e.TTD],decls:5,vars:2,consts:[[1,"ed-container","cahierdetexte","double-padding"],[1,"cdt"],[4,"ngIf"],["class","container-bg no-padding row",4,"ngIf"],[1,"container-bg","no-padding","row"],[1,"col-lg-4","cdtnavigation","d-print-none"],[3,"idEntity","typeEntity","entity","dateSelected","parametrage","selectClasseOfGroupe"],[1,"col-lg-8","contenuafaire","ps-5"],[1,"row","g-xl-1"],[1,"col-sm-10","col-md-11","col-lg-10","col-xl-11","cahierdetexteimprimable"],[1,"tab-content"],["aria-label","Imprimer la page en cours","title","Imprimer la page en cours","onclick","window.print();",1,"btn","btn-secondary","btn-raised","float-end","d-print-none","btn-impression-cdt","print",2,"z-index","500"],["aria-hidden","true",1,"fa","fa-print"],[3,"idEntity","typeEntity","parametrage",4,"ngIf"],[3,"date","idEntity","typeEntity","typeVueCDT","parametrage",4,"ngIf"],["id","tab-devoirs-semaine","class","tab-pane active",4,"ngIf"],["id","cdtnavigation-week",1,"col-sm-2","col-md-1","col-lg-2","col-xl-1","d-print-none"],[3,"typeEntity","idEntity","typeVueCDT","dateSelected","periodeCDT","isCDTPrimaire"],[3,"idEntity","typeEntity","parametrage"],[3,"date","idEntity","typeEntity","typeVueCDT","parametrage"],["id","tab-devoirs-semaine",1,"tab-pane","active"],[3,"date","idEntity","typeEntity","typeVueCDT","parametrage",4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2," Cahier de textes "),e.YNc(3,Yo,2,1,"small",2),e.qZA(),e.YNc(4,Bo,17,20,"div",3),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",""!==n.libelleEntity),e.xp6(1),e.Q6J("ngIf",n.parametrage))},dependencies:[l.sg,l.O5,fn,qn,Bn,Lo,l.Ov,Z.$],styles:[".cahierdetexte[_ngcontent-%COMP%]   .cdtnavigation[_ngcontent-%COMP%]{position:relative;padding:20px;background:var(--footer-primary-color)}.cahierdetexte[_ngcontent-%COMP%]   #bloc-docs-rendus[_ngcontent-%COMP%]   .liste-fichiers[_ngcontent-%COMP%]{max-height:300px;overflow:auto}.contenuafaire[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:20px 0}#cdtInterrogationClasse[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:10px}#cdtInterrogationClasse[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--light-primary-color)}#form-rendre-devoir[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]{min-width:100%}"],changeDetection:0}),i})();var W=d(59241),jo=d(35684);const $o=["tafSeanceTabset"];function Ho(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"ed-cdt-taf-seance",16),e.NdJ("beforeSlotUpdate",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onBeforeSlotUpdate())})("afterSlotUpdate",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onAfterSlotUpdate())}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("parametrage",t.parametrage)("slot",t.slot)("side",t.sideCDT.AFAIRE)("typeViewCDT",t.TYPES_VIEW.EDT)}}function Ko(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"ed-cdt-taf-seance",16),e.NdJ("beforeSlotUpdate",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onBeforeSlotUpdate())})("afterSlotUpdate",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onAfterSlotUpdate())}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("parametrage",t.parametrage)("slot",t.slot)("side",t.sideCDT.SEANCE)("typeViewCDT",t.TYPES_VIEW.EDT)}}let zo=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c){super(),this.modalRef=t,this.loaderService=n,this.authStore=o,this.cd=a,this.cdtUserService=c,this.TYPES_VIEW=r.a7m,this.sideCDT=r.P2J}ngOnInit(){this.cdtUserService.cdtProf.selectedSlot$.pipe((0,jo.T)(1),(0,u.b)(t=>{Object.isExists(t)&&(this.slot=new r.B5X(t),Object.isExists(this.slot.aFaire)&&this.slot.aFaire.modeEdit?this.tafSeanceTabset.tabs[0].active=!0:Object.isExists(this.slot.seance)&&this.slot.seance.modeEdit&&(this.tafSeanceTabset.tabs[1].active=!0))}),(0,v.R)(this.componentDestroyed$)).subscribe()}onBeforeSlotUpdate(){this.loader=this.loaderService.show(this),this.cd.markForCheck()}onAfterSlotUpdate(){this.loaderService.hide(this)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.UZ),e.Y36(y.S),e.Y36(r.CnD),e.Y36(e.sBO),e.Y36(m))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-slot-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf($o,5),2&t){let o;e.iGM(o=e.CRH())&&(n.tafSeanceTabset=o.first)}},inputs:{slot:"slot",parametrage:"parametrage"},features:[e.qOj],decls:19,vars:10,consts:[[3,"ngBusy"],[1,"modal-header"],[1,"modal-title"],[1,"modal-subtitle"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body","saisie-CDT-modale"],[3,"justified"],["tafSeanceTabset",""],["heading","Travail \xe0 faire",1,"trav"],["tabT","tab"],["class","cdt-colonne colonne-travail-a-faire widthGlobale",4,"ngIf"],["heading","Contenu de s\xe9ance",1,"cont"],["tabC","tab"],["class","cdt-colonne widthGlobale",4,"ngIf"],[1,"modal-footer"],[1,"cdt-colonne","colonne-travail-a-faire","widthGlobale"],[1,"no-padding",3,"parametrage","slot","side","typeViewCDT","beforeSlotUpdate","afterSlotUpdate"],[1,"cdt-colonne","widthGlobale"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"h3",2),e._uU(4),e.qZA(),e.TgZ(5,"p",3),e._uU(6),e.ALo(7,"edDate"),e.qZA()(),e.TgZ(8,"button",4),e.NdJ("click",function(){return n.modalRef.hide()}),e.qZA()(),e.TgZ(9,"div",5)(10,"tabset",6,7)(12,"tab",8,9),e.YNc(14,Ho,2,4,"div",10),e.qZA(),e.TgZ(15,"tab",11,12),e.YNc(17,Ko,2,4,"div",13),e.qZA()()(),e._UZ(18,"div",14),e.qZA()),2&t){const o=e.MAs(13),a=e.MAs(16);e.Q6J("ngBusy",n.loader),e.xp6(4),e.AsE("",n.slot.entityLibelle," - ",n.slot.matiereLibelle,""),e.xp6(2),e.Oqu(e.xi3(7,7,n.slot.date,"EEEE d LLLL")),e.xp6(4),e.Q6J("justified",!0),e.xp6(4),e.Q6J("ngIf",o.active),e.xp6(3),e.Q6J("ngIf",a.active)}},dependencies:[l.O5,T.DC,W.wW,W.AH,xe,r.ifA],styles:["ed-cdt-slot-modal .modal-body .nav-tabs>li:nth-child(1) a,ed-cdt-slot-modal .modal-body .nav-tabs>li:nth-child(1).active a{color:var(--travail-color)}ed-cdt-slot-modal .modal-body .nav-tabs>li:nth-child(2) a,ed-cdt-slot-modal .modal-body .nav-tabs>li:nth-child(2).active a{color:var(--contenu-color)}ed-cdt-slot-modal .modal-body .nav-tabs>li.active a{font-size:17px;text-transform:uppercase;font-weight:700}ed-cdt-slot-modal div.ed-cdt-taf-seance .bloc-titre{font-weight:700}ed-cdt-slot-modal div.ed-cdt-taf-seance .bloc-titre h3{display:none}ed-cdt-slot-modal div.ed-cdt-taf-seance .bloc-titre:before{content:none}ed-cdt-slot-modal div.ed-cdt-taf-seance .bloc-content{margin-bottom:0;min-height:unset}ed-cdt-slot-modal div.ed-cdt-taf-seance .bloc-plus{margin:0;padding:15px}\n"],encapsulation:2,changeDetection:0}),i})();function Wo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",16)(1,"button",15),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.selectClasseGroupe(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(2),e.AsE("",t.libelle," (code:",t.code,")")}}const Ae=function(){return["libelle"]};function Xo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ul",12),e.YNc(1,Wo,3,2,"li",13),e.ALo(2,"orderBy"),e.ALo(3,"trackByProperty"),e.TgZ(4,"li",14)(5,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.selectClasseGroupe(o.classeForce))}),e._uU(6),e.qZA()(),e.TgZ(7,"li",16)(8,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.selectClasseGroupe(o.classeAucune))}),e._uU(9,"Aucune classe/groupe"),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,3,t.classes,e.DdM(8,Ae)))("ngForTrackBy",e.lcZ(3,6,"id")),e.xp6(5),e.hij("Forcer la saisie sur ",t.slot.entityLibelle,"")}}function er(i,s){1&i&&(e.TgZ(0,"div")(1,"div",20)(2,"h3"),e._uU(3,"Vous ne pouvez pas saisir de cahier de texte sur une classe ou un groupe qui n'est pas pr\xe9vu dans votre param\xeatrage note."),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"h4"),e._uU(6,"Veuillez contacter l'\xe9quipe param\xe9trage de votre \xe9tablissement."),e.qZA()()())}function tr(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,er,7,0,"div",4),e.TgZ(2,"div")(3,"div",17)(4,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.close())}),e._uU(5,"Annuler"),e.qZA()(),e.TgZ(6,"div",17)(7,"button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.associateClasse())}),e._uU(8," Valider "),e.qZA()()(),e.BQk()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Aucune"===t.selectedClasseGroupe.libelle),e.xp6(6),e.Q6J("disabled","ind\xe9fini"===t.selectedClasseGroupe.code)}}function ir(i,s){if(1&i&&(e.TgZ(0,"div")(1,"form")(2,"fieldset")(3,"h4"),e._uU(4," Vous souhaitez saisir pour "),e.TgZ(5,"strong"),e._uU(6),e.qZA()(),e.TgZ(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"div",7)(10,"strong",8),e._uU(11),e._UZ(12,"br"),e._uU(13," dans votre param\xe9trage note ? "),e.qZA(),e.TgZ(14,"div",9)(15,"button",10),e._uU(16),e.qZA(),e.YNc(17,Xo,10,9,"ul",11),e.qZA()(),e.YNc(18,tr,9,2,"ng-container",4),e.qZA()()()),2&i){const t=e.oxw();e.xp6(6),e.AsE("",t.slot.entityLibelle," (code: ",t.slot.entityCode,")"),e.xp6(2),e.hij("","C"===t.slot.entityType?"Cette classe est inconnue":"Ce groupe est inconnu"," dans votre param\xe9trage note."),e.xp6(3),e.hij(" \xc0 quoi correspond-","C"===t.slot.entityType?"elle":"il"," "),e.xp6(5),e.hij(" ",t.selectedClasseGroupe?t.selectedClasseGroupe.libelle+" (code:"+t.selectedClasseGroupe.code+")":"Choisir une classe ou un groupe"," "),e.xp6(2),e.Q6J("ngIf",t.selectedClasseGroupe)}}function nr(i,s){1&i&&(e.TgZ(0,"div",20)(1,"h3"),e._uU(2,"Vous ne pouvez pas saisir de cahier de texte car il n'y a pas de mati\xe8re associ\xe9 \xe0 ce cours"),e.qZA(),e._UZ(3,"br"),e.TgZ(4,"h4"),e._uU(5,"Veuillez contacter l'\xe9quipe param\xe9trage de votre \xe9tablissement pour modifier votre emploi du temps."),e.qZA()())}function or(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",16)(1,"button",15),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.selectMatiere(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(2),e.AsE("",t.libelle," (code: ",t.code,")")}}function rr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ul",25),e.YNc(1,or,3,2,"li",13),e.ALo(2,"orderBy"),e.ALo(3,"trackByProperty"),e.TgZ(4,"li",14)(5,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.selectMatiere(o.matiereForce))}),e._uU(6),e.qZA()(),e.TgZ(7,"li",16)(8,"button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.selectMatiere(o.matiereAucune))}),e._uU(9,"Aucune mati\xe8re"),e.qZA()()()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.xi3(2,4,t.allMatieres,e.DdM(9,Ae)))("ngForTrackBy",e.lcZ(3,7,"id")),e.xp6(5),e.AsE(" Forcer la saisie sur ",t.slot.matiereLibelle," (code: ",t.slot.matiereCode,") ")}}function sr(i,s){1&i&&(e.TgZ(0,"div")(1,"div",20)(2,"h3"),e._uU(3,"Vous ne pouvez pas saisir de cahier de texte sur une mati\xe8re qui n'est pas pr\xe9vue dans votre param\xeatrage note."),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"h4"),e._uU(6,"Veuillez contacter l'\xe9quipe param\xe9trage de votre \xe9tablissement."),e.qZA()()())}function ar(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.YNc(1,sr,7,0,"div",4),e.TgZ(2,"div")(3,"div",17)(4,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.close())}),e._uU(5,"Annuler"),e.qZA()(),e.TgZ(6,"div",17)(7,"button",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.associateMatiere())}),e._uU(8," Valider "),e.qZA()()(),e.BQk()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","Aucune"===t.selectedMatiere.libelle),e.xp6(6),e.Q6J("disabled","ind\xe9fini"===t.selectedMatiere.code)}}function cr(i,s){if(1&i&&(e.TgZ(0,"fieldset")(1,"h4"),e._uU(2," Vous souhaitez saisir sur la mati\xe8re "),e.TgZ(3,"strong"),e._uU(4),e.qZA()(),e.TgZ(5,"p"),e._uU(6,"Cette mati\xe8re est inconnue dans votre param\xe9trage note."),e.qZA(),e.TgZ(7,"div")(8,"strong",22),e._uU(9," A quoi correspond-elle "),e._UZ(10,"br"),e._uU(11," dans votre param\xe9trage note ? "),e.qZA(),e.TgZ(12,"div",9)(13,"button",23),e._uU(14),e.qZA(),e.YNc(15,rr,10,10,"ul",24),e.qZA()(),e.YNc(16,ar,9,2,"ng-container",4),e.qZA()),2&i){const t=e.oxw(2);e.xp6(4),e.AsE("",t.slot.matiereLibelle," (code: ",t.slot.matiereCode,")"),e.xp6(10),e.hij(" ",t.selectedMatiere?t.selectedMatiere.libelle+" (code:"+t.selectedMatiere.code+")":"Choisir une mati\xe8re"," "),e.xp6(2),e.Q6J("ngIf",t.selectedMatiere)}}function dr(i,s){if(1&i&&(e.TgZ(0,"div")(1,"form"),e.YNc(2,nr,6,0,"div",21),e.YNc(3,cr,17,4,"fieldset",4),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.slot.matiereCode),e.xp6(1),e.Q6J("ngIf",t.slot.matiereCode)}}let we=(()=>{class i{constructor(t,n,o,a,c){this.cdtUserService=t,this.uiService=n,this.loaderService=o,this.cahierdetexteService=a,this.modalRef=c,this.onClose$=new oe.x}ngOnInit(){this.classes=this.cdtUserService.cdtProf.classesGroupes,this.classeForce=new r.Mn7({libelle:this.slot.entityLibelle,code:this.slot.entityCode,typeEntity:this.slot.entityType}),this.classeAucune=new r.Mn7({libelle:"Aucune",code:"ind\xe9fini"}),this.matiereForce=new r.vcu({libelle:this.slot.matiereLibelle,code:this.slot.matiereCode}),this.matiereAucune=new r.vcu({libelle:"Aucune",code:"ind\xe9fini"})}close(){this.modalRef.hide()}selectClasseGroupe(t){this.selectedClasseGroupe=t}associateClasse(){this.loader=this.loaderService.show(this),this.cahierdetexteService.associateClasseGroupe(this.slot.entityLibelle,this.slot.entityCode,this.slot.entityType,this.selectedClasseGroupe).pipe((0,u.b)(()=>{this.matiereNeeded&&(this.allMatieres=this.cdtUserService.cdtProf.classesGroupes.find(t=>t.code===this.slot.entityCode&&t.typeEntity===this.slot.entityType).matieres,this.step=2),this.onClose$.next({reason:E.G.validation}),this.modalRef.hide(),this.uiService.notifyEvent(r.DOJ.genericSuccess,"La correspondance a bien \xe9t\xe9 ajout\xe9","Correspondance","fa fa-correspondance")}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}selectMatiere(t){this.selectedMatiere=t}associateMatiere(){this.loader=this.loaderService.show(this),this.cahierdetexteService.associateMatiere(this.slot.matiereLibelle,this.slot.matiereCode,this.selectedMatiere).pipe((0,u.b)(()=>{this.onClose$.next({reason:E.G.validation}),this.modalRef.hide(),this.uiService.notifyEvent(r.DOJ.genericSuccess,"La correspondance a bien \xe9t\xe9 ajout\xe9","Correspondance","fa fa-correspondance")}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}ngOnDestroy(){this.onClose$.complete()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(r.VLf),e.Y36(y.S),e.Y36(r.mYE),e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-make-correspondance"]],inputs:{slot:"slot",allMatieres:"allMatieres",step:"step",matiereNeeded:"matiereNeeded"},decls:10,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-primary","float-end",3,"click"],[1,"row"],[1,"col-lg-4","texte-label"],["dropdown","",1,"col-lg-5","btn-group"],["id","dropdownClasseGroupe","type","button","dropdownToggle","","aria-controls","dropdown-classe",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownClasseGroupe","class","dropdown-menu","id","dropdown-classe","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownClasseGroupe","id","dropdown-classe","role","menu",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf","ngForTrackBy"],["role","menuitem",2,"border-top","dashed black"],["type","button",1,"dropdown-item",3,"click"],["role","menuitem"],[1,"col-lg-4"],["name","cancelbutton","type","button",1,"btn","btn-danger",3,"click"],["type","button","name","singlebutton",1,"btn","btn-primary",3,"disabled","click"],[1,"jumbotron","jumbotron-danger"],["class","jumbotron jumbotron-danger",4,"ngIf"],[1,"col-lg-4","texte-label",2,"padding-top","18px"],["id","dropdownMenuMatiere","type","button","dropdownToggle","","aria-controls","dropdown-matiere",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownMenuMatiere","class","dropdown-menu","id","dropdown-matiere","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuMatiere","id","dropdown-matiere","role","menu",1,"dropdown-menu"],["id","singlebutton","name","singlebutton","type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Correspondance Emploi du temps / Notes"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,ir,19,6,"div",4),e.YNc(6,dr,4,2,"div",4),e.qZA(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return n.close()}),e._uU(9,"Fermer"),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",1===n.step),e.xp6(1),e.Q6J("ngIf",2===n.step))},dependencies:[l.sg,l.O5,_._Y,_.JL,_.F,M.Hz,M.Mq,M.TO,T.DC,r.d0N,Z.$],encapsulation:2,changeDetection:0}),i})();var lr=d(69248);const ur=["scheduler_cdt"];function pr(i,s){1&i&&e._UZ(0,"ed-connecteur-robert-dico-en-ligne")}let _r=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a){super(),this.authStore=t,this.modalService=n,this.schedulerService=o,this.cdtUserService=a,this.idUser=this.authStore.currentUser.id,this.typeUser=this.authStore.currentUser.typeCompte,this._datePipe=new r.ifA,this.actionOnSelect=new e.vpe}ngOnInit(){this.cdtUserService.cdtProf.periodeCDT$.pipe((0,u.b)(t=>{!Object.isExists(t)||Object.isExists(this.schedulerService.schedulerCurrent)&&this.schedulerService.schedulerCurrent.updateView(t.periode.dateDebut,t.type)}),(0,v.R)(this.componentDestroyed$)).subscribe(),Object.isExists(this.cdtUserService.cdtProf.periodeCDT)&&"week"!==this.cdtUserService.cdtProf.periodeCDT.type&&this.cdtUserService.selectPeriodeCDT({periode:{...this.cdtUserService.cdtProf.periodeCDT.periode,...r.C_1.getWeekPeriodForADay()},type:"week"})}findAllMatieres(t){let n=this.cdtUserService.cdtProf.classesGroupes.find(o=>o.code===t.entityCode&&o.typeEntity===t.entityType);!Object.isExists(n)||(this.allMatieres=n.matieres)}ngAfterViewInit(){this.schedulerService.schedulerCurrent=scheduler,this.schedulerService.initConfig(),Object.isExists(this.schedulerConfig)&&(this.schedulerService.schedulerCurrent.config.details_on_dblclick=!!Object.isExists(this.schedulerConfig.dblClickEnable)&&this.schedulerConfig.dblClickEnable,this.schedulerService.schedulerCurrent.config.details_on_dblclick&&this.schedulerService.attachEvent("onDblClick",this.clickEventHandler.bind(this)),this.schedulerService.attachEvent("onClick",this.clickEventHandler.bind(this))),this.schedulerService.attachEvent("onTemplatesReady",()=>this.onTemplateReady()),this.schedulerService.attachEvent("onBeforeViewChange",(n,o,a,c)=>{if(Object.isExists(o)&&Object.isExists(n)&&(!r.C_1.isSameDay(o,c)||n!==a)){let p;return p="month"===a?{type:a,periode:{dateDebut:r.C_1.getStartOfMonth(c),dateFin:r.C_1.getEndOfMonth(c)}}:{type:a,periode:r.C_1.getWeekPeriodForADay(c)},this.schedulerService.updateLoadMode(a),this.cdtUserService.selectPeriodeCDT(p),!1}return!0});const t=Object.isExists(this.schedulerConfig)?this.schedulerConfig.mode:void 0;this.schedulerService.schedulerCurrent.init(this.schedulerContainer.nativeElement,this.cdtUserService.cdtProf.periodeCDT.periode.dateDebut,t),this.schedulerService.updateLoadMode(t),this.cdtUserService.cdtProf.slots$.pipe((0,u.b)(n=>{!Array.isArray(n)||(this._slots=[...n],this.refreshDHTMLXDatas(!0))}),(0,v.R)(this.componentDestroyed$)).subscribe()}refreshDHTMLXDatas(t=!1){!Object.isExists(this.schedulerService.schedulerCurrent)||(t&&this.schedulerService.schedulerCurrent.clearAll(),Array.isArray(this._slots)&&this.schedulerService.schedulerCurrent.parse(JSON.parse(JSON.stringify(this._slots.filter(n=>r.FSr.isNotEmptyString(n.start_date)))),"json"))}displayModalSlot(t){const n={slot:t,parametrage:this.parametrage},o={id:this.modalService.getModalsCount()+1,initialState:n,class:"modal-lg",providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(zo,o)}onTemplateReady(){this.schedulerService.schedulerCurrent.templates.event_text=this.schedulerService.renderEventText.bind(this.schedulerService),this.schedulerService.schedulerCurrent.templates.event_bar_text=this.schedulerService.renderEventBarText.bind(this.schedulerService),this.schedulerService.schedulerCurrent.templates.event_header=this.schedulerService.renderEventHeader.bind(this.schedulerService),this.schedulerService.schedulerCurrent.templates.tooltip_text=this.schedulerService.renderTooltip.bind(this.schedulerService)}ngOnDestroy(){return this.schedulerService.cleanDatas(),this.schedulerService.schedulerCurrent=void 0,super.ngOnDestroy()}clickEventHandler(t,n){const o=new r.B5X(scheduler.getEvent(t));if(this.actionOnSelect.emit({evenement:o,e:n}),this.step=this.cdtUserService.correspondanceClasseNeeded(o)?1:2,this.cdtUserService.selectSlot(o),this.matiereNeeded=this.cdtUserService.correspondanceMatiereNeeded(o),this.cdtUserService.correspondanceNeeded(o)){this.findAllMatieres(o);const a={slot:o,allMatieres:this.allMatieres,step:this.step,matiereNeeded:this.matiereNeeded},c={id:this.modalService.getModalsCount()+1,initialState:a,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(we,c).content.onClose$.pipe((0,A.q)(1),(0,u.b)(h=>{h.reason===E.G.validation&&this.displayModalSlot(o)})).subscribe()}else this.displayModalSlot(o)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(g.tT),e.Y36(lr.G),e.Y36(m))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-edt-view"]],viewQuery:function(t,n){if(1&t&&e.Gf(ur,7),2&t){let o;e.iGM(o=e.CRH())&&(n.schedulerContainer=o.first)}},inputs:{schedulerConfig:"schedulerConfig",idUser:"idUser",typeUser:"typeUser",parametrage:"parametrage"},outputs:{actionOnSelect:"actionOnSelect"},features:[e.qOj],decls:27,vars:2,consts:[[1,"container-bg","double-padding","vue-emploidutemps"],[1,"dhx_cal_container","emploidutemps-global","emploidutemps-global-edt",2,"height","1062px","width","100%",3,"id"],["scheduler_cdt",""],[1,"dhx_cal_navline"],[1,"dhx_cal_prev_button"],[1,"dhx_cal_next_button"],[1,"dhx_cal_date"],["id","view-week","name","week_tab",1,"dhx_cal_tab","dhx_cal_tab_first",2,"right","140px"],["id","view-month","name","month_tab",1,"dhx_cal_tab",2,"right","76px"],[1,"dhx_cal_header"],[1,"dhx_cal_data"],["id","vue-edt-badges",1,"row"],[1,"col-lg-3","col-md-4"],[1,"float-start"],["aria-hidden","true",1,"badge","travail-a-faire"],[1,"fa","fa-check"],[1,"clearfix"],["aria-hidden","true",1,"badge","contenu-seance"],[1,"col-lg-4","col-md-5","offset-sm-1"],[4,"ngIf"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1,2)(3,"div",3)(4,"div",4),e._uU(5,"\xa0"),e.qZA(),e.TgZ(6,"div",5),e._uU(7,"\xa0"),e.qZA(),e._UZ(8,"div",6)(9,"div",7)(10,"div",8),e.qZA(),e._UZ(11,"div",9)(12,"div",10),e.qZA()(),e.TgZ(13,"div",11)(14,"div",12)(15,"div",13)(16,"span",14),e._UZ(17,"i",15),e.qZA(),e._uU(18," Travail \xe0 faire saisi "),e.qZA(),e._UZ(19,"span",16),e.TgZ(20,"div",13)(21,"span",17),e._UZ(22,"i",15),e.qZA(),e._uU(23," Contenu de s\xe9ance saisi "),e.qZA(),e._UZ(24,"span",16),e.qZA(),e.TgZ(25,"div",18),e.YNc(26,pr,1,0,"ed-connecteur-robert-dico-en-ligne",19),e.qZA()()),2&t&&(e.xp6(1),e.s9C("id","P_"+n.authStore.currentUser.id),e.xp6(25),e.Q6J("ngIf",n.authStore.currentUser.dicoEnLigneLeRobert))},dependencies:[l.O5,ue.C],changeDetection:0}),i})();function mr(i,s){if(1&i&&e._UZ(0,"ed-cdt-slots-list",8),2&i){const t=e.oxw();e.Q6J("classes",t.classes)}}function fr(i,s){if(1&i&&e._UZ(0,"ed-cdt-slots-list",8),2&i){const t=e.oxw();e.Q6J("classes",t.classes)}}function Cr(i,s){if(1&i&&e._UZ(0,"ed-cdt-menu",13),2&i){const t=e.oxw();e.Q6J("parametrage",t.parametrage)}}function hr(i,s){1&i&&e._UZ(0,"ed-connecteur-robert-dico-en-ligne")}const gr=function(i){return{"cdt-primaire":i}},vr=function(i,s){return{"col-xl order-2 order-xl-1":i,"col-xl-7 col-xxl-8":s}},br=function(i,s){return{"hidden-bloc":i,"offset-xl-1 offset-xxl-1":s}},Tr=function(i,s){return{"col-xl order-3":i,"col-xl-7 col-xxl-8":s}};let Ue=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o){super(),this.loaderService=t,this.cdtUserService=n,this.authStore=o,this.TYPES_VIEW=r.a7m,this.sideCDT=r.P2J}ngOnInit(){this.cdtUserService.cdtProf.selectedSlot$.pipe((0,u.b)(t=>{Object.isExists(t)&&(this._currentSlot=new r.B5X(t))}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.parametrage.isCDTPrimaire||Object.isExists(this.cdtUserService.cdtProf.periodeCDT)&&"month"!==this.cdtUserService.cdtProf.periodeCDT.type&&this.cdtUserService.selectPeriodeCDT({...this.cdtUserService.cdtProf.periodeCDT,type:"month",periode:{dateDebut:r.C_1.getStartOfMonth(this.cdtUserService.cdtProf.periodeCDT.periode.dateDebut),dateFin:r.C_1.getEndOfMonth(this.cdtUserService.cdtProf.periodeCDT.periode.dateFin)}})}isCurrentSlotModeEdit(t){return Object.isExists(this._currentSlot)&&Object.isExists(this._currentSlot[t])&&!0===this._currentSlot[t].modeEdit}onBeforeSlotUpdate(){this.loader=this.loaderService.show(this)}onAfterSlotUpdate(){this.loaderService.hide(this)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.S),e.Y36(m),e.Y36(r.CnD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-list-view"]],inputs:{classes:"classes",parametrage:"parametrage"},features:[e.qOj],decls:15,vars:30,consts:[[1,"container-tafaire","row","contenu-cdt-prof",3,"ngClass","ngBusy"],[1,"col-taf",3,"hidden","ngClass"],[3,"parametrage","side","typeViewCDT","afterSlotUpdate","beforeSlotUpdate"],[1,"col-slot-matieres","d-print-none","col-xl-4","col-xxl-3","g-0","order-1","order-xl-2",3,"ngClass"],[1,"cover",3,"hidden"],[1,"content-slot","card","ed-card","mt-0"],[1,"card-body"],[3,"classes",4,"ngIf"],[3,"classes"],[3,"parametrage",4,"ngIf"],[1,"margin-bottom"],[4,"ngIf"],[1,"order-xl-3","col-seance",3,"hidden","ngClass"],[3,"parametrage"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ed-cdt-taf-seance",2),e.NdJ("afterSlotUpdate",function(){return n.onAfterSlotUpdate()})("beforeSlotUpdate",function(){return n.onBeforeSlotUpdate()}),e.qZA()(),e.TgZ(3,"div",3),e._UZ(4,"div",4),e.TgZ(5,"div",5)(6,"div",6),e.YNc(7,mr,1,1,"ed-cdt-slots-list",7),e._UZ(8,"ed-cdt-filtres",8),e.YNc(9,fr,1,1,"ed-cdt-slots-list",7),e.YNc(10,Cr,1,1,"ed-cdt-menu",9),e.TgZ(11,"div",10),e.YNc(12,hr,1,0,"ed-connecteur-robert-dico-en-ligne",11),e.qZA()()()(),e.TgZ(13,"div",12)(14,"ed-cdt-taf-seance",2),e.NdJ("afterSlotUpdate",function(){return n.onAfterSlotUpdate()})("beforeSlotUpdate",function(){return n.onBeforeSlotUpdate()}),e.qZA()()()),2&t&&(e.Q6J("ngClass",e.VKq(19,gr,n.parametrage.isCDTPrimaire))("ngBusy",n.loader),e.xp6(1),e.Q6J("hidden",n.isCurrentSlotModeEdit(n.sideCDT.SEANCE))("ngClass",e.WLB(21,vr,!n.isCurrentSlotModeEdit(n.sideCDT.AFAIRE),n.isCurrentSlotModeEdit(n.sideCDT.AFAIRE))),e.xp6(1),e.Q6J("parametrage",n.parametrage)("side",n.sideCDT.AFAIRE)("typeViewCDT",n.TYPES_VIEW.LIST),e.xp6(1),e.Q6J("ngClass",e.WLB(24,br,n.isCurrentSlotModeEdit(n.sideCDT.AFAIRE)||n.isCurrentSlotModeEdit(n.sideCDT.SEANCE),n.isCurrentSlotModeEdit(n.sideCDT.SEANCE))),e.xp6(1),e.Q6J("hidden",!n.isCurrentSlotModeEdit(n.sideCDT.AFAIRE)&&!n.isCurrentSlotModeEdit(n.sideCDT.SEANCE)),e.xp6(3),e.Q6J("ngIf",n.parametrage.edt),e.xp6(1),e.Q6J("classes",n.classes),e.xp6(1),e.Q6J("ngIf",!n.parametrage.edt),e.xp6(1),e.Q6J("ngIf",n.parametrage.isCDTPrimaire),e.xp6(2),e.Q6J("ngIf",n.authStore.currentUser.dicoEnLigneLeRobert),e.xp6(1),e.Q6J("hidden",n.isCurrentSlotModeEdit(n.sideCDT.AFAIRE))("ngClass",e.WLB(27,Tr,!n.isCurrentSlotModeEdit(n.sideCDT.SEANCE),n.isCurrentSlotModeEdit(n.sideCDT.SEANCE))),e.xp6(1),e.Q6J("parametrage",n.parametrage)("side",n.sideCDT.SEANCE)("typeViewCDT",n.TYPES_VIEW.LIST))},styles:[".contenu-cdt-prof.cdt-primaire[_ngcontent-%COMP%]   .content-slot[_ngcontent-%COMP%]{padding-top:10px}@media (max-width: 1199px){.contenu-cdt-prof[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0}.contenu-cdt-prof[_ngcontent-%COMP%] > div.col-taf[_ngcontent-%COMP%]{margin-top:70px}.contenu-cdt-prof[_ngcontent-%COMP%] > div.col-seance[_ngcontent-%COMP%]{margin-top:40px}.contenu-cdt-prof[_ngcontent-%COMP%] > div.col-slot-matieres.hidden-bloc[_ngcontent-%COMP%]{margin-top:50px}}"],changeDetection:0}),i})();var xr=d(60044);let Er=(()=>{class i{constructor(t,n,o){this.modalRef=t,this.cdtUserService=n,this.etablissementService=o}ngOnInit(){const t=this.cdtUserService.cdtProf.selectedSlot;Object.isExists(t)&&this.etablissementService.getClasseGroupeById(t.entityId,t.entityType).pipe((0,u.b)(n=>{this.entity=n,n.matieres.length>0&&(this.matiere=n.matieres.find(o=>o.code===t.matiereCode))})).subscribe()}close(){this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.UZ),e.Y36(m),e.Y36(r.Xmb))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-manuel-scolaire-modal"]],decls:7,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body","manuels-scolaires"],[3,"entity","matiere","isInModal"],[1,"modal-footer"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Manuels scolaires"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3),e._UZ(5,"ed-manuels-scolaires-prof",4),e.qZA(),e._UZ(6,"div",5)),2&t&&(e.xp6(5),e.Q6J("entity",n.entity)("matiere",n.matiere)("isInModal",!0))},dependencies:[xr.y],encapsulation:2}),i})();function yr(i,s){if(1&i&&(e.TgZ(0,"li")(1,"blockquote")(2,"a",6),e._UZ(3,"i",7),e._uU(4),e.qZA()()()),2&i){const t=s.$implicit,n=e.oxw();e.xp6(2),e.hYB("href","http://archivecdt.ecoledirecte.com/",t,"/",n.parametrage.ogecCrypte,"/",e.LSH),e.xp6(2),e.hij(" ",t," ")}}let Sr=(()=>{class i{constructor(t){this.modalRef=t}close(){this.modalRef.hide()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-archives-modal"]],inputs:{parametrage:"parametrage"},decls:12,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body","consult-archives"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"alert","alert-info"],["target","other",3,"href"],["aria-hidden","true",1,"fa","fa-archive"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Consultation des Archives"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3)(5,"h4"),e._uU(6,"Ann\xe9es Scolaires"),e.qZA(),e.TgZ(7,"ul"),e.YNc(8,yr,5,3,"li",4),e.ALo(9,"trackByProperty"),e.qZA(),e.TgZ(10,"div",5),e._uU(11,"Les archives sont mises \xe0 jour une fois par semaine"),e.qZA()()),2&t&&(e.xp6(8),e.Q6J("ngForOf",n.parametrage.archives)("ngForTrackBy",e.lcZ(9,2,"$index")))},dependencies:[l.sg,Z.$],encapsulation:2,changeDetection:0}),i})();var Mr=d(43422);function Dr(i,s){1&i&&(e.TgZ(0,"div",12),e._uU(1,"Vous n'avez actuellement aucun document"),e.qZA())}function Zr(i,s){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"th",13),e._uU(4,"Document"),e.qZA(),e.TgZ(5,"th",14),e._uU(6,"Taille"),e.qZA(),e.TgZ(7,"th",15),e._uU(8,"Emplacement"),e.qZA()())}function Ar(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"button",16),e.NdJ("click",function(){const a=e.CHM(t).item,c=e.oxw();return e.KtG(c.deleteFile(a))}),e._UZ(3,"i",17),e.qZA()(),e.TgZ(4,"td",18)(5,"button",19),e._uU(6),e.qZA()(),e.TgZ(7,"td",18),e._uU(8),e.ALo(9,"displaySize"),e.qZA(),e.TgZ(10,"td",20),e._uU(11),e.qZA()()}if(2&i){const t=s.item;e.xp6(5),e.Q6J("file",t),e.xp6(1),e.hij(" ",t.libelle," "),e.xp6(2),e.Oqu(e.xi3(9,4,t.taille,0)),e.xp6(3),e.Oqu(t.description)}}let wr=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h,k){super(),this.authStore=t,this.cd=n,this.cahierDeTexteStore=o,this.cahierDeTexteService=a,this.uiService=c,this.loaderService=p,this.modalRef=h,this.modalService=k,this.typeFichierTelechargement=r.Y9E,this.usage=0,this.thresholdConfig={},this.documents=[]}ngOnInit(){this.cahierDeTexteStore.select$().pipe((0,u.b)(t=>{const n=Object.getEntity(t,this.authStore.variantForCurrentUser);!Object.isExpired(n)&&Array.isArray(n.documents)&&(this.documents=[...n.documents],this.usage=this.documents.reduce((o,a)=>o+a.taille,0),this.thresholdConfig={},this.thresholdConfig[0]={color:"green"},this.thresholdConfig[`${Math.floor(this.parametrage.quota/3)}`]={color:"orange"},this.thresholdConfig[`${Math.floor(this.parametrage.quota/3*2)}`]={color:"red"})}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,v.R)(this.componentDestroyed$)).subscribe(),this.loader=this.loaderService.show(this),this.cahierDeTexteService.getDocuments().pipe((0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning"))).subscribe()}close(){this.modalRef.hide()}deleteFile(t){const n={id:this.modalService.getModalsCount()+1,initialState:{title:"Supprimer le document",message:`Confirmez-vous la suppression du document <b>${t.libelle}</b> ?`}};this.modalService.show(O.z,n),this.modalService.onHide.pipe((0,A.q)(1),(0,B.h)(o=>o===E.G.validation),(0,D.w)(o=>(this.loader=this.loaderService.show(this),this.cahierDeTexteService.deleteFile(t,new r.B5X,r.ce3.DOCUMENTS))),(0,u.b)(()=>{this.usage=this.documents.reduce((o,a)=>o+a.taille,0),this.uiService.notifyEvent(r.DOJ.genericSuccess,"Le document a bien \xe9t\xe9 supprim\xe9","Suppression d'un document","icon-ed_cahierdetexte")}),(0,f.K)(o=>this.uiService.notifyErrorThenEmpty(o,!0,"Erreur","fa fa-warning")),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(e.sBO),e.Y36(r.x1h),e.Y36(r.mYE),e.Y36(r.VLf),e.Y36(y.S),e.Y36(g.UZ),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-documents-modal"]],inputs:{parametrage:"parametrage"},features:[e.qOj],decls:19,vars:18,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],["class","jumbotron",4,"ngIf"],[3,"datas","pagination"],["edSmartTableHeaderTmp",""],["edSmartTableBodyTmp",""],[1,"modal-footer"],[1,"w-100"],["id","quota",1,"float-start","margin-bottom-20"],["type","semi",3,"value","size","thick","min","max","thresholds"],[1,"jumbotron"],["stSort","libelle",1,"sortable-header"],["stSort","taille",1,"sortable-header"],["stSort","description",1,"sortable-header"],["title","Supprimer","type","button",1,"btn","btn-danger-color",3,"click"],["aria-hidden","true",1,"fa","fa-trash","size-23"],[2,"vertical-align","middle","white-space","nowrap"],["edLightbox","","type","button",1,"btn","btn-link",3,"file"],[2,"vertical-align","middle"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Gestion de vos documents associ\xe9s aux cahiers de textes"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,Dr,2,0,"div",4),e.TgZ(6,"ed-smart-table",5),e.YNc(7,Zr,9,0,"ng-template",6),e.YNc(8,Ar,12,7,"ng-template",7),e.qZA()(),e.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"ngx-gauge",11)(13,"ngx-gauge-value"),e._uU(14),e.ALo(15,"displaySize"),e.qZA(),e.TgZ(16,"ngx-gauge-append"),e._uU(17),e.ALo(18,"displaySize"),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",0===n.documents.length),e.xp6(1),e.Q6J("datas",n.documents)("pagination",!1),e.xp6(6),e.Q6J("value",n.usage)("size",160)("thick",25)("min",0)("max",n.parametrage.quota)("thresholds",n.thresholdConfig),e.xp6(2),e.Oqu(e.xi3(15,12,n.usage,0)),e.xp6(3),e.hij("/ ",e.xi3(18,15,n.parametrage.quota,0),""))},dependencies:[l.O5,T.DC,me.L,fe.c,$.r,$.w,Y.EO,Y.yg,Y.b4,Mr.l,r.dYR],styles:["div#quota[_ngcontent-%COMP%]{width:200px;height:80px}div#quota[_ngcontent-%COMP%]   ngx-gauge-value[_ngcontent-%COMP%], div#quota[_ngcontent-%COMP%]   ngx-gauge-append[_ngcontent-%COMP%]{color:#b3b3b3}div#quota[_ngcontent-%COMP%]   ngx-gauge-value[_ngcontent-%COMP%]{font-size:.5em}div#quota[_ngcontent-%COMP%]   ngx-gauge-append[_ngcontent-%COMP%]{font-size:.6em}"]}),i})();function Ur(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",32)(1,"button",33),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.onSelectMatiere(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(1),e.s9C("title",t.code),e.xp6(1),e.Oqu(t.libelle)}}function Or(i,s){if(1&i&&(e.TgZ(0,"ul",30),e.YNc(1,Ur,3,2,"li",31),e.ALo(2,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.classeGroupeSelected.matieres)("ngForTrackBy",e.lcZ(2,2,"id"))}}function kr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset",24)(1,"strong",11),e._uU(2,"Classes/groupes"),e.qZA(),e.TgZ(3,"div",12)(4,"div",25)(5,"ed-select-entity",26),e.NdJ("entityChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectClasseGroupe(o))}),e.qZA()()(),e.TgZ(6,"strong",11),e._uU(7,"Mati\xe8res"),e.qZA(),e.TgZ(8,"div",12)(9,"div",27)(10,"button",28),e._uU(11),e.qZA(),e.YNc(12,Or,3,4,"ul",29),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("displayClasses",!0)("displayGroupes",!0)("displaySalles",!1)("entity",t.classeGroupeSelected)("displayAllClasses",!1),e.xp6(4),e.Q6J("isDisabled",!t.classeChoose),e.xp6(2),e.hij(" ",t.matiereSelected?t.matiereSelected.libelle:"Toutes les mati\xe8res"," ")}}const Pr=function(i){return{"has-error":i}};function Ir(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",34)(1,"strong",11),e._uU(2,"Que souhaitez-vous imprimer"),e.qZA(),e.TgZ(3,"div",12)(4,"div",13)(5,"input",35),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectTypeImpression(o))}),e.qZA(),e.TgZ(6,"label",36),e._uU(7),e.qZA()(),e.TgZ(8,"div",13)(9,"input",37),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectTypeImpression(o))}),e.qZA(),e.TgZ(10,"label",38),e._uU(11),e.qZA()(),e.TgZ(12,"div",13)(13,"input",39),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectTypeImpression(o))}),e.qZA(),e.TgZ(14,"label",40),e._uU(15),e.ALo(16,"displayNom"),e.qZA()()()()}if(2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(12,Pr,!t.paramImpr.typeImpression)),e.xp6(5),e.Q6J("disabled",!t.matiereCurrentSlot||!t.classeGroupeCurrentSlot)("ngModel",t.paramImpr.typeImpression),e.xp6(2),e.AsE(" Le Cahier de Textes de ",(null==t.matiereCurrentSlot?null:t.matiereCurrentSlot.libelle)||(null==t.matiereCurrentSlot?null:t.matiereCurrentSlot.code)||'"Ind\xe9fini"'," en ",(null==t.classeGroupeCurrentSlot?null:t.classeGroupeCurrentSlot.libelle)||(null==t.classeGroupeCurrentSlot?null:t.classeGroupeCurrentSlot.code)||'"Ind\xe9fini"'," "),e.xp6(2),e.Q6J("disabled",!t.classeGroupeCurrentSlot)("ngModel",t.paramImpr.typeImpression),e.xp6(2),e.hij(" Le Cahier de Textes des ",(null==t.classeGroupeCurrentSlot?null:t.classeGroupeCurrentSlot.libelle)||(null==t.classeGroupeCurrentSlot?null:t.classeGroupeCurrentSlot.code)||'"Ind\xe9fini"'," "),e.xp6(2),e.Q6J("ngModel",t.paramImpr.typeImpression),e.xp6(2),e.hij(" Le Cahier de Textes de ",e.lcZ(16,10,t.authStore.currentUser)," (toutes classes confondues) ")}}function Jr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",41)(1,"input",42,43),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectDate(o,"du"))}),e.qZA(),e.TgZ(3,"span",44)(4,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(2);return e.KtG(o.toggle())}),e._UZ(5,"i",46),e.qZA()()()}if(2&i){const t=e.MAs(2),n=e.oxw();e.xp6(1),e.Q6J("bsConfig",n.configDatePicker)("ngModel",n.paramImpr.du),e.xp6(3),e.uIk("aria-expanded",t.isOpen)}}function Fr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",41)(1,"input",47,48),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectDate(o,"au"))}),e.qZA(),e.TgZ(3,"span",44)(4,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(2);return e.KtG(o.toggle())}),e._UZ(5,"i",46),e.qZA()()()}if(2&i){const t=e.MAs(2),n=e.oxw();e.xp6(1),e.Q6J("bsConfig",n.configDatePicker)("ngModel",n.paramImpr.au),e.xp6(3),e.uIk("aria-expanded",t.isOpen)}}function Nr(i,s){1&i&&(e.TgZ(0,"div",49),e._uU(1,"La date de fin ne peut pas \xeatre avant la date de d\xe9but"),e.qZA())}let qr=(()=>{class i{constructor(t,n,o,a){this.authStore=t,this.modalRef=n,this.cdtUserService=o,this.etablissementService=a,this.isProfPrimaire=!1,this.apiExtension=w.sX.apiExtension,this.apiUri=(0,w.Je)(),this.configDatePicker={...w.gL,showTodayButton:!0,todayPosition:"center"},this.paramImpr={lienVersDocumentsJoints:!1,du:new Date,au:new Date,ressources:!1,afficherCommentaires:!1,idProf:this.authStore.currentUser.id,sautDePageParJour:0,typeImpression:"1"}}ngOnInit(){const t=this.cdtUserService.cdtProf.selectedSlot;let n=(0,U.of)(void 0);Object.isExists(t)&&(n=this.etablissementService.getClasseGroupeById(t.entityId,t.entityType).pipe((0,u.b)(o=>{this.classeGroupeSelected=o,this.classeGroupeCurrentSlot=new r.Mn7({code:t.entityCode,libelle:t.entityLibelle}),this.matiereCurrentSlot=new r.vcu({code:t.matiereCode,libelle:t.matiereLibelle})}))),n.pipe((0,u.b)(o=>{Object.isExists(t)&&""!==t.entityLibelle&&""!==t.matiereLibelle?Object.isExists(t)&&this.onSelectTypeImpression(""!==t.entityLibelle||""!==t.matiereLibelle?"1":"2"):this.onSelectTypeImpression("3"),!0===this.cdtUserService.cdtProf.parametrage.isCDTPrimaire&&this.onSelectTypeImpression("2")})).subscribe()}close(){this.modalRef.hide()}onSelectTypeImpression(t){switch(this.paramImpr.typeImpression=t,this.paramImpr.typeImpression){case"1":this.paramImpr.matiereCode=this.matiereCurrentSlot?.code,this.paramImpr.classeCode=this.classeGroupeCurrentSlot?.code;break;case"2":this.paramImpr.matiereCode=void 0,this.paramImpr.classeCode=this.classeGroupeCurrentSlot?.code;break;case"3":this.paramImpr.matiereCode=void 0,this.paramImpr.classeCode=void 0}}onSelectClasseGroupe(t){this.classeGroupeSelected=t instanceof r.Mn7?new r.Mn7(t):new r.zJg(t),this.classeGroupeCurrentSlot=t instanceof r.Mn7?new r.Mn7(t):new r.zJg(t),this.paramImpr.classeCode=t.code;const n=this.cdtUserService.cdtProf.selectedSlot;Object.isExists(n)&&n.entityType===t.typeEntity&&n.entityId===t.id?(this.matiereSelected=new r.vcu({code:n.matiereCode,libelle:n.matiereLibelle}),this.paramImpr.matiereCode=this.matiereSelected.code):(this.matiereSelected=void 0,this.paramImpr.matiereCode=void 0),this.matiereCurrentSlot=Object.isExists(this.matiereSelected)?this.matiereSelected:new r.vcu(this.matiereSelected),this.classeChoose=!0}onSelectMatiere(t){this.matiereSelected=new r.vcu(t),this.matiereCurrentSlot=new r.vcu(t),this.paramImpr.matiereCode=t.code}onSelectDate(t,n){t.setHours(0,0,0,0),this.paramImpr[n]=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(g.UZ),e.Y36(m),e.Y36(r.Xmb))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-impression-modal"]],inputs:{parametrage:"parametrage",isProfPrimaire:"isProfPrimaire"},decls:43,vars:14,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body","impression-cdt",3,"ngBusy"],["class","row",4,"ngIf"],["class","row mt-2",3,"ngClass",4,"ngIf"],[1,"row","mt-2"],["for","date-du",1,"form-label","col-lg-4","text-end"],["class","input-group col-lg-4 w-25",4,"ngIf"],["for","date-au",1,"form-label","col-lg-4","text-end"],["class","form-text text-danger text-center",4,"ngIf"],[1,"col-lg-4","text-end"],[1,"col-lg-8"],[1,"form-check"],["type","checkbox","name","checkboxes","id","checkSautPage","value","1",1,"form-check-input",3,"ngModel","ngModelChange"],["for","checkSautPage",1,"form-check-label","fw-normal"],["type","checkbox","name","checkboxes","id","checkAvecLiens","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],["for","checkAvecLiens",1,"form-check-label","fw-normal"],["type","checkbox","name","checkboxes","id","checkDisplayRessources","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],["for","checkDisplayRessources",1,"form-check-label","fw-normal"],["type","checkbox","name","checkboxes","id","checkDisplayComment","value","4",1,"form-check-input",3,"ngModel","ngModelChange"],["for","checkDisplayComment",1,"form-check-label","fw-normal"],["type","button","id","button2id","name","button2id",1,"btn","btn-danger",3,"click"],["id","button1id","type","button","name","button1id","edTelechargement","",1,"btn","btn-primary","float-end",3,"disabled","additionalData","url"],[1,"row"],[1,"btn-group","no-padding"],["placeholder","Toutes les classes",3,"displayClasses","displayGroupes","displaySalles","entity","displayAllClasses","entityChange"],["dropdown","",1,"btn-group","no-padding","w-25",3,"isDisabled"],["id","dropdownMatieres","type","button","dropdownToggle","","aria-controls","dropdown-matieres",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownMatieres","id","dropdown-matieres","class","dropdown-menu","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMatieres","id","dropdown-matieres","role","menu",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf","ngForTrackBy"],["role","menuitem"],["type","button",1,"dropdown-item",3,"title","click"],[1,"row","mt-2",3,"ngClass"],["type","radio","name","radios-0","id","btRadioCdtMatiere","value","1",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],["for","btRadioCdtMatiere",1,"form-check-label","fw-normal"],["type","radio","name","radios-1","id","btRadioClasse","value","2",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],["for","btRadioClasse",1,"form-check-label","fw-normal"],["type","radio","name","radios-2","id","btRadioCdtEnseigant","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],["for","btRadioCdtEnseigant",1,"form-check-label","fw-normal"],[1,"input-group","col-lg-4","w-25"],["type","text","id","date-du","name","date-du","bsDatepicker","",1,"form-control",3,"bsConfig","ngModel","ngModelChange"],["datePickerDateDu","bsDatepicker"],[1,"input-group-text","input-group-md","no-background"],["type","button",1,"btn","btn-secondary","no-background",3,"click"],["aria-hidden","true",1,"fa","fa-calendar"],["type","text","id","date-au","name","date-au","bsDatepicker","",1,"form-control",3,"bsConfig","ngModel","ngModelChange"],["datePickerDateAu","bsDatepicker"],[1,"form-text","text-danger","text-center"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Impression du cahier de textes"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3)(5,"form"),e.YNc(6,kr,13,7,"fieldset",4),e.TgZ(7,"fieldset"),e.YNc(8,Ir,17,14,"div",5),e.TgZ(9,"div",6)(10,"label",7),e._uU(11,"Du"),e.qZA(),e.YNc(12,Jr,6,3,"div",8),e.qZA(),e.TgZ(13,"div",6)(14,"label",9),e._uU(15,"Au"),e.qZA(),e.YNc(16,Fr,6,3,"div",8),e.qZA(),e.YNc(17,Nr,2,0,"div",10),e.TgZ(18,"div",6)(19,"strong",11),e._uU(20,"Options"),e.qZA(),e.TgZ(21,"div",12)(22,"div",13)(23,"input",14),e.NdJ("ngModelChange",function(a){return n.paramImpr.sautDePageParJour=a}),e.qZA(),e.TgZ(24,"label",15),e._uU(25,"Saut de page par jour"),e.qZA()(),e.TgZ(26,"div",13)(27,"input",16),e.NdJ("ngModelChange",function(a){return n.paramImpr.lienVersDocumentsJoints=a}),e.qZA(),e.TgZ(28,"label",17),e._uU(29,"Lien vers les documents joints"),e.qZA()(),e.TgZ(30,"div",13)(31,"input",18),e.NdJ("ngModelChange",function(a){return n.paramImpr.ressources=a}),e.qZA(),e.TgZ(32,"label",19),e._uU(33,"Afficher les ressources"),e.qZA()(),e.TgZ(34,"div",13)(35,"input",20),e.NdJ("ngModelChange",function(a){return n.paramImpr.afficherCommentaires=a}),e.qZA(),e.TgZ(36,"label",21),e._uU(37,"Afficher les commentaires"),e.qZA()()()(),e.TgZ(38,"div")(39,"button",22),e.NdJ("click",function(){return n.close()}),e._uU(40,"Annuler"),e.qZA(),e.TgZ(41,"button",23),e._uU(42," Valider "),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(2),e.Q6J("ngIf",!n.isProfPrimaire),e.xp6(2),e.Q6J("ngIf",!n.isProfPrimaire),e.xp6(4),e.Q6J("ngIf",n.paramImpr.du),e.xp6(4),e.Q6J("ngIf",n.paramImpr.au),e.xp6(1),e.Q6J("ngIf",n.paramImpr.du>n.paramImpr.au),e.xp6(6),e.Q6J("ngModel",n.paramImpr.sautDePageParJour),e.xp6(4),e.Q6J("ngModel",n.paramImpr.lienVersDocumentsJoints),e.xp6(4),e.Q6J("ngModel",n.paramImpr.ressources),e.xp6(4),e.Q6J("ngModel",n.paramImpr.afficherCommentaires),e.xp6(6),e.hYB("url","",n.apiUri,"/cahierdetexte/print",n.apiExtension,"?verbe=get"),e.Q6J("disabled",!n.paramImpr.typeImpression||!n.paramImpr.du||!n.paramImpr.au||n.paramImpr.du>n.paramImpr.au)("additionalData",n.paramImpr))},dependencies:[l.mk,l.sg,l.O5,_._Y,_.Fj,_.Wl,_._,_.JJ,_.JL,_.On,_.F,L.Np,L.Y5,M.Hz,M.Mq,M.TO,T.DC,re.x,le.h,r.$t3,Z.$],styles:["div.impression-cdt[_ngcontent-%COMP%]   div.btn-group[_ngcontent-%COMP%]{margin-bottom:5px}"],changeDetection:0}),i})();function Lr(i,s){1&i&&(e.TgZ(0,"div",7),e._uU(1," Vous n'avez effectu\xe9 aucune correspondance entre votre emploi du temps et votre saisie de note. "),e._UZ(2,"br"),e.qZA())}function Yr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",13)(2,"button",14),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.deleteCorrespondance(a,"classe"))}),e._UZ(3,"i",15),e.qZA()(),e.TgZ(4,"td",16)(5,"strong"),e._uU(6),e.qZA()(),e.TgZ(7,"td",16),e._uU(8,"correspond \xe0"),e.qZA(),e.TgZ(9,"td",13)(10,"strong"),e._uU(11),e.qZA()()()}if(2&i){const t=s.$implicit;e.xp6(6),e.AsE("",t.edt.classeLibelle," (code : ",t.edt.classeCode,")"),e.xp6(5),e.AsE("",t.note.classeLibelle," (code : ",t.note.classeCode," )")}}function Rr(i,s){if(1&i&&(e.TgZ(0,"div")(1,"h4",8),e._uU(2,"Sur les classes et les groupes"),e.qZA(),e.TgZ(3,"table",9)(4,"thead")(5,"tr")(6,"th"),e._uU(7,"\xa0"),e.qZA(),e.TgZ(8,"th",10),e._uU(9,"Dans votre emploi du temps"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"\xa0"),e.qZA(),e.TgZ(12,"th",11),e._uU(13,"Dans votre saisie de note"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,Yr,12,4,"tr",12),e.ALo(16,"trackByProperty"),e.qZA()()()),2&i){const t=e.oxw();e.xp6(15),e.Q6J("ngForOf",t.correspondancesClasses)("ngForTrackBy",e.lcZ(16,2,"id"))}}function Qr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",13)(2,"button",14),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.deleteCorrespondance(a,"matiere"))}),e._UZ(3,"i",15),e.qZA()(),e.TgZ(4,"td",16)(5,"strong"),e._uU(6),e.qZA()(),e.TgZ(7,"td",16),e._uU(8,"correspond \xe0"),e.qZA(),e.TgZ(9,"td",13)(10,"strong"),e._uU(11),e.qZA()()()}if(2&i){const t=s.$implicit;e.xp6(6),e.AsE("",t.edt.matiereLibelle," (code : ",t.edt.matiereCode,")"),e.xp6(5),e.AsE("",t.note.matiereLibelle," (code : ",t.note.matiereCode," )")}}function Vr(i,s){if(1&i&&(e.TgZ(0,"div")(1,"h4",8),e._uU(2,"Sur les mati\xe8res"),e.qZA(),e.TgZ(3,"table",9)(4,"thead")(5,"tr")(6,"th"),e._uU(7,"\xa0"),e.qZA(),e.TgZ(8,"th",10),e._uU(9,"Dans votre emploi du temps"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"\xa0"),e.qZA(),e.TgZ(12,"th",11),e._uU(13,"Dans votre saisie de note"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,Qr,12,4,"tr",12),e.ALo(16,"trackByProperty"),e.qZA()()()),2&i){const t=e.oxw();e.xp6(15),e.Q6J("ngForOf",t.correspondancesMatieres)("ngForTrackBy",e.lcZ(16,2,"id"))}}let Gr=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h){super(),this.cdtUserService=t,this.authStore=n,this.cahierDeTexteStore=o,this.uiService=a,this.cahierdetexteService=c,this.loaderService=p,this.modalRef=h,this.correspondancesMatieres=[],this.correspondancesClasses=[]}ngOnInit(){this.cahierDeTexteStore.select$().pipe((0,u.b)(t=>{const n=Object.getEntity(t,this.authStore.variantForCurrentUser);Object.isExpired(n)||(this.correspondancesClasses=[...n.correspondances.classes],this.correspondancesMatieres=[...n.correspondances.matieres])}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,v.R)(this.componentDestroyed$)).subscribe(),this.loader=this.loaderService.show(this),this.cahierdetexteService.loadCorrespondances().pipe((0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration des correspondances impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}close(){this.modalRef.hide()}deleteCorrespondance(t,n){this.loader=this.loaderService.show(this),this.cahierdetexteService.deleteCorrespondance(t,n).pipe((0,u.b)(()=>{t instanceof r.YJW?this.cdtUserService.cdtProf.correspondances.classes.edRemove(o=>o.id===t.id):this.cdtUserService.cdtProf.correspondances.matieres.edRemove(o=>o.id===t.id),this.uiService.notifyEvent(r.DOJ.genericSuccess,"La correspondance a bien \xe9t\xe9 supprim\xe9","Correspondance","fa fa-correspondance")}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"Suppression impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(r.CnD),e.Y36(r.x1h),e.Y36(r.VLf),e.Y36(r.mYE),e.Y36(y.S),e.Y36(g.UZ))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-correspondances-modal"]],features:[e.qOj],decls:9,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body",3,"ngBusy"],["class","jumbotron",4,"ngIf"],[4,"ngIf"],[1,"modal-footer"],[1,"jumbotron"],[1,"margin-bottom-10"],[1,"table","table-hover","ed-table"],[2,"white-space","nowrap"],[2,"width","100%"],[4,"ngFor","ngForOf","ngForTrackBy"],[2,"vertical-align","middle"],["title","Supprimer la correspondance","type","button",1,"btn","btn-danger-color",3,"click"],["aria-hidden","true",1,"fa","fa-trash","size-23"],[2,"vertical-align","middle","white-space","nowrap"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Vos correspondances Emploi du temps / Notes"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3),e.YNc(5,Lr,3,0,"div",4),e.YNc(6,Rr,17,4,"div",5),e.YNc(7,Vr,17,4,"div",5),e.qZA(),e._UZ(8,"div",6)),2&t&&(e.xp6(4),e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngIf",0===n.correspondancesMatieres.length&&0===n.correspondancesClasses.length),e.xp6(1),e.Q6J("ngIf",n.correspondancesClasses.length>0),e.xp6(1),e.Q6J("ngIf",n.correspondancesMatieres.length>0))},dependencies:[l.sg,l.O5,T.DC,Z.$],encapsulation:2,changeDetection:0}),i})();function Br(i,s){1&i&&(e.TgZ(0,"span",18),e._uU(1,"Veuillez saisir une valeur num\xe9rique"),e.qZA())}function jr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"strong",19),e._uU(2,"Type d'affichage du cahier de textes par d\xe9faut"),e.qZA(),e.TgZ(3,"div",20)(4,"div",21)(5,"input",22),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.tabParametresIndiv[a.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT].value=o)}),e.qZA(),e.TgZ(6,"label",23),e._uU(7,"Vue liste"),e.qZA()(),e.TgZ(8,"div",21)(9,"input",24),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.tabParametresIndiv[a.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT].value=o)}),e.qZA(),e.TgZ(10,"label",25),e._uU(11,"Vue Emploi du temps"),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(5),e.s9C("value",t.TYPES_VIEW_CDT.LIST),e.Q6J("ngModel",t.tabParametresIndiv[t.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT].value),e.xp6(4),e.s9C("value",t.TYPES_VIEW_CDT.EDT),e.Q6J("ngModel",t.tabParametresIndiv[t.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT].value)}}const $r=function(i){return{"has-error":i}};let Hr=(()=>{class i{constructor(t,n,o,a,c,p,h){this.uiService=t,this.loaderService=n,this.authStore=o,this.authService=a,this.modalRef=c,this.modalService=p,this.cdtUserService=h,this.TYPES_VIEW_CDT=r.a7m,this.CONST_PARAM_INDIV=r.IL,this.tabParametresIndiv={},this.parametrage=this.cdtUserService.cdtProf.parametrage,this.tabParametresIndiv[this.CONST_PARAM_INDIV.NB_JOURS_MAX_RENDU_DEVOIR]={value:"",path:this.CONST_PARAM_INDIV.NB_JOURS_MAX_RENDU_DEVOIR},this.parametrage.isCDTPrimaire||(this.tabParametresIndiv[this.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT]={value:"",path:this.CONST_PARAM_INDIV.TYPE_VIEW_CDT_DEFAUT})}ngOnInit(){this.refresh()}close(t){const n=Object.isExists(t)?E.G.validation:E.G.cancel;this.modalService.setDismissReason(n),this.modalRef.hide()}refresh(){Object.keys(this.tabParametresIndiv).forEach(t=>{this.tabParametresIndiv[t].value=this.authStore.currentUser.listParametresIndividuels(this.tabParametresIndiv[t].path)})}saveParametrage(){const t=[];Object.keys(this.tabParametresIndiv).forEach(n=>{t.push(this.authService.updateParametrageIndividuel(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id,this.tabParametresIndiv[n].path,this.tabParametresIndiv[n].value))}),this.loader=this.loaderService.show(this),(0,ye.D)(t).pipe((0,u.b)(n=>{this.uiService.notifyEvent(r.DOJ.genericSuccess,"Votre param\xe9trage a bien \xe9t\xe9 pris en compte","Param\xe9trage"),this.close(!0)}),(0,C.x)(()=>this.loaderService.hide(this)),(0,f.K)(n=>this.uiService.notifyErrorThenEmpty(n,!0,"Erreur","fa fa-warning"))).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.VLf),e.Y36(y.S),e.Y36(r.CnD),e.Y36(r.e80),e.Y36(g.UZ),e.Y36(g.tT),e.Y36(m))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-parametrage-modal"]],decls:24,vars:8,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Fermer cette fen\xeatre",1,"btn-close","d-print-none",3,"click"],[1,"modal-body"],["name","paramForm",3,"ngBusy"],["paramForm","ngForm"],[1,"row",3,"ngClass"],["for","nbJourRenduDevoirCDT",1,"col-4","col-form-label","text-start"],[1,"fw-normal","small"],[1,"col-3"],["name","nbJourRenduDevoirCDT","id","nbJourRenduDevoirCDT","type","text","pattern","[0-9][0-9]*",1,"form-control",3,"ngModel","ngModelChange"],["class","form-text text-danger",4,"ngIf"],[1,"clearfix","form-text","margin-top-10"],[4,"ngIf"],[1,"mt-3"],["id","btnSave","name","btnSave","type","button",1,"btn","btn-success","float-end",3,"disabled","click"],["id","btnCancel","name","btnCancel","type","button",1,"btn","btn-danger","float-start",3,"click"],[1,"clearfix"],[1,"form-text","text-danger"],[1,"texte-label","col-lg-6","col-form-label","text-start"],[1,"col-lg-3"],[1,"form-check"],["type","radio","name","choixTypeViewCDT","id","typeViewCDTList",1,"form-check-input",3,"value","ngModel","ngModelChange"],["for","typeViewCDTList",1,"form-check-label","fw-normal"],["type","radio","name","choixTypeViewCDT","id","typeViewCDTEDT",1,"form-check-input",3,"value","ngModel","ngModelChange"],["for","typeViewCDTEDT",1,"form-check-label","fw-normal"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"h3",1),e._uU(2,"Param\xe8trage de mon cahier de textes"),e.qZA(),e.TgZ(3,"button",2),e.NdJ("click",function(){return n.close()}),e.qZA()(),e.TgZ(4,"div",3)(5,"form",4,5)(7,"div",6)(8,"label",7),e._uU(9," D\xe9lai de rendu des devoirs "),e.TgZ(10,"span",8),e._uU(11,"(en jour)"),e.qZA()(),e.TgZ(12,"div",9)(13,"input",10),e.NdJ("ngModelChange",function(a){return n.tabParametresIndiv[n.CONST_PARAM_INDIV.NB_JOURS_MAX_RENDU_DEVOIR].value=a}),e.qZA(),e.YNc(14,Br,2,0,"span",11),e.qZA(),e.TgZ(15,"p",12),e._uU(16,"Il s'agit du nombre de jours suppl\xe9mentaires que vous donnez aux \xe9l\xe8ves pour rendre leur travail en retard"),e.qZA()(),e.YNc(17,jr,12,4,"div",13),e.TgZ(18,"div",14)(19,"button",15),e.NdJ("click",function(){return n.saveParametrage()}),e._uU(20,"Enregistrer"),e.qZA(),e.TgZ(21,"button",16),e.NdJ("click",function(){return n.close()}),e._uU(22,"Annuler"),e.qZA(),e._UZ(23,"div",17),e.qZA()()()),2&t){const o=e.MAs(6);e.xp6(5),e.Q6J("ngBusy",n.loader),e.xp6(2),e.Q6J("ngClass",e.VKq(6,$r,o.invalid)),e.xp6(6),e.Q6J("ngModel",n.tabParametresIndiv[n.CONST_PARAM_INDIV.NB_JOURS_MAX_RENDU_DEVOIR].value),e.xp6(1),e.Q6J("ngIf",o.invalid),e.xp6(3),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire),e.xp6(2),e.Q6J("disabled",o.invalid)}},dependencies:[l.mk,l.O5,_._Y,_.Fj,_._,_.JJ,_.JL,_.c5,_.On,_.F,T.DC],encapsulation:2}),i})();const Kr=["toggleMenuBurgerCdt"];function zr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",10)(1,"button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openManuels())}),e._UZ(2,"i",21),e.qZA()()}}function Wr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",10)(1,"button",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openArchives())}),e._UZ(2,"i",23),e.qZA()()}}function Xr(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",10)(1,"button",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openCorrespondances())}),e._UZ(2,"i",25),e.qZA()()}}function es(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",2,3)(2,"input",4),e.NdJ("change",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.isDisplayMenuBurger())}),e.qZA(),e.TgZ(3,"label",5)(4,"ul",6)(5,"li",7),e._UZ(6,"i",8)(7,"i",9),e.qZA(),e.TgZ(8,"li",10)(9,"button",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openRessources())}),e._UZ(10,"i",12),e.qZA()(),e.YNc(11,zr,3,0,"li",13),e.YNc(12,Wr,3,0,"li",13),e.TgZ(13,"li",10)(14,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openDocuments())}),e._UZ(15,"i",15),e.qZA()(),e.TgZ(16,"li",10)(17,"button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openPrint())}),e._UZ(18,"i",17),e.qZA()(),e.YNc(19,Xr,3,0,"li",13),e.TgZ(20,"li",10)(21,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openParametrage())}),e._UZ(22,"i",19),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",t.parametrage.manuel),e.xp6(1),e.Q6J("ngIf",t.parametrage.archives.length>0),e.xp6(7),e.Q6J("ngIf",t.parametrage.edt&&t.parametrage.correspondancesActives)}}function ts(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openManuels())}),e._UZ(1,"i",36),e.qZA()}}function is(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openArchives())}),e._UZ(1,"i",38),e.qZA()}}function ns(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",26),e.YNc(1,ts,2,0,"button",27),e.YNc(2,is,2,0,"button",28),e.TgZ(3,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openDocuments())}),e._UZ(4,"i",30),e.qZA(),e.TgZ(5,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openPrint())}),e._UZ(6,"i",32),e.qZA(),e.TgZ(7,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openParametrage())}),e._UZ(8,"i",34),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.parametrage.manuel),e.xp6(1),e.Q6J("ngIf",t.parametrage.archives.length>0)}}let Oe=(()=>{class i{constructor(t,n,o,a){this.modalService=t,this.cdtUserService=n,this.authStore=o,this.renderer=a,this.menuIsOpen=!1}openRessources(){const t={parametrage:this.parametrage,isCdtEleve:!1},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(Se,n),this.closeMenuBurger()}openManuels(){let t,n;Object.isExists(this.cdtUserService.cdtProf.selectedSlot)&&(t={libelle:this.cdtUserService.cdtProf.selectedSlot.entityLibelle,code:this.cdtUserService.cdtProf.selectedSlot.entityCode},n={libelle:this.cdtUserService.cdtProf.selectedSlot.matiereLibelle,code:this.cdtUserService.cdtProf.selectedSlot.matiereCode});const o={entity:t,matiere:n},a={id:this.modalService.getModalsCount()+1,initialState:o,class:"modal-xlg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(Er,a),this.closeMenuBurger()}openArchives(){const t={parametrage:this.parametrage},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0};this.modalService.show(Sr,n),this.closeMenuBurger()}openDocuments(){const t={parametrage:this.parametrage},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0};this.modalService.show(wr,n),this.closeMenuBurger()}openPrint(){const t={parametrage:this.parametrage,isProfPrimaire:this.parametrage.isCDTPrimaire},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(qr,n),this.closeMenuBurger()}openCorrespondances(){const t={parametrage:this.parametrage},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(Gr,n),this.closeMenuBurger()}openParametrage(){const t={parametrage:this.parametrage},n={id:this.modalService.getModalsCount()+1,initialState:t,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(Hr,n),this.closeMenuBurger(),this.modalService.onHide.pipe((0,A.q)(1),(0,u.b)(o=>{switch(o){case E.G.cancel:break;case E.G.validation:this.cdtUserService.cdtProf.selectView(this.authStore.currentUser.parametresIndividuels.typeViewCDTDefaut)}})).subscribe()}closeMenuBurger(){this.parametrage.isCDTPrimaire||Object.isExists(this.inputMenuBurger)&&this.inputMenuBurger.nativeElement.classList.contains("open")&&this.renderer.removeClass(this.inputMenuBurger.nativeElement,"open")}isDisplayMenuBurger(){Object.isExists(this.inputMenuBurger)&&!this.inputMenuBurger.nativeElement.classList.contains("open")?this.renderer.addClass(this.inputMenuBurger.nativeElement,"open"):this.renderer.removeClass(this.inputMenuBurger.nativeElement,"open")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.tT),e.Y36(m),e.Y36(r.CnD),e.Y36(e.Qsj))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-menu"]],viewQuery:function(t,n){if(1&t&&e.Gf(Kr,5),2&t){let o;e.iGM(o=e.CRH())&&(n.inputMenuBurger=o.first)}},inputs:{parametrage:"parametrage"},decls:3,vars:2,consts:[["class","burger-menu",4,"ngIf","ngIfElse"],["inlineCdtMenu",""],[1,"burger-menu"],["toggleMenuBurgerCdt",""],["type","checkbox","id","toggleMenuBurger",1,"form-check-input",3,"change"],["id","show-menu","for","toggleMenuBurger"],["role","menu"],["role","menuitem",1,"btn-burger"],["aria-label","Menu ouvert",1,"miniHeight","fa","fa-2x","fa-bars","toggleBtn","menuBtn"],["aria-label","Menu ferm\xe9",1,"miniHeight","fa","fa-2x","fa-minus","toggleBtn","closeBtn"],[1,"btn-burger"],["data-mfb-label","Ressources","aria-label","Ressources","type","button",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-database"],["class","btn-burger",4,"ngIf"],["data-mfb-label","Gestion de vos documents","aria-label","Gestion de vos documents",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-folder-open"],["data-mfb-label","Impression","aria-label","Impression",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-print"],["data-mfb-label","Param\xe9trage","aria-label","Param\xe9trage",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-gear"],["data-mfb-label","Manuels scolaires","aria-label","Manuels scolaires",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-book"],["data-mfb-label","Archives","aria-label","Archives",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-archive"],["data-mfb-label","Gestion de vos correspondances Emploi du temps/Notes","aria-label","Gestion de vos correspondances Emploi du temps/Notes",1,"btn","no-background","w-100",3,"click"],["aria-hidden","true",1,"miniHeight","fa","fa-2x","fa-arrows-h"],[1,"inline-menu","additional-btns","vertical-align","text-center"],["class","btn btn-primary d-print-none","type","button","title","Manuels scolaires",3,"click",4,"ngIf"],["class","btn btn-primary d-print-none margin-whitespace","type","button","title","Archives",3,"click",4,"ngIf"],["type","button","title","Gestion de vos documents",1,"btn","btn-primary","d-print-none","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-folder-open"],["type","button","title","Impression",1,"btn","btn-primary","d-print-none","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-print"],["type","button","title","Param\xe9trage",1,"btn","btn-primary","d-print-none","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-gear"],["type","button","title","Manuels scolaires",1,"btn","btn-primary","d-print-none",3,"click"],["aria-hidden","true",1,"fa","fa-book"],["type","button","title","Archives",1,"btn","btn-primary","d-print-none","margin-whitespace",3,"click"],["aria-hidden","true",1,"fa","fa-archive"]],template:function(t,n){if(1&t&&(e.YNc(0,es,23,3,"div",0),e.YNc(1,ns,9,2,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",!n.parametrage.isCDTPrimaire)("ngIfElse",o)}},dependencies:[l.O5],styles:['.burger-menu[_ngcontent-%COMP%]{margin-right:40px;margin-top:-55px}.burger-menu[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{color:#eceff1}.burger-menu[_ngcontent-%COMP%]   .menuBtn[_ngcontent-%COMP%]{position:absolute;transition:all .3s ease}.burger-menu[_ngcontent-%COMP%]   .closeBtn[_ngcontent-%COMP%]{position:absolute;transition:all .3s ease;transform:translateY(50px);opacity:0}.burger-menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:relative}.burger-menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{white-space:nowrap;position:absolute;top:30px;left:0}.burger-menu[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;height:56px}.burger-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:70px;margin-bottom:10px;overflow:hidden;cursor:pointer;background:#0f8fd1;display:flex;justify-content:center;align-items:center;box-shadow:0 0 4px #00000024,0 4px 8px #00000047;transition:all .3s cubic-bezier(.25,.8,.25,1)}.burger-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:hover   .fa[_ngcontent-%COMP%]{color:#000}.burger-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]   .miniHeight[_ngcontent-%COMP%]{font-size:18px}.burger-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]   [data-mfb-label][_ngcontent-%COMP%]:after{padding:4px 10px;border-radius:3px;color:#fffc;font-size:14px;font-weight:400;pointer-events:none;line-height:normal;top:50%;position:absolute;margin-top:-10px;content:attr(data-mfb-label);right:70px}.burger-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;display:none}.burger-menu[_ngcontent-%COMP%]:not(.open)   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:not(:first-child){display:none;transition:all .5s;transform:translateY(-100px) scale(0);opacity:0}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:not(:first-child){display:flex}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(2){transition-delay:.05s;top:70px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(3){transition-delay:.1s;top:140px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(4){transition-delay:.15s;top:210px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(5){transition-delay:.2s;top:280px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(6){transition-delay:.25s;top:350px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(7){transition-delay:.3s;top:420px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]:nth-child(8){transition-delay:.35s;top:490px;opacity:1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]   .menuBtn[_ngcontent-%COMP%]{transform:translateY(-50px);opacity:0}.burger-menu.open[_ngcontent-%COMP%]   #show-menu[_ngcontent-%COMP%]   .btn-burger[_ngcontent-%COMP%]   .closeBtn[_ngcontent-%COMP%]{transform:translateY(0);opacity:1}'],changeDetection:0}),i})();function os(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.hij("- ",t.currentSlot.matiereLibelle?t.currentSlot.matiereLibelle:t.currentSlot.matiereCode,"")}}function rs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"small",11)(2,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openCDTClasse())}),e._uU(3),e.qZA(),e.YNc(4,os,2,1,"span",4),e.qZA(),e._UZ(5,"small",11),e.TgZ(6,"small"),e._uU(7),e.ALo(8,"edDate"),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.MGl("title","Consulter le cahier de texte ",t.currentSlot.entityType===t.edTypeClasseGroupeEntity.CLASSE?"de la classe":"du groupe",""),e.xp6(1),e.hij(" ",t.currentSlot.entityLibelle," "),e.xp6(1),e.Q6J("ngIf",!t.parametrage.isCDTPrimaire),e.xp6(3),e.Oqu(e.xi3(8,4,t.currentSlot.date," - EEEE d LLLL"))}}const X=function(i){return{active:i}};function ss(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.setSelectedView(o.TYPES_VIEW.LIST))}),e._uU(2," Vue liste "),e.qZA(),e.TgZ(3,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.setSelectedView(o.TYPES_VIEW.EDT))}),e._uU(4," Vue Emploi du temps "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(2,X,t.selectedView===t.TYPES_VIEW.LIST)),e.xp6(2),e.Q6J("ngClass",e.VKq(4,X,t.selectedView!==t.TYPES_VIEW.LIST))}}function as(i,s){if(1&i&&e._UZ(0,"ed-cdt-menu",15),2&i){const t=e.oxw(2);e.Q6J("parametrage",t.parametrage)}}function cs(i,s){if(1&i&&(e.TgZ(0,"header",6)(1,"div")(2,"h2"),e._uU(3,"Cahier de textes"),e.qZA(),e.YNc(4,rs,9,7,"div",7),e.qZA(),e.TgZ(5,"div"),e.YNc(6,ss,5,6,"div",8),e.YNc(7,as,1,1,"ed-cdt-menu",9),e.qZA()()),2&i){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",t.currentSlot),e.xp6(2),e.Q6J("ngIf",t.parametrage.edt&&!t.parametrage.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",!t.isCallFromCDT&&!t.parametrage.isCDTPrimaire)}}function ds(i,s){1&i&&(e.TgZ(0,"div",16)(1,"h3"),e._uU(2,"Le cahier de texte ne peut pas \xeatre utilis\xe9 sans param\xe9trage de Charlemagne Note."),e.qZA()())}function ls(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tab",19),e.NdJ("selectTab",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.selectEntityCdtPrimaire(a))}),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw(2);e.s9C("heading",t.typeEntity===n.edTypeClasseGroupeEntity.CLASSE?"Classe enti\xe8re ("+t.code+")":t.libelle)}}function us(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div")(2,"tabset",17),e.YNc(3,ls,1,1,"tab",18),e.ALo(4,"trackByProperty"),e.qZA()()()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.classes)("ngForTrackBy",e.lcZ(4,2,"id"))}}function ps(i,s){if(1&i&&(e.TgZ(0,"div",23),e._UZ(1,"ed-cdt-list-view",24),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(3,X,t.selectedView===t.TYPES_VIEW.LIST)),e.xp6(1),e.Q6J("parametrage",t.parametrage)("classes",t.classes)}}function _s(i,s){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"ed-cdt-edt-view",25),e.qZA()),2&i){const t=e.oxw(2);e.Tol(e.VKq(4,X,t.selectedView===t.TYPES_VIEW.EDT)),e.xp6(1),e.Q6J("parametrage",t.parametrage)("schedulerConfig",t.schedulerConfig)}}const ms=function(i){return{"container-bg":i}};function fs(i,s){if(1&i&&(e.TgZ(0,"div",20),e.YNc(1,ps,2,5,"div",21),e.YNc(2,_s,2,6,"div",22),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,ms,t.parametrage.isCDTPrimaire)),e.xp6(1),e.Q6J("ngIf",t.selectedView===t.TYPES_VIEW.LIST&&t.classes.length>0),e.xp6(1),e.Q6J("ngIf",t.selectedView===t.TYPES_VIEW.EDT)}}const Cs=function(i,s){return{fromCDT:i,"cdt-primaire":s}};let ke=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c,p,h,k){super(),this.loaderService=t,this.uiService=n,this.authStore=o,this.cahierDeTexteStore=a,this.cahierdetexteService=c,this.cdtUserService=p,this.cd=h,this.modalService=k,this.isCallFromCDT=!1,this.selectedView=r.a7m.LIST,this.TYPES_VIEW=r.a7m,this.sideCDT=r.P2J,this.edTypeClasseGroupeEntity=r.JBS,this.schedulerConfig={mode:"week"},this._datePipe=new r.ifA,this.cdtUserService.initCdtEnseignant(),this.parametrage=this.cdtUserService.cdtProf.parametrage;const x=r.C_1.getDatesAnneeScolaire(new Date);this._dateDebutAnnee=x[0],this._dateFinAnnee=x[1]}get slots(){return this._slots}set slots(t){this._slots=r.d0N.sortDatas([...t],["date|asc","start_date|asc","entityCode|asc"]),this.cdtUserService.selectSlots(this._slots)}ngOnChanges(t){Object.isExists(t.selectedView)&&(this.skipViewParamIndiv=!0,this.setSelectedView(this.selectedView))}ngOnInit(){this.classes=this.cdtUserService.cdtProf.classesGroupes,this.parametrage.isCDTPrimaire&&this.cdtUserService.selectEntity(this.classes.find(t=>t.typeEntity===r.JBS.CLASSE)),this.cdtUserService.cdtProf.selectedSlot$.pipe((0,u.b)(t=>{this.currentSlot=Object.isExists(t)?new r.B5X(t):void 0,this.cd.detectChanges()}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cdtUserService.cdtProf.periodeCDT$.pipe((0,u.b)(t=>{this.updatePeriodeCDT(t)}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cdtUserService.cdtProf.filtre$.pipe((0,u.b)(t=>{this.onFiltreUpdated(t)}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cdtUserService.cdtProf.selectedView$.pipe((0,u.b)(t=>{this.skipViewParamIndiv||this.setSelectedView(t)}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cahierDeTexteStore.selectCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id).pipe((0,u.b)(t=>{!Array.isArray(t)||(Object.isExists(this._currentFiltre)?this.onFiltreUpdated(this._currentFiltre):this.slots=this.initDisplayedSlots(t),this.updateCurrentSlotFromSlots(),this.cd.markForCheck())}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cahierDeTexteStore.select$().pipe((0,u.b)(t=>{const n=Object.getEntity(t,this.authStore.variantForCurrentUser);Object.isExpired(n)||(this.cdtUserService.cdtProf.correspondances=new r.syW(n.correspondances))}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,v.R)(this.componentDestroyed$)).subscribe(),this.parametrage.correspondancesActives&&(this.loader=this.loaderService.show(this),this.cahierdetexteService.loadCorrespondances().pipe((0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration des correspondances impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe())}ngOnDestroy(){return this.isCallFromCDT||this.cdtUserService.resetCDTProf(),super.ngOnDestroy()}updateCurrentSlotFromSlots(){let t;Object.isExists(this.currentSlot)?t=r.a9d.getSlotByDateEntityMatiere(this.cahierDeTexteStore.getCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id),this.currentSlot.date,this.currentSlot.entityType,this.currentSlot.entityCode,this.currentSlot.matiereCode):this.parametrage.isCDTPrimaire&&(t=this.slots.find(n=>n.date===this._datePipe.transform(new Date,"y-MM-dd"))),Object.isExists(t)&&this.setCurrentSlot(t)}openCDTClasse(){if(!Object.isExists(this.currentSlot))return;const t={id:this.modalService.getModalsCount()+1,initialState:{title:"",injectComponentInputs:{idEntity:this.currentSlot.entityId,typeEntity:this.currentSlot.entityType},injectComponentClass:Ze},class:"modal-xlg",providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(R.z,t)}loadSlotsForPeriode(t){this.loader=this.loaderService.show(this),this.cahierdetexteService.loadSlots(this.authStore.currentUser.id,this.authStore.currentUser.typeCompte,this._datePipe.transform(t.periode.dateDebut,"y-MM-dd"),this._datePipe.transform(t.periode.dateFin,"y-MM-dd")).pipe((0,j.d)(null),(0,u.b)(n=>{let o;void 0!==n&&(o=this.cahierDeTexteStore.getCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id,t.periode),Object.isExists(this._currentFiltre)?this.onFiltreUpdated(this._currentFiltre):this.slots=this.initDisplayedSlots(o),this.updateCurrentSlotFromSlots())}),(0,f.K)(()=>(this.uiService.notifyEvent(r.DOJ.genericError,"R\xe9cup\xe9ration du cahier de texte impossible","Erreur"),b.E)),(0,C.x)(()=>this.loaderService.hide(this))).subscribe()}setSelectedView(t){this._currentFiltre=void 0,this.selectedView=t,this.cd.markForCheck()}setCurrentSlot(t){this.cdtUserService.selectSlot(t)}onFiltreUpdated(t){if(Object.isExists(t)&&Object.isExists(t.selectedDate)&&Object.isExists(this._currentFiltre?.selectedDate)&&!r.C_1.isSameDay(t.selectedDate,this._currentFiltre.selectedDate)&&(this._currentFiltre=new F(t),!r.C_1.isBetween(t.selectedDate,this.periodeCDT.periode.dateDebut,this.periodeCDT.periode.dateFin,!1))){const o={...this.periodeCDT};return o.daySelected=t.selectedDate,o.periode="month"===this.periodeCDT.type?{dateDebut:r.C_1.getStartOfMonth(t.selectedDate),dateFin:r.C_1.getEndOfMonth(t.selectedDate)}:{dateDebut:r.C_1.getMondayOfCurrentWeek(t.selectedDate),dateFin:r.C_1.getSundayOfCurrentWeek(t.selectedDate)},void this.cdtUserService.selectPeriodeCDT(o)}if(!Object.isExists(this.periodeCDT))return;this._currentFiltre=Object.isExists(t)?new F(t):void 0;const n=this.cahierDeTexteStore.getCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id,this.periodeCDT.periode);this.slots=Object.isExists(n)?this.initDisplayedSlots(n):[],this.parametrage.isCDTPrimaire&&Object.isExists(t)&&this.setCurrentSlot(this.slots.find(o=>t.selectedDateToString===o.date)),Object.isExists(t)&&Object.isExists(this.currentSlot)&&this.slots.indexOf(this.currentSlot)<0&&(t.entityCode&&this.currentSlot.entityCode!==t.entityCode||t.matiereCode&&this.currentSlot.matiereCode!==t.matiereCode||t.selectedDate&&this.currentSlot.date!==t.selectedDateToString)&&this.setCurrentSlot(void 0),1!==this.slots.length||this.parametrage.isCDTPrimaire?Object.isExists(t)&&0===this.slots.length&&t.entityCode&&t.matiereCode&&this.addNewSlotIfNecessary(t):this.setCurrentSlot(this.slots[0])}updatePeriodeCDT(t){if(Object.isExists(t)){this.periodeCDT=m.clonePeriodeCDT(t);const n=m.clonePeriodeCDT(t);if("month"===t.type){const o=new Date(t.periode.dateDebut),a=r.C_1.addNbMoisToDate(o,-1);n.periode.dateDebut=r.C_1.getMondayOfCurrentWeek(r.C_1.getStartOfMonth(a));const c=r.C_1.addNbMoisToDate(o,1);n.periode.dateFin=r.C_1.getSundayOfCurrentWeek(r.C_1.getEndOfMonth(c))}this.loadSlotsForPeriode(n),this.parametrage.isCDTPrimaire||this.setCurrentSlot(void 0)}else this.periodeCDT=void 0}addNewSlotIfNecessary(t){if((t.entityCode||t.matiereCode)&&(!Array.isArray(this.slots)||0===this.slots.length)){const n=this.cdtUserService.cdtProf.classesGroupes.find(a=>a.code===t.entityCode),o=new r.B5X;o.date=t.selectedDateToString||this._datePipe.transform(new Date,"yyyy-MM-dd"),o.entityCode=t.entityCode,o.entityType=n.typeEntity,o.entityLibelle=t.entityLibelle,o.entityId=t.entityId,o.niveaux=n.typeEntity===r.meW.CLASSE?n.niveaux:void 0,o.matiereCode=t.matiereCode,o.matiereLibelle=t.matiereLibelle,o.temporaire=!0,this.slots=[o],this.setCurrentSlot(o)}}selectEntityCdtPrimaire(t){this.cdtUserService.selectSlot(void 0),this.cdtUserService.selectEntity(t),this.onFiltreUpdated(new F({...this._currentFiltre,entityCode:t.code,entityType:t.typeEntity,entityLibelle:t.libelle}))}initPeriodeCdtPrimaire(t){const n=r.C_1.getDaysOfWeek(this.periodeCDT.periode.dateDebut),o=[];return Object.isExists(this.cdtUserService.cdtProf.selectedEntity)&&n.forEach(a=>{let c=t.find(p=>p.idCDT>0&&p.date===this._datePipe.transform(a,"y-MM-dd")&&p.entityType===this.cdtUserService.cdtProf.selectedEntity.typeEntity&&p.entityId===this.cdtUserService.cdtProf.selectedEntity.id);Object.isExists(c)||(c=this.initSlotPrimaire(a)),o.push(c)}),o}initSlotPrimaire(t){if(!Object.isExists(this.cdtUserService.cdtProf.selectedEntity))return;const n=new r.B5X;return n.date=this._datePipe.transform(t,"yyyy-MM-dd"),n.entityCode=this.cdtUserService.cdtProf.selectedEntity.code,n.entityType=this.cdtUserService.cdtProf.selectedEntity.typeEntity,n.entityId=this.cdtUserService.cdtProf.selectedEntity.id,n.entityLibelle=this.cdtUserService.cdtProf.selectedEntity.libelle,n.niveaux=this.cdtUserService.cdtProf.selectedEntity.typeEntity===r.meW.CLASSE?this.cdtUserService.cdtProf.selectedEntity.niveaux:void 0,n.matiereCode=r.JBS.CLASSE,n.temporaire=!0,n}initDisplayedSlots(t){let n;if(this.parametrage.isCDTPrimaire)n=this.initPeriodeCdtPrimaire(r.a9d.filterSlotsByPeriode(t,this.periodeCDT.periode));else if(Object.isExists(this._currentFiltre))n=m.filtrerSlots(t,this._currentFiltre);else{const o=m.clonePeriodeCDT(this.periodeCDT);if("month"===o.type){const a=new Date(o.periode.dateDebut);o.periode.dateDebut=r.C_1.getMondayOfCurrentWeek(r.C_1.getStartOfMonth(a)),o.periode.dateFin=r.C_1.getSundayOfCurrentWeek(r.C_1.getEndOfMonth(a))}n=r.a9d.filterSlotsByPeriode(t,o.periode)}return n}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y.S),e.Y36(r.VLf),e.Y36(r.CnD),e.Y36(r.x1h),e.Y36(r.mYE),e.Y36(m),e.Y36(e.sBO),e.Y36(g.tT))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-enseignant"]],inputs:{isCallFromCDT:"isCallFromCDT",selectedView:"selectedView"},features:[e.qOj,e.TTD],decls:7,vars:11,consts:[[1,"ed-cdt",3,"ngBusy"],[1,"double-padding","ed-container","cahierdetexteSaisie",3,"ngClass"],["class","entete-page",4,"ngIf"],["class","jumbotron jumbotron-danger",4,"ngIf"],[4,"ngIf"],["class","main-cdt",3,"ngClass",4,"ngIf"],[1,"entete-page"],["class","infos-cdt",4,"ngIf"],["class","choix-vue-cdt btn-group",4,"ngIf"],[3,"parametrage",4,"ngIf"],[1,"infos-cdt"],[1,"hidden-titre-CDT"],["type","button",1,"classe-nav","btn","btn-link",3,"title","click"],[1,"choix-vue-cdt","btn-group"],["type","button",1,"btn","btn-secondary",3,"ngClass","click"],[3,"parametrage"],[1,"jumbotron","jumbotron-danger"],[1,"nav-tabs-container-bg"],[3,"heading","selectTab",4,"ngFor","ngForOf","ngForTrackBy"],[3,"heading","selectTab"],[1,"main-cdt",3,"ngClass"],["class","container-bg mt-5",3,"ngClass",4,"ngIf"],[3,"class",4,"ngIf"],[1,"container-bg","mt-5",3,"ngClass"],[3,"parametrage","classes"],[3,"parametrage","schedulerConfig"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,cs,8,3,"header",2),e.YNc(3,ds,3,0,"div",3),e.YNc(4,us,5,4,"div",4),e.ALo(5,"async"),e.YNc(6,fs,3,5,"div",5),e.qZA()()),2&t&&(e.Q6J("ngBusy",n.loader),e.xp6(1),e.Q6J("ngClass",e.WLB(8,Cs,n.isCallFromCDT,n.parametrage.isCDTPrimaire)),e.xp6(1),e.Q6J("ngIf",!n.isCallFromCDT),e.xp6(1),e.Q6J("ngIf",0===n.classes.length),e.xp6(1),e.Q6J("ngIf",e.lcZ(5,6,n.parametrage.isCDTPrimaire&&n.classes.length>1&&n.cdtUserService.cdtProf.selectedEntity$)),e.xp6(2),e.Q6J("ngIf",n.slots))},dependencies:[l.mk,l.sg,l.O5,T.DC,W.wW,W.AH,_r,Ue,Oe,l.Ov,r.ifA,Z.$],styles:['.ed-cdt .hidden-bloc{opacity:.5}.ed-cdt .cahierdetexteSaisie ed-cdt-menu{z-index:10}.ed-cdt .cahierdetexteSaisie .infos-cdt{margin:0 0 0 15px;font-weight:700}.ed-cdt .cahierdetexteSaisie .infos-cdt:before{content:"["}.ed-cdt .cahierdetexteSaisie .infos-cdt:after{content:"]"}.ed-cdt .cahierdetexteSaisie .main-cdt{padding:0 0 40px}.ed-cdt .cahierdetexteSaisie .main-cdt .cover{position:absolute;height:100%;width:100%;z-index:20}.ed-cdt .cahierdetexteSaisie .entete-page{align-items:center;justify-content:space-between}.ed-cdt .cahierdetexteSaisie .entete-page>div{display:flex}.ed-cdt .cahierdetexteSaisie .entete-page>div:first-child{align-items:baseline}.ed-cdt .cahierdetexteSaisie .entete-page>div:last-child{align-items:flex-start}.ed-cdt .cahierdetexteSaisie.cdt-primaire .main-cdt{padding:60px 40px}.ed-cdt .cahierdetexteSaisie.cdt-primaire .entete-page{justify-content:normal}.ed-cdt .cahierdetexteSaisie .choix-vue-cdt{margin-right:30px}.ed-cdt .cahierdetexteSaisie .bloc-titre.travail .tafaire{margin-top:0;margin-bottom:20px;border:0;border-top:2px solid var(--travail-color)}.ed-cdt .cahierdetexteSaisie .bloc-titre.travail .tafaire+.date{margin-top:-10px;font-style:italic;font-weight:700}.ed-cdt .cahierdetexteSaisie .bloc-titre.contenu .cdeseance{margin-top:0;margin-bottom:20px;border:0;border-top:2px solid var(--contenu-color)}.ed-cdt .cahierdetexteSaisie #vue-edt-badges .badge.travail-a-faire{background-color:var(--travail-color)}.ed-cdt .cahierdetexteSaisie #vue-edt-badges .badge.contenu-seance{background-color:var(--contenu-color)}.ed-cdt .cahierdetexteSaisie .vue-emploidutemps .badge.travail-a-faire{background-color:var(--travail-color)}.ed-cdt .cahierdetexteSaisie .vue-emploidutemps .badge.contenu-seance{background-color:var(--contenu-color);border:1px solid #0a8abe}.ed-cdt .cahierdetexteSaisie.fromCDT,.ed-cdt .cahierdetexteSaisie.fromCDT .main-cdt{padding:0}.ed-cdt .cahierdetexteSaisie.fromCDT .main-cdt .vue-emploidutemps{box-shadow:none;padding:0;border:0 none}.ed-cdt .cahierdetexteSaisie #show-interrogations{padding:0;margin-left:5px}.ed-cdt .cahierdetexteSaisie [data-mfb-label]:after{background:rgba(0,0,0,.6)}.ed-cdt .col-semaine{position:relative;z-index:2;margin:-40px 0;min-width:400px}.ed-cdt .col-semaine .list-group{margin:0 -20px;border-bottom:3px solid var(--light-placeholder-color)}.ed-cdt .col-semaine .list-group .selected{background:var(--light-placeholder-color)}.ed-cdt .col-semaine .list-group-item{border:none;position:relative;padding:10px 40px;cursor:pointer}.ed-cdt .col-semaine .list-group-item:before{content:"";position:absolute;top:0;left:20px;right:20px;height:3px;background:var(--light-placeholder-color)}.ed-cdt .col-semaine .list-group-item span{font-weight:400;font-size:15px}.ed-cdt .col-semaine .list-group-item .pastille-ok{position:absolute;top:20px;width:15px;height:15px;border-radius:50px}.ed-cdt .col-semaine .list-group-item .pastille-ok.travail{left:40px;background:var(--travail-color)}.ed-cdt .col-semaine .list-group-item .pastille-ok.contenu{right:40px;background:var(--contenu-color)}.ed-cdt .contenu-cdt-prof{display:flex;min-height:calc(100% - 40px)}.ed-cdt .col-slot-matieres{position:relative;z-index:2;margin-top:-40px;margin-bottom:-40px}.ed-cdt .content-slot{min-height:100%;background:#fff}.ed-cdt .content-slot>.card-body{padding:1px 20px}.ed-cdt .content-slot .main{margin:10px 0}.ed-cdt .content-slot .seance .main{margin:20px 0}.ed-cdt .content-slot .ui-list-view-bordered{border:none}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell{border:none}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell:before{content:"";position:absolute;top:0;left:20px;right:20px;height:3px;background:var(--light-placeholder-color)}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content>*{position:relative;padding:10px 40px;cursor:pointer}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content>.selected{background:var(--light-placeholder-color)}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .date{font-weight:400;font-size:15px}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .libclasse{font-weight:700;font-size:11px;font-style:italic}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .libmatiere{font-size:11px}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .pastille-ok{position:absolute;top:20px;width:15px;height:15px;border-radius:50px}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .pastille-ok.travail{left:40px;background:var(--travail-color)}.ed-cdt .content-slot .ui-list-view-bordered>.ui-list-view-cell>.ui-list-view-cell-content .pastille-ok.contenu{right:40px;background:var(--contenu-color)}@media (max-width: 1199px){.ed-cdt .cahierdetexteSaisie .main-cdt>div.container-bg{box-shadow:none;border:0 none}}\n'],encapsulation:2,changeDetection:0}),i})();function hs(i,s){1&i&&e._UZ(0,"ed-cdt-enseignant")}function gs(i,s){if(1&i&&e._UZ(0,"ed-cdt-eleve",2),2&i){const t=e.oxw();e.Q6J("idEntity",t.idEntity)("typeEntity",t.typeEntity)}}const vs=[{path:"",component:(()=>{class i extends((0,r.kCV)()){constructor(t,n){super(),this.authStore=t,this.activatedRoute=n,this.isCdtProf=!1}ngOnInit(){this.activatedRoute.paramMap.pipe((0,u.b)(t=>{this.typeEntity=t.has("typeEntity")?t.has("idEleve")?r.meW.ELEVE:t.get("typeEntity"):this.authStore.currentUser.typeCompte,this.idEntity=t.has("idEntity")?t.has("idEleve")?+t.get("idEleve"):+t.get("idEntity"):this.authStore.currentUser.id,this.isCdtProf=this.authStore.isProfesseur()&&this.typeEntity===r.meW.ENSEIGNANT}),(0,v.R)(this.componentDestroyed$)).subscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(q.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt"]],features:[e.qOj],decls:2,vars:2,consts:[[4,"ngIf"],[3,"idEntity","typeEntity",4,"ngIf"],[3,"idEntity","typeEntity"]],template:function(t,n){1&t&&(e.YNc(0,hs,1,0,"ed-cdt-enseignant",0),e.YNc(1,gs,1,2,"ed-cdt-eleve",1)),2&t&&(e.Q6J("ngIf",n.isCdtProf),e.xp6(1),e.Q6J("ngIf",!n.isCdtProf))},dependencies:[l.O5,ke,Ze],encapsulation:2}),i})()}];let bs=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[q.Bz.forChild(vs),q.Bz]}),i})();function Ts(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ul",10)(1,"li",11)(2,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.toggleTypePeriode())}),e._uU(3),e.qZA()()()}if(2&i){const t=e.oxw(3);e.xp6(2),e.s9C("title",t.libelleSelectablePeriode),e.xp6(1),e.Oqu(t.libelleSelectablePeriode)}}function xs(i,s){if(1&i&&(e.TgZ(0,"div",7)(1,"button",8),e._uU(2),e.qZA(),e.YNc(3,Ts,4,2,"ul",9),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("isAnimated",!1),e.xp6(2),e.hij(" ",t.libelleCurrentPeriode," ")}}function Es(i,s){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.libelleCurrentPeriode)}}function ys(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"button",2),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.selectPreviousPeriode())}),e._UZ(2,"i",3),e.qZA(),e.YNc(3,xs,4,2,"div",4),e.YNc(4,Es,2,1,"ng-template",null,5,e.W1O),e.TgZ(6,"button",2),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.selectNextPeriode())}),e._UZ(7,"i",6),e.qZA()()}if(2&i){const t=e.MAs(5),n=e.oxw();e.xp6(1),e.Q6J("title",n.tooltipPreviousPeriode),e.xp6(2),e.Q6J("ngIf",n.enableToggleTypePeriode)("ngIfElse",t),e.xp6(3),e.Q6J("title",n.tooltipNextPeriode)}}let Pe=(()=>{class i extends((0,r.kCV)()){constructor(t,n){super(),this.cd=t,this.cdtUserService=n,this.enableToggleTypePeriode=!0,this._datePipe=new r.ifA}ngOnInit(){this.periodeCDT$=this.cdtUserService.cdtProf.periodeCDT$.pipe((0,u.b)(t=>{!Object.isExists(t)||(this._periodeCDT={...t},this.updateView())}))}updateView(){const t=new Date(this._periodeCDT.periode.dateDebut);if("month"===this._periodeCDT.type)this.libelleCurrentPeriode=this._datePipe.transform(t,"MMMM yyyy"),this.libelleSelectablePeriode=`Semaine ${r.C_1.getWeekNumber(t)}`,this.tooltipNextPeriode=this._datePipe.transform(r.C_1.addNbMoisToDate(t,1),"MMMM yyyy"),this.tooltipPreviousPeriode=this._datePipe.transform(r.C_1.addNbMoisToDate(t,-1),"MMMM yyyy");else{const n=r.C_1.getWeekNumber(t),o=new Date(this._periodeCDT.periode.dateDebut);o.setMonth(11),o.setDate(31);const a=r.C_1.getWeekNumber(o),c=new Date(this._periodeCDT.periode.dateDebut);c.setMonth(11),c.setDate(31),c.setFullYear(c.getFullYear()-1);const p=r.C_1.getWeekNumber(c);this.libelleCurrentPeriode=`Semaine ${n}`,this.libelleSelectablePeriode=this._datePipe.transform(this._periodeCDT.periode.dateDebut,"MMMM yyyy"),this.tooltipNextPeriode=`Semaine ${n+1>a?1:n+1}`,this.tooltipPreviousPeriode=`Semaine ${n-1<0?p:n-1}`}this.cd.markForCheck()}selectPreviousPeriode(){this.calculPeriode(-1),this.cdtUserService.selectPeriodeCDT(this._periodeCDT)}selectNextPeriode(){this.calculPeriode(1),this.cdtUserService.selectPeriodeCDT(this._periodeCDT)}calculPeriode(t=1){let n;"month"===this._periodeCDT.type?(n=r.C_1.addNbMoisToDate(this._periodeCDT.periode.dateDebut,t),this._periodeCDT={...this._periodeCDT,periode:{dateDebut:r.C_1.getStartOfMonth(n),dateFin:r.C_1.getEndOfMonth(n)}}):(n=r.C_1.addNbJourToDate(t<1?this._periodeCDT.periode.dateDebut:this._periodeCDT.periode.dateFin,t),this._periodeCDT={...this._periodeCDT,periode:r.C_1.getWeekPeriodForADay(n)}),this.updateView()}toggleTypePeriode(){!this.enableToggleTypePeriode||(this._periodeCDT={...this._periodeCDT,type:"month"===this._periodeCDT.type?"week":"month"},this.calculPeriode(0),this.cdtUserService.selectPeriodeCDT(this._periodeCDT))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(m))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-periode-selector"]],inputs:{enableToggleTypePeriode:"enableToggleTypePeriode"},features:[e.qOj],decls:2,vars:3,consts:[["class","text-center ed-cdt-periode-selector",4,"ngIf"],[1,"text-center","ed-cdt-periode-selector"],["type","button",1,"btn","border","border-0","btn-secondary","btn-fab","d-print-none",3,"title","click"],["aria-hidden","true",1,"fa","fa-chevron-left"],["class","btn-group","dropdown","",3,"isAnimated",4,"ngIf","ngIfElse"],["periodeReadOnly",""],["aria-hidden","true",1,"fa","fa-chevron-right"],["dropdown","",1,"btn-group",3,"isAnimated"],["id","dropdownMenuCdtPeriode","dropdownToggle","","aria-controls","dropdown-periode",1,"btn","btn-secondary","dropdown-toggle"],["class","dropdown-menu","aria-labelledby","dropdownMenuCdtPeriode","id","dropdown-periode","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuCdtPeriode","id","dropdown-periode","role","menu",1,"dropdown-menu"],["role","menuitem"],["type","button",1,"dropdown-item",3,"title","click"]],template:function(t,n){1&t&&(e.YNc(0,ys,8,4,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.periodeCDT$))},dependencies:[l.O5,M.Hz,M.Mq,M.TO,l.Ov],styles:[".ed-cdt-periode-selector[_ngcontent-%COMP%]{margin-top:5px;display:flex;justify-items:center;justify-content:space-between}.ed-cdt-periode-selector[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:8px 0 0;color:var(--search-color)}.ed-cdt-periode-selector[_ngcontent-%COMP%]   div[dropdown][_ngcontent-%COMP%]{width:calc(100% - 70px)}.ed-cdt-periode-selector[_ngcontent-%COMP%]   div[dropdown][_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;border-radius:0;text-align:center;text-transform:capitalize}.ed-cdt-periode-selector[_ngcontent-%COMP%]   div[dropdown][_ngcontent-%COMP%]   ul.dropdown-menu[_ngcontent-%COMP%]{width:100%;padding:0}.ed-cdt-periode-selector[_ngcontent-%COMP%]   div[dropdown][_ngcontent-%COMP%]   ul.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px}"],changeDetection:0}),i})();function Ss(i,s){1&i&&(e.TgZ(0,"h3"),e._uU(1,"Choisissez votre s\xe9ance"),e.qZA())}function Ms(i,s){if(1&i&&e._UZ(0,"ed-cdt-periode-selector",12),2&i){const t=e.oxw(2);e.Q6J("enableToggleTypePeriode",!t.parametrage.isCDTPrimaire)}}function Ds(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openEDT())}),e._UZ(1,"i",14),e._uU(2," Consulter l'emploi du temps "),e.qZA()}}function Zs(i,s){if(1&i&&(e.TgZ(0,"h3",15),e._uU(1),e.qZA()),2&i){const t=e.oxw().ngIf;e.xp6(1),e.Oqu(t?"Vos saisies":"Votre saisie")}}function As(i,s){1&i&&(e.TgZ(0,"small",27),e._UZ(1,"i",28),e.qZA())}function ws(i,s){1&i&&e._UZ(0,"div",29)}function Us(i,s){1&i&&e._UZ(0,"div",30)}const Ie=function(i){return{selected:i}},Os=function(){return[35,"..."]},ks=function(){return["35","..."]};function Ps(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.setCurrentSlot(a))}),e.TgZ(1,"strong",20),e._uU(2),e.ALo(3,"edDate"),e.YNc(4,As,2,0,"small",21),e.qZA(),e.YNc(5,ws,1,0,"div",22),e.YNc(6,Us,1,0,"div",23),e.TgZ(7,"div",24)(8,"span",25),e._uU(9),e.ALo(10,"truncate"),e.qZA(),e._UZ(11,"br"),e.TgZ(12,"span",26),e._uU(13),e.ALo(14,"truncate"),e.qZA()()()}if(2&i){const t=s.$implicit,n=e.oxw(3);e.Gre("btn btn-link slot_",t.date," text-center"),e.cQ8("id","slot_",t.date,"_",t.entityCode,"_",t.matiereCode,""),e.Q6J("ngClass",e.VKq(26,Ie,n.isCurrentSlot(t))),e.xp6(2),e.hij(" ",e.xi3(3,17,t.date,"EEEE d LLLL")," "),e.xp6(2),e.Q6J("ngIf",n.parametrage.edt&&!t.idCours),e.xp6(1),e.Q6J("ngIf",t.travailAFaire),e.xp6(1),e.Q6J("ngIf",t.contenuDeSeance),e.xp6(2),e.hYB("title","",t.entityLibelle," (",t.entityCode,")"),e.xp6(1),e.hij(" ",e.xi3(10,20,t.entityLibelle,e.DdM(28,Os))," "),e.xp6(3),e.hYB("title","",t.matiereLibelle," (",t.matiereCode,")"),e.xp6(1),e.hij(" ",t.matiereLibelle?t.matiereLibelle:e.xi3(14,23,t.matiereCode,e.DdM(29,ks))," ")}}function Is(i,s){if(1&i&&(e.TgZ(0,"virtual-scroller",16,17),e.YNc(2,Ps,15,30,"button",18),e.ALo(3,"trackByProperty"),e.qZA()),2&i){const t=e.MAs(1),n=e.oxw().ngIf;e.Q6J("items",n),e.xp6(2),e.Q6J("ngForOf",t.viewPortItems)("ngForTrackBy",e.lcZ(3,3,"$index"))}}function Js(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.scrollTo())}),e._UZ(1,"i",32),e.qZA()}}function Fs(i,s){1&i&&e._UZ(0,"div",29)}function Ns(i,s){1&i&&e._UZ(0,"div",30)}function qs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.setCurrentSlot(a))}),e.YNc(1,Fs,1,0,"div",22),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"edDate"),e.qZA(),e.YNc(5,Ns,1,0,"div",23),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw(3);e.Gre("list-group-item list-group-item-action slot_",t.date," btn text-center py-4 no-background"),e.Q6J("ngClass",e.VKq(10,Ie,n.isCurrentSlot(t))),e.xp6(1),e.Q6J("ngIf",t.travailAFaire),e.xp6(2),e.Oqu(e.xi3(4,7,t.date,"EEEE d LLLL")),e.xp6(2),e.Q6J("ngIf",t.contenuDeSeance)}}function Ls(i,s){if(1&i&&(e.TgZ(0,"ul",33),e.YNc(1,qs,6,12,"button",34),e.ALo(2,"trackByProperty"),e.qZA()),2&i){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",e.lcZ(2,2,"$index"))}}const Ys=function(i,s,t){return{"panel-default":i,"panel-primary":s,"cdt-primaire":t}};function Rs(i,s){if(1&i&&(e.TgZ(0,"div",1)(1,"div",2),e.YNc(2,Ss,2,0,"h3",3),e.YNc(3,Ms,1,1,"ed-cdt-periode-selector",4),e.YNc(4,Ds,3,0,"button",5),e.YNc(5,Zs,2,1,"h3",6),e.qZA(),e.TgZ(6,"div",7),e.YNc(7,Is,4,5,"virtual-scroller",8),e.YNc(8,Js,2,0,"button",9),e.YNc(9,Ls,3,4,"ng-template",null,10,e.W1O),e._UZ(11,"span",11),e.qZA()()),2&i){const t=e.MAs(10),n=e.oxw();e.Q6J("ngClass",e.kEZ(8,Ys,!n.parametrage.edt,n.parametrage.edt,n.parametrage.isCDTPrimaire)),e.xp6(2),e.Q6J("ngIf",n.parametrage.edt&&!n.parametrage.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",n.parametrage.edt),e.xp6(1),e.Q6J("ngIf",n.parametrage.edt&&!n.parametrage.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",!n.parametrage.edt&&!n.parametrage.isCDTPrimaire),e.xp6(2),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire)("ngIfElse",t),e.xp6(1),e.Q6J("ngIf",n.currentSlot&&!n.parametrage.isCDTPrimaire)}}let Qs=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a,c){super(),this.authStore=t,this.uiService=n,this.modalService=o,this.cdtUserService=a,this.cd=c,this._datePipe=new r.ifA,this.parametrage=this.cdtUserService.cdtProf.parametrage}ngOnInit(){this.slots$=this.cdtUserService.cdtProf.slots$.pipe((0,ne.U)(t=>{if(Array.isArray(t))return this._slots=[...t].edUniq(["date","entityCode","matiereCode","idCDT"]),this.scrollToToday(),this._slots})),this.cdtUserService.cdtProf.selectedSlot$.pipe((0,u.b)(t=>{Object.isExists(t)?(this.currentSlot=new r.B5X(t),this.parametrage.isCDTPrimaire||this.scrollTo()):this.currentSlot=void 0,this.cd.markForCheck()}),(0,v.R)(this.componentDestroyed$)).subscribe(),this.cdtUserService.cdtProf.selectedEntity$.pipe((0,u.b)(t=>{this._selectedEntity=t}),(0,v.R)(this.componentDestroyed$)).subscribe()}findAllMatieres(t){const n=this.cdtUserService.cdtProf.classesGroupes.find(o=>o.code===t.entityCode&&o.typeEntity===t.entityType);!Object.isExists(n)||(this.allMatieres=n.matieres)}ngAfterViewInit(){this.scrollToToday()}openEDT(){const t={id:this.modalService.getModalsCount()+1,initialState:{title:"Votre emploi du temps",injectComponentInputs:{isCallFromCDT:!0,selectedView:r.a7m.EDT},injectComponentClass:ke},providers:[{provide:m,useValue:this.cdtUserService}],class:"modal-xlg"};this.modalService.show(R.z,t)}setPeriodeCDT(t){this.cdtUserService.selectPeriodeCDT(t)}initSlotPrimaire(t){if(!Object.isExists(this._selectedEntity))return;const n=new r.B5X;return n.date=this._datePipe.transform(t,"yyyy-MM-dd"),n.entityCode=this._selectedEntity.code,n.entityType=this._selectedEntity.typeEntity,n.entityId=this._selectedEntity.id,n.entityLibelle=this._selectedEntity.libelle,n.niveaux=this._selectedEntity.typeEntity===r.meW.CLASSE?this._selectedEntity.niveaux:void 0,n.matiereCode=r.JBS.CLASSE,n.temporaire=!0,n}setCurrentSlotCDTPrimaire(t){!this.parametrage.isCDTPrimaire||!Object.isExists(this._selectedEntity)||this.setCurrentSlot(t.slot)}setCurrentSlot(t){if(this.cdtUserService.selectSlot(t),this.parametrage.isCDTPrimaire)this.cdtUserService.cdtProf.selectFiltre(new F({...this.cdtUserService.cdtProf.filtre,selectedDate:r.C_1.stringToDate(t.date)}));else if(this.findAllMatieres(t),this.step=this.cdtUserService.correspondanceClasseNeeded(t)?1:2,this.matiereNeeded=this.cdtUserService.correspondanceMatiereNeeded(t),this.cdtUserService.correspondanceNeeded(t)){const n={slot:t,allMatieres:this.allMatieres,step:this.step,matiereNeeded:this.matiereNeeded},o={id:this.modalService.getModalsCount()+1,initialState:n,class:"modal-lg",ignoreBackdropClick:!0,providers:[{provide:m,useValue:this.cdtUserService}]};this.modalService.show(we,o)}}scrollTo(t){if(this.parametrage.isCDTPrimaire||!Object.isExists(this.virtualScroller)||!Array.isArray(this._slots)||!Object.isExists(t)&&(t=this.currentSlot,!Object.isExists(t)))return;const n=r.a9d.getSlotIndexByDateEntityMatiere(this._slots,t.date,t.entityType,t.entityCode,t.matiereCode);n>-1&&this.virtualScroller.scrollToIndex(n,!0,0,300)}scrollToToday(){if(this.parametrage.isCDTPrimaire||!Object.isExists(this.virtualScroller))return;const t=this._datePipe.transform(new Date,"y-MM-dd"),n=this._slots.find(o=>o.date===t);Object.isExists(n)?this.scrollTo(n):this.virtualScroller.scrollToIndex(0,!0,0,0)}isCurrentSlot(t){return!(!Object.isExists(this.currentSlot)||!Object.isExists(t))&&this.currentSlot.entityCode===t.entityCode&&this.currentSlot.matiereCode===t.matiereCode&&this.currentSlot.date===t.date}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.CnD),e.Y36(r.VLf),e.Y36(g.tT),e.Y36(m),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-slots-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(I.Vw,5),2&t){let o;e.iGM(o=e.CRH())&&(n.virtualScroller=o.first)}},inputs:{classes:"classes"},features:[e.qOj],decls:2,vars:3,consts:[["class","seance ed-cdt-slots-list",3,"ngClass",4,"ngIf"],[1,"seance","ed-cdt-slots-list",3,"ngClass"],[1,"header"],[4,"ngIf"],[3,"enableToggleTypePeriode",4,"ngIf"],["class","btn btn-link d-print-none","type","button","title","Emploi du temps",3,"click",4,"ngIf"],["class","panel-title",4,"ngIf"],[1,"main"],["id","slots","class","ui-list-view-bordered text-center d-print-none",3,"items",4,"ngIf","ngIfElse"],["title","Se positionner sur le cahier de textes en cours","class","pull-right btn p-1","type","button",3,"click",4,"ngIf"],["listeJoursPrimaire",""],[1,"clearfix"],[3,"enableToggleTypePeriode"],["type","button","title","Emploi du temps",1,"btn","btn-link","d-print-none",3,"click"],["aria-hidden","true",1,"i-small","fa","fa-search"],[1,"panel-title"],["id","slots",1,"ui-list-view-bordered","text-center","d-print-none",3,"items"],["slotsScroll",""],[3,"ngClass","id","class","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngClass","id","click"],[1,"date"],["class","","title","Saisie hors emploi du temps",4,"ngIf"],["class","pastille-ok travail","title","Travail \xe0 faire saisi",4,"ngIf"],["class","pastille-ok contenu","title","Contenu de s\xe9ance saisi",4,"ngIf"],[1,"classe"],[1,"libclasse",3,"title"],[1,"libmatiere",3,"title"],["title","Saisie hors emploi du temps",1,""],["aria-hidden","true",1,"fa","fa-info-circle"],["title","Travail \xe0 faire saisi",1,"pastille-ok","travail"],["title","Contenu de s\xe9ance saisi",1,"pastille-ok","contenu"],["title","Se positionner sur le cahier de textes en cours","type","button",1,"pull-right","btn","p-1",3,"click"],["aria-hidden","true",1,"fa","fa-undo","btn-primary-color"],[1,"list-group"],["type","button",3,"class","ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",3,"ngClass","click"]],template:function(t,n){1&t&&(e.YNc(0,Rs,12,12,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.slots$))},dependencies:[l.mk,l.sg,l.O5,I.Vw,Pe,l.Ov,r.ifA,r.W70,Z.$],styles:['.ed-cdt-slots-list.cdt-primaire[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]:before, .ed-cdt-slots-list.cdt-primaire[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]:after{content:""}.ed-cdt-slots-list.panel-default[_ngcontent-%COMP%]   virtual-scroller[_ngcontent-%COMP%]{height:190px}.ed-cdt-slots-list.panel-primary[_ngcontent-%COMP%]   virtual-scroller[_ngcontent-%COMP%]{height:400px}.ed-cdt-slots-list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:20px 0 0;color:var(--search-color)}.ed-cdt-slots-list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--search-color)}.ed-cdt-slots-list[_ngcontent-%COMP%]   virtual-scroller[_ngcontent-%COMP%]{margin:0 -20px}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]{position:relative;padding:10px 40px;cursor:pointer;display:block;width:100%}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]:hover{text-decoration:none}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:20px;right:20px;height:3px;background:var(--light-placeholder-color)}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_].selected[_ngcontent-%COMP%]{background:var(--light-placeholder-color);margin-bottom:-3px}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-weight:400;font-size:15px}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .libclasse[_ngcontent-%COMP%]{font-weight:700;font-size:11px;font-style:italic}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .libmatiere[_ngcontent-%COMP%]{font-size:11px}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .pastille-ok[_ngcontent-%COMP%]{position:absolute;top:20px;width:15px;height:15px;border-radius:50px}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .pastille-ok.travail[_ngcontent-%COMP%]{left:40px;background:var(--travail-color)}.ed-cdt-slots-list[_ngcontent-%COMP%]   button[class*=slot_][_ngcontent-%COMP%]   .pastille-ok.contenu[_ngcontent-%COMP%]{right:40px;background:var(--contenu-color)}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]{margin:0}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]{border:0 none;height:60px;border-radius:0}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]:hover{text-decoration:none}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:400;font-size:15px}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]   .v-taf-saisie[_ngcontent-%COMP%]{color:#0f9d58;background-color:#fff}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]   .v-cr-saisie[_ngcontent-%COMP%]{color:#7db3d5;background-color:#fff}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   button.list-group-item[_ngcontent-%COMP%]   div.badge.ng-hide[_ngcontent-%COMP%]:not(.ng-hide-animate){display:block!important;visibility:hidden}.ed-cdt-slots-list[_ngcontent-%COMP%]   ul.list-group[_ngcontent-%COMP%]   li.list-group-item.selected[_ngcontent-%COMP%]{font-weight:700;background-color:#87e1ff99;color:red}'],changeDetection:0}),i})();function Vs(i,s){1&i&&(e.TgZ(0,"h3"),e._uU(1," Filtrer les s\xe9ances ou "),e._UZ(2,"br"),e._uU(3," Saisir hors emploi du temps "),e.qZA())}function Gs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.resetFilter())}),e._UZ(1,"i",14),e.qZA()}}function Bs(i,s){1&i&&(e.TgZ(0,"h3",15),e._uU(1,"S\xe9lectionnez une classe et une mati\xe8re"),e.qZA())}function js(i,s){if(1&i&&(e.TgZ(0,"div",9),e.YNc(1,Vs,4,0,"h3",10),e.YNc(2,Gs,2,0,"button",11),e.YNc(3,Bs,2,0,"h3",12),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.parametrage.edt),e.xp6(1),e.Q6J("ngIf",t.parametrage.edt),e.xp6(1),e.Q6J("ngIf",!t.parametrage.edt)}}function $s(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.resetClasseFilter())}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.cdtUserService.libelleToutesLesClasses," ")}}function Hs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.setClasseFilter(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(1),e.s9C("title",t.code),e.xp6(1),e.Oqu(t.libelle)}}const Je=function(){return["code|asc"]};function Ks(i,s){if(1&i&&(e.TgZ(0,"ul",19)(1,"li",20),e.YNc(2,$s,2,1,"button",21),e.qZA(),e.YNc(3,Hs,3,2,"li",22),e.ALo(4,"orderBy"),e.ALo(5,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",null==t.filtre?null:t.filtre.entityLibelle),e.xp6(1),e.Q6J("ngForOf",e.xi3(4,3,t.classes,e.DdM(8,Je)))("ngForTrackBy",e.lcZ(5,6,"code"))}}const zs=function(i){return{"filtre-to-use":i}};function Ws(i,s){if(1&i&&(e.TgZ(0,"div",16)(1,"button",17),e._uU(2),e.qZA(),e.YNc(3,Ks,6,9,"ul",18),e.qZA()),2&i){const t=e.oxw();e.Q6J("ngClass",e.VKq(4,zs,!(null!=t.filtre&&t.filtre.entityLibelle)&&(null==t.filtre?null:t.filtre.selectedDate)&&0===t.slots.length))("isAnimated",!1)("isOpen",t.isClasseOpen),e.xp6(2),e.hij(" ",(null==t.filtre?null:t.filtre.entityLibelle)||t.cdtUserService.libelleToutesLesClasses," ")}}function Xs(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",20)(1,"button",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.resetMatiereFilter())}),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(2),e.Oqu(t.cdtUserService.libelleToutesLesMatieres)}}function ea(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.setMatiereFilter(a))}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(1),e.s9C("title",t.code),e.xp6(1),e.Oqu(t.libelle)}}function ta(i,s){if(1&i&&(e.TgZ(0,"ul",28),e.YNc(1,Xs,3,1,"li",29),e.YNc(2,ea,3,2,"li",22),e.ALo(3,"orderBy"),e.ALo(4,"trackByProperty"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.filtre?null:t.filtre.matiereCode),e.xp6(1),e.Q6J("ngForOf",e.xi3(3,3,t.listMatieresOfClasse,e.DdM(8,Je)))("ngForTrackBy",e.lcZ(4,6,"code"))}}const ia=function(i,s){return{disabled:i,"filtre-to-use":s}};function na(i,s){if(1&i&&(e.TgZ(0,"div",25)(1,"button",26),e._uU(2),e.qZA(),e.YNc(3,ta,5,9,"ul",27),e.qZA()),2&i){const t=e.oxw();e.Q6J("isAnimated",!1)("isOpen",t.isMatiereOpen),e.xp6(1),e.Q6J("ngClass",e.WLB(4,ia,!(null!=t.filtre&&t.filtre.entityCode),(null==t.filtre?null:t.filtre.entityLibelle)&&(null==t.filtre?null:t.filtre.selectedDate)&&0===t.slots.length&&!(null!=t.filtre&&t.filtre.matiereCode))),e.xp6(1),e.hij(" ",(null==t.filtre?null:t.filtre.matiereLibelle)||t.cdtUserService.libelleToutesLesMatieres," ")}}function oa(i,s){if(1&i&&e._UZ(0,"ed-cdt-periode-selector",30),2&i){const t=e.oxw();e.Q6J("enableToggleTypePeriode",!t.parametrage.isCDTPrimaire)}}function ra(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"bs-datepicker-inline",31,32),e.NdJ("bsValueChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.setDateFilter(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("bsConfig",t.configDatePicker)("dateCustomClasses",t.daysCustomClasses)("bsValue",t.dateReferenceDatePicker)}}const sa=function(i,s){return{"panel-primary":i,"panel-default":s}},aa=function(i,s){return{"no-header":i,"date-selected":s}};let ca=(()=>{class i extends((0,r.kCV)()){constructor(t,n,o,a){super(),this.cdtUserService=t,this.cahierDeTexteStore=n,this.authStore=o,this.cd=a,this.isClasseOpen=!1,this.isMatiereOpen=!1,this.listMatieresOfClasse=[],this.dateReferenceDatePicker=void 0,this.isRedrawDatePicker=!1,this.daysCustomClasses=[],this._displayDatePicker$=new J.X(!1),this.displayDatePicker$=this._displayDatePicker$.asObservable(),this.configDatePicker={...w.gL,containerClass:"theme-ed disable-head-selection"}}ngOnInit(){this.parametrage=this.cdtUserService.cdtProf.parametrage,this.cdtUserService.cdtProf.periodeCDT$.pipe((0,D.w)(t=>{this.isRedrawDatePicker=!0;const n=new Date;return this.dateReferenceDatePicker=r.C_1.isBetween(n,t.periode.dateDebut,t.periode.dateFin)?n:new Date(t.periode.dateDebut),this.resetFilter(),this.cahierDeTexteStore.selectCahierDeTexte(this.authStore.currentUser.typeCompte,this.authStore.currentUser.id)}),(0,u.b)(t=>{!Array.isArray(t)||(this.slots=[...t],this.setDaysCustomClasses(),this.cd.detectChanges())}),(0,v.R)(this.componentDestroyed$)).subscribe()}setClasseFilter(t){this.filtre=new F({...this.filtre,matiereCode:void 0,matiereLibelle:void 0,entityCode:t.code,entityLibelle:t.libelle,entityType:t.typeEntity,entityId:t.id}),this.updateListMatieresOfClasse(t.code),this.updateFilter(),this.isClasseOpen=!1,this.setDaysCustomClasses()}setMatiereFilter(t){this.filtre=new F({...this.filtre,matiereCode:t.code,matiereLibelle:t.libelle}),this.updateFilter(),this.isMatiereOpen=!1,this.setDaysCustomClasses()}setDateFilter(t){this.isRedrawDatePicker||(this.filtre=Object.isExists(this.filtre?.selectedDate)&&r.C_1.isSameDay(t,this.filtre.selectedDate)?void 0:new F({...this.filtre,selectedDate:t}),this.updateFilter()),this.isRedrawDatePicker=!1}resetFilter(){this.filtre=void 0,this.listMatieresOfClasse=[],this.cdtUserService.cdtProf.selectFiltre(this.filtre),this.setDaysCustomClasses()}resetClasseFilter(){this.resetFilter(),this.isClasseOpen=!1}resetMatiereFilter(){this.filtre=new F({...this.filtre,matiereCode:void 0,matiereLibelle:void 0}),this.updateFilter(),this.isMatiereOpen=!1,this.setDaysCustomClasses()}updateListMatieresOfClasse(t){this.listMatieresOfClasse=""!==t?this.cdtUserService.listMatieresOfClasse(t):[]}updateFilter(){if(Object.isExists(this.filtre)&&""!==this.filtre.entityCode&&!r.FSr.isNotEmptyString(this.filtre.matiereCode)){const t=this.listMatieresOfClasse;1===t.length&&(this.filtre.matiereCode=t[0].code,this.filtre.matiereLibelle=t[0].libelle)}this.cdtUserService.cdtProf.selectFiltre(this.filtre)}setDaysCustomClasses(){!Array.isArray(this.slots)||(this.isRedrawDatePicker=!0,this._displayDatePicker$.next(!1),this.cd.detectChanges(),this.daysCustomClasses.length=0,m.filtrerSlots(this.slots,new F({...this.filtre,selectedDate:void 0})).filter(t=>t.travailAFaire||t.contenuDeSeance).forEach(t=>{this.daysCustomClasses.push({date:new Date(t.date),classes:["avec-slot"]})}),this._displayDatePicker$.next(!0))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(m),e.Y36(r.x1h),e.Y36(r.CnD),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ed-cdt-filtres"]],viewQuery:function(t,n){if(1&t&&e.Gf(L.nf,5),2&t){let o;e.iGM(o=e.CRH())&&(n.datepicker=o.first)}},inputs:{classes:"classes"},features:[e.qOj],decls:10,vars:15,consts:[[1,"ed-cdt-filtres"],[1,"filtres",3,"ngClass"],["class","header",4,"ngIf"],[1,"main"],["class","btn-group select-classe","dropdown","",3,"ngClass","isAnimated","isOpen",4,"ngIf"],["class","btn-group select-matiere","dropdown","",3,"isAnimated","isOpen",4,"ngIf"],[3,"enableToggleTypePeriode",4,"ngIf"],[1,"cdt-calendrier",3,"ngClass"],[3,"bsConfig","dateCustomClasses","bsValue","bsValueChange",4,"ngIf"],[1,"header"],[4,"ngIf"],["class","btn btn-primary-color margin-top-10","title","Remise \xe0 z\xe9ro des filtres","type","button",3,"click",4,"ngIf"],["class","panel-title selection-sans-edt",4,"ngIf"],["title","Remise \xe0 z\xe9ro des filtres","type","button",1,"btn","btn-primary-color","margin-top-10",3,"click"],["aria-hidden","true",1,"fa","fa-eraser"],[1,"panel-title","selection-sans-edt"],["dropdown","",1,"btn-group","select-classe",3,"ngClass","isAnimated","isOpen"],["dropdownToggle","","id","dropdownMenuCdtFiltreClasse","type","button","aria-controls","dropdown-cdt-classe",1,"btn","btn-secondary","dropdown-toggle"],["class","dropdown-menu","aria-labelledby","dropdownMenuCdtFiltreClasse","id","dropdown-cdt-classe","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuCdtFiltreClasse","id","dropdown-cdt-classe","role","menu",1,"dropdown-menu"],["role","menutem"],["type","button","class","dropdown-item",3,"click",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"dropdown-item",3,"click"],["type","button",1,"dropdown-item",3,"title","click"],["dropdown","",1,"btn-group","select-matiere",3,"isAnimated","isOpen"],["id","dropdownMenuCdtFiltreMatiere","type","button","aria-controls","dropdown-cdt-matiere","dropdownToggle","",1,"btn","btn-secondary","normal",3,"ngClass"],["class","dropdown-menu","aria-labelledby","dropdownMenuCdtFiltreMatiere","id","dropdown-cdt-matiere","role","menu",4,"dropdownMenu"],["aria-labelledby","dropdownMenuCdtFiltreMatiere","id","dropdown-cdt-matiere","role","menu",1,"dropdown-menu"],["role","menutem",4,"ngIf"],[3,"enableToggleTypePeriode"],[3,"bsConfig","dateCustomClasses","bsValue","bsValueChange"],["datepicker",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,js,4,3,"div",2),e.TgZ(3,"div",3),e.YNc(4,Ws,4,6,"div",4),e.YNc(5,na,4,7,"div",5),e.YNc(6,oa,1,1,"ed-cdt-periode-selector",6),e.TgZ(7,"div",7),e.YNc(8,ra,2,3,"bs-datepicker-inline",8),e.ALo(9,"async"),e.qZA()()()()),2&t&&(e.xp6(1),e.Q6J("ngClass",e.WLB(9,sa,!n.parametrage.edt,n.parametrage.edt)),e.xp6(1),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire),e.xp6(2),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",!n.parametrage.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",!n.parametrage.edt),e.xp6(1),e.Q6J("ngClass",e.WLB(12,aa,!n.parametrage.edt,n.filtre&&void 0!==n.filtre.selectedDate)),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,7,n.displayDatePicker$)))},dependencies:[l.mk,l.sg,l.O5,L.nf,M.Hz,M.Mq,M.TO,Pe,l.Ov,r.d0N,Z.$],styles:[".ed-cdt-filtres .btn-group{margin:0;width:100%}.ed-cdt-filtres .btn-group button{margin:4px 1px;width:100%;border-radius:0;text-align:center}.ed-cdt-filtres .select-classe ul.dropdown-menu{width:100%}.ed-cdt-filtres .cdt-calendrier{display:flex;justify-content:center}.ed-cdt-filtres .cdt-calendrier.no-header .bs-datepicker-head{display:none}.ed-cdt-filtres .cdt-calendrier:not(.date-selected) .bs-datepicker-body table td span.selected{background:none;color:inherit}.ed-cdt-filtres .cdt-calendrier:not(.date-selected) .bs-datepicker-body table td span.selected.avec-slot{background:#76bbe3;color:#fff}.ed-cdt-filtres h3.selection-sans-edt{margin:20px 0 0;color:var(--search-color)}.ed-cdt-filtres .header h3{margin-top:30px}\n"],encapsulation:2,changeDetection:0}),i})();var da=d(66273);let la=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[m],imports:[ee.m,bs,P.S,Y.ez,N.m,V.m,te.Q,I.Lr,da.n]}),i})();e.B6R(Ue,[l.mk,l.O5,T.DC,ue.C,xe,Qs,ca,Oe],[])}}]);