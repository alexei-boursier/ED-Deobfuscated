"use strict";(self.webpackChunked_web=self.webpackChunked_web||[]).push([[9415],{51614:(T,b,o)=>{o.d(b,{Y:()=>M});var e=o(94650),m=o(36895),E=o(34141),h=o(4602);function l(s,d){1&s&&e.GkF(0)}function f(s,d){if(1&s&&(e.TgZ(0,"a",3),e.YNc(1,l,1,0,"ng-container",4),e.qZA()),2&s){const u=e.oxw(),g=e.MAs(3);e.s9C("href",u.manuel.url,e.LSH),e.xp6(1),e.Q6J("ngTemplateOutlet",g)}}function C(s,d){1&s&&e.GkF(0)}const y=function(s){return{ogec:s}};function S(s,d){if(1&s&&(e.TgZ(0,"a",5),e.YNc(1,C,1,0,"ng-container",4),e.qZA()),2&s){const u=e.oxw(),g=e.MAs(3);e.Q6J("href",u.manuel.url,e.LSH)("needAuth",u.manuel.isServeurCAS)("queryParams",e.VKq(4,y,u.manuel.ogec)),e.xp6(1),e.Q6J("ngTemplateOutlet",g)}}function r(s,d){if(1&s&&(e.TgZ(0,"p",13)(1,"small",14),e._uU(2),e.qZA()()),2&s){const u=d.$implicit;e.xp6(2),e.Oqu(u)}}function x(s,d){if(1&s&&(e.TgZ(0,"div",10)(1,"div")(2,"p",11),e._uU(3),e.qZA(),e.YNc(4,r,3,1,"p",12),e.ALo(5,"trackByProperty"),e.qZA()()),2&s){const u=e.oxw(2);e.xp6(3),e.Oqu(u.manuel.libelle),e.xp6(1),e.Q6J("ngForOf",u.manuel.disciplines)("ngForTrackBy",e.lcZ(5,3,"$index"))}}const A=function(s){return{"no-detail":s}};function _(s,d){if(1&s&&(e.TgZ(0,"div",6)(1,"div",7),e._UZ(2,"img",8),e.qZA(),e.YNc(3,x,6,5,"div",9),e.qZA()),2&s){const u=e.oxw();e.Q6J("ngClass",e.VKq(3,A,!u.showDetailManuel)),e.xp6(2),e.s9C("src",u.manuel.urlCouverture,e.LSH),e.xp6(1),e.Q6J("ngIf",u.showDetailManuel)}}let M=(()=>{class s{constructor(){this.showDetailManuel=!0}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ed-manuel-scolaire-link"]],inputs:{manuel:"manuel",showDetailManuel:"showDetailManuel"},decls:4,vars:2,consts:[["target","other","class","ed-manuel-scolaire-link",3,"href",4,"ngIf"],["edGoToService","","class","ed-manuel-scolaire-link",3,"href","needAuth","queryParams",4,"ngIf"],["cardManuel",""],["target","other",1,"ed-manuel-scolaire-link",3,"href"],[4,"ngTemplateOutlet"],["edGoToService","",1,"ed-manuel-scolaire-link",3,"href","needAuth","queryParams"],[1,"card",3,"ngClass"],[1,"card-header"],["alt","manuel scolaire",3,"src"],["class","card-body",4,"ngIf"],[1,"card-body"],[1,"card-title"],["class","card-text",4,"ngFor","ngForOf","ngForTrackBy"],[1,"card-text"],[1,"text-muted"]],template:function(u,g){1&u&&(e.YNc(0,f,2,2,"a",0),e.YNc(1,S,2,6,"a",1),e.YNc(2,_,4,5,"ng-template",null,2,e.W1O)),2&u&&(e.Q6J("ngIf",!g.manuel.isServeurCAS),e.xp6(1),e.Q6J("ngIf",g.manuel.isServeurCAS))},dependencies:[m.mk,m.sg,m.O5,m.tP,E.R,h.$],styles:[".ed-manuel-scolaire-link[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{height:176px;flex-direction:row;align-items:center}.ed-manuel-scolaire-link[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:none;border:0 none;padding:0}.ed-manuel-scolaire-link[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:130px;max-height:176px;padding:5px}.ed-manuel-scolaire-link[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{height:176px;overflow-y:auto}"],changeDetection:0}),s})()},7526:(T,b,o)=>{o.d(b,{c:()=>A});var e=o(45007),m=o(60515),E=o(54004),h=o(70262),l=o(94650),f=o(36895),C=o(80125),y=o(51614),S=o(4602);function r(_,M){if(1&_&&(l.TgZ(0,"div",4),l._UZ(1,"ed-manuel-scolaire-link",5),l.qZA()),2&_){const s=M.$implicit;l.xp6(1),l.Q6J("manuel",s)("showDetailManuel",!1)}}function x(_,M){if(1&_&&(l.TgZ(0,"div")(1,"div",2),l.YNc(2,r,2,2,"div",3),l.ALo(3,"trackByProperty"),l.qZA()()),2&_){const s=M.ngIf,d=l.oxw();l.Tol(d.customClass),l.xp6(2),l.Q6J("ngForOf",s)("ngForTrackBy",l.lcZ(3,5,"idRessource"))}}let A=(()=>{class _{constructor(s,d,u,g){this.manuelsNumeriquesStore=s,this.manuelsNumeriquesService=d,this.authStore=u,this.uiService=g,this.canauxMultimedia=!1,this.loadDatas=!0,this.customClass=""}ngOnChanges(s){if(s.idEntity?.previousValue!==s.idEntity?.currentValue||s.typeEntity?.previousValue!==s.typeEntity?.currentValue||s.cdtMatiere?.previousValue!==s.cdtMatiere?.currentValue){const d=e.$ej.edDBUserSpecificKey(this.authStore.currentUser.codeOgec,this.typeEntity,this.idEntity,["","D",0,"ALL",0]);this.manuels$=Object.isExists(this.cdtMatiere)?this.manuelsNumeriquesStore.selectListeManuelsNumeriquesByMatiere(d,this.cdtMatiere.codeMatiere):this.manuelsNumeriquesStore.selectListeManuelsNumeriques(d),this.manuels$=this.manuels$.pipe((0,E.U)(u=>u.filter(g=>g.isCanalMultimedia===this.canauxMultimedia))),this.loadDatas&&this.loadManuels()}}loadManuels(){let s=e.meW.ENSEIGNANT,d=this.authStore.currentUser.id;this.typeEntity!==e.meW.CLASSE&&this.typeEntity!==e.meW.GROUPE&&(s=e.meW.ELEVE,d=this.idEntity),this.loader=this.manuelsNumeriquesService.manuelsNumeriques(d,s).pipe((0,h.K)(u=>(this.uiService.notifyEvent(e.DOJ.genericError,"Une erreur est survenue lors de la r\xe9cup\xe9ration des manuels scolaires","Manuels scolaires"),m.E))).subscribe()}}return _.\u0275fac=function(s){return new(s||_)(l.Y36(e.Fh3),l.Y36(e.rP1),l.Y36(e.CnD),l.Y36(e.VLf))},_.\u0275cmp=l.Xpm({type:_,selectors:[["ed-manuels-scolaires-eleve"]],inputs:{idEntity:"idEntity",typeEntity:"typeEntity",cdtMatiere:"cdtMatiere",canauxMultimedia:"canauxMultimedia",loadDatas:"loadDatas",customClass:"customClass"},features:[l.TTD],decls:3,vars:4,consts:[[3,"ngBusy"],[3,"class",4,"ngIf"],[1,"my-3","row","row-cols-auto","gy-1","justify-content-center"],["class","col",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col"],[3,"manuel","showDetailManuel"]],template:function(s,d){1&s&&(l.TgZ(0,"div",0),l.YNc(1,x,4,7,"div",1),l.ALo(2,"async"),l.qZA()),2&s&&(l.Q6J("ngBusy",d.loader),l.xp6(1),l.Q6J("ngIf",l.lcZ(2,2,d.manuels$)))},dependencies:[f.sg,f.O5,C.DC,y.Y,f.Ov,S.$],encapsulation:2,changeDetection:0}),_})()},60044:(T,b,o)=>{o.d(b,{y:()=>te});var e=o(94650),m=o(36895),E=o(59241),h=o(34420),l=o(18505),f=o(70262),C=o(82722),y=o(46590),S=o(28746),r=o(45007),x=o(92635),A=o(80125),_=o(11822),M=o(51614),s=o(4602);function d(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"ed-manuel-scolaire-link",8),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("manuel",t)}}function u(n,a){1&n&&(e.TgZ(0,"div",9),e._uU(1,"Vous ne disposez actuellement d'aucun manuel"),e.qZA())}function g(n,a){if(1&n&&(e.ynx(0),e.YNc(1,d,2,1,"div",6),e.ALo(2,"trackByProperty"),e.YNc(3,u,2,0,"div",5),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.manuels.listeManuels)("ngForTrackBy",e.lcZ(2,3,"idRessource")),e.xp6(2),e.Q6J("ngIf",t.classeGroupeSelected&&(!t.manuels||0===t.manuels.listeManuels.length))}}function P(n,a){1&n&&(e.TgZ(0,"div",9),e._uU(1,"Veuillez s\xe9lectionner une classe"),e.qZA())}const w=function(n){return{"container-bg simple-padding":n}};let N=(()=>{class n extends((0,r.kCV)()){constructor(t,i,c,p,v,ne){super(),this.cd=t,this.loaderService=i,this.manuelsNumeriquesService=c,this.uiService=p,this.authStore=v,this.manuelsNumeriquesStore=ne,this.isOpenInModal=!1,this._variant=r.$ej.edDBUserSpecificKeyFromUser(this.authStore.currentUser)}ngOnInit(){this.manuelsNumeriquesStore.select$().pipe((0,l.b)(t=>{const i=Object.getEntity(t,this._variant);Object.isExpired(i)||(this.manuels=new r.yN1(i))}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,C.R)(this.componentDestroyed$)).subscribe(),Object.isExists(this.classeGroupeSelected)&&this.onSelectClasseGroupe(this.classeGroupeSelected)}onSelectClasseGroupe(t){this._variant=r.$ej.edDBUserSpecificKeyFromUser(this.authStore.currentUser,[t.code,"D",0,"ALL",0]);const i=this.manuelsNumeriquesService.manuelsNumeriques(this.authStore.currentUser.id,r.meW.ENSEIGNANT,t.code);this.loader=this.loaderService.show(this),this.cd.markForCheck(),i.pipe((0,y.d)((()=>Object.getEntity(this.manuelsNumeriquesStore.snapshot,this._variant))()),(0,l.b)(c=>{Object.isExpired(c)||(this.manuels=new r.yN1(c))}),(0,S.x)(()=>this.loaderService.hide(this)),(0,f.K)(c=>this.uiService.notifyErrorThenEmpty(c,!0,"Erreur","fa fa-warning"))).subscribe(),this.classeGroupeSelected=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(x.S),e.Y36(r.rP1),e.Y36(r.VLf),e.Y36(r.CnD),e.Y36(r.Fh3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ed-prof-vos-manuels-scolaires"]],inputs:{classeGroupeSelected:"classeGroupeSelected",isOpenInModal:"isOpenInModal"},features:[e.qOj],decls:6,vars:12,consts:[[3,"ngClass"],[1,"margin-top-10",3,"ngBusy"],["placeholder","S\xe9lectionnnez une classe",3,"displayClasses","displayClassesEtabsLibelle","displayGroupes","displaySalles","entity","displayAllClasses","entityChange"],[1,"my-3","row"],[4,"ngIf"],["class","jumbotron",4,"ngIf"],["class","col-lg-6 col-xl-5 col-xxl-3 gy-3",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-lg-6","col-xl-5","col-xxl-3","gy-3"],[3,"manuel"],[1,"jumbotron"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ed-select-entity",2),e.NdJ("entityChange",function(p){return i.onSelectClasseGroupe(p)}),e.qZA()(),e.TgZ(3,"div",3),e.YNc(4,g,4,5,"ng-container",4),e.YNc(5,P,2,0,"div",5),e.qZA()()),2&t&&(e.Q6J("ngClass",e.VKq(10,w,!i.isOpenInModal)),e.xp6(1),e.Q6J("ngBusy",i.loader),e.xp6(1),e.Q6J("displayClasses",!0)("displayClassesEtabsLibelle",!0)("displayGroupes",!0)("displaySalles",!1)("entity",i.classeGroupeSelected)("displayAllClasses",!1),e.xp6(2),e.Q6J("ngIf",i.manuels),e.xp6(1),e.Q6J("ngIf",!i.classeGroupeSelected))},dependencies:[m.mk,m.sg,m.O5,A.DC,_.h,M.Y,s.$],encapsulation:2,changeDetection:0}),n})();var U=o(4128),D=o(24006),Z=o(10137),O=o(59245);function I(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"input",9),e.NdJ("ngModelChange",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.showAllChanged())}),e.qZA(),e.TgZ(3,"label",10),e._uU(4,"Voir tous les manuels de l'\xe9tablissement"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngModel",t.showAll)}}function q(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"li",16)(1,"button",17),e.NdJ("click",function(){const p=e.CHM(t).$implicit,v=e.oxw(3);return e.KtG(v.onSelectMatiere(p))}),e._uU(2),e.qZA()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.libelle)}}function L(n,a){if(1&n&&(e.TgZ(0,"ul",14),e.YNc(1,q,3,1,"li",15),e.ALo(2,"trackByProperty"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.classeGroupeSelected.matieres)("ngForTrackBy",e.lcZ(2,2,"id"))}}function J(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"button",12),e._uU(2),e.qZA(),e.YNc(3,L,3,4,"ul",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("isDisabled",!t.classeChoose),e.xp6(2),e.hij(" ",t.matiereSelected?t.matiereSelected.libelle:"Choisir une mati\xe8re"," ")}}function k(n,a){if(1&n&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.manuelsProfAvailable.listeManuels.length)}}function G(n,a){1&n&&(e.TgZ(0,"div",33),e._uU(1,"Aucun manuel n'est disponible"),e.qZA())}function F(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",34)(1,"div",35)(2,"i",36),e._UZ(3,"img",37),e.qZA()(),e.TgZ(4,"div",38)(5,"input",39),e.NdJ("ngModelChange",function(){const p=e.CHM(t).$implicit,v=e.oxw(3);return e.KtG(v.updateAssociationProfManuel(p))}),e.qZA(),e.TgZ(6,"label",40),e._uU(7,"Mon manuel ?"),e.qZA()(),e.TgZ(8,"h4",41),e._uU(9),e.qZA()()}if(2&n){const t=a.$implicit;e.xp6(3),e.s9C("src",t.urlCouverture,e.LSH),e.s9C("title",t.libelle),e.xp6(2),e.MGl("id","manuel_",t.idRessource,""),e.Q6J("ngModel",t.affecte),e.xp6(1),e.MGl("for","manuel_",t.idRessource,""),e.xp6(3),e.Oqu(t.libelle)}}function B(n,a){if(1&n&&(e.TgZ(0,"accordion-group",21,22)(2,"div",23)(3,"div"),e._uU(4," ENSEIGNANT "),e.YNc(5,k,2,1,"span",24),e.qZA()(),e.TgZ(6,"div",25)(7,"div",26)(8,"span",27),e._uU(9,"S'il manque des r\xe9f\xe9rences, vous pouvez s\xe9lectionner \"Voir tous les manuels de l'\xe9tablissement\""),e.qZA()(),e.TgZ(10,"h3",28),e._uU(11,"Quels sont mes manuels scolaires ?"),e.qZA(),e.YNc(12,G,2,0,"div",29),e.TgZ(13,"div",30),e.YNc(14,F,10,6,"div",31),e.ALo(15,"trackByProperty"),e.qZA()()()),2&n){const t=e.oxw(2);e.Q6J("isOpen",!1),e.xp6(5),e.Q6J("ngIf",t.manuelsProfAvailable.listeManuels.length>0),e.xp6(7),e.Q6J("ngIf",0===t.manuelsProfAvailable.listeManuels.length),e.xp6(2),e.Q6J("ngForOf",t.manuelsProfAvailable.listeManuels)("ngForTrackBy",e.lcZ(15,5,"idRessource"))}}function Q(n,a){if(1&n&&(e.TgZ(0,"span",32),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.manuelsEleveAvailable.listeManuels.length)}}function Y(n,a){1&n&&(e.TgZ(0,"div",33),e._uU(1,"Aucun manuel n'est disponible"),e.qZA())}function K(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"div",50),e._uU(2),e.qZA(),e.TgZ(3,"div",51)(4,"label")(5,"input",52),e.NdJ("ngModelChange",function(c){const v=e.CHM(t).$implicit;return e.KtG(v.affecte=c)}),e.qZA()()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.nom),e.xp6(3),e.Q6J("ngModel",t.affecte)}}function j(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",48)(2,"div",49)(3,"div",50)(4,"strong"),e._uU(5,"Tous /Aucun"),e.qZA()(),e.TgZ(6,"div",51)(7,"label")(8,"input",52),e.NdJ("ngModelChange",function(){e.CHM(t);const c=e.oxw(5);return e.KtG(c.tousAucunEleves())}),e.qZA()()()(),e.YNc(9,K,6,2,"div",53),e.ALo(10,"trackByProperty"),e.qZA(),e.TgZ(11,"div",54)(12,"button",55),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(5);return e.KtG(c.closeListeEleve())}),e._uU(13,"Annuler"),e.qZA(),e.TgZ(14,"button",56),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(5);return e.KtG(c.updateAssociationElevesManuel(c.selectedManuelEleve))}),e._uU(15,"Enregistrer"),e.qZA()()()}if(2&n){const t=e.oxw(5);e.xp6(8),e.Q6J("ngModel",t.currentStateTousAucun),e.xp6(1),e.Q6J("ngForOf",t.listeEleves)("ngForTrackBy",e.lcZ(10,3,"id"))}}function $(n,a){if(1&n&&(e.ynx(0),e.YNc(1,j,16,5,"div",47),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.listeEleves.length>0&&i.selectedManuelEleve.idRessource===t.idRessource)}}function V(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",34)(1,"div",35)(2,"i",36),e._UZ(3,"img",37),e.qZA()(),e.TgZ(4,"div",44)(5,"button",45),e.NdJ("click",function(){const p=e.CHM(t).$implicit,v=e.oxw(3);return e.KtG(v.showEleves(p))}),e._UZ(6,"i",46),e.qZA()(),e.TgZ(7,"h4",41),e._uU(8),e.qZA(),e.YNc(9,$,2,1,"ng-container",47),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.s9C("src",t.urlCouverture,e.LSH),e.s9C("title",t.libelle),e.xp6(5),e.Oqu(t.libelle),e.xp6(1),e.Q6J("ngIf",i.listeEleves)}}function R(n,a){if(1&n&&(e.TgZ(0,"accordion-group",42,43)(2,"span",23)(3,"div"),e._uU(4," EL\xc8VES "),e.YNc(5,Q,2,1,"span",24),e.qZA()(),e.TgZ(6,"div",25)(7,"div",26)(8,"span",27),e._uU(9,"S'il manque des r\xe9f\xe9rences, vous pouvez s\xe9lectionner \"Voir tous les manuels de l'\xe9tablissement\""),e.qZA()(),e.TgZ(10,"h3",28),e._uU(11),e.qZA(),e.YNc(12,Y,2,0,"div",29),e.TgZ(13,"div",30),e.YNc(14,V,10,4,"div",31),e.ALo(15,"trackByProperty"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.manuelsEleveAvailable.listeManuels.length>0),e.xp6(6),e.AsE(" Quels sont les manuels scolaires de mes \xe9l\xe8ves de ",t.classeGroupeSelected.libelle," ",t.matiereSelected.libelle?"en "+t.matiereSelected.libelle:""," ? "),e.xp6(1),e.Q6J("ngIf",0===t.manuelsEleveAvailable.listeManuels.length),e.xp6(2),e.Q6J("ngForOf",t.manuelsEleveAvailable.listeManuels)("ngForTrackBy",e.lcZ(15,6,"idRessource"))}}function W(n,a){if(1&n&&(e.TgZ(0,"accordion",18),e.YNc(1,B,16,7,"accordion-group",19),e.YNc(2,R,16,8,"accordion-group",20),e.qZA()),2&n){const t=e.oxw();e.Q6J("closeOthers",t.oneAtATime),e.xp6(1),e.Q6J("ngIf",t.manuelsProfAvailable),e.xp6(1),e.Q6J("ngIf",t.manuelsEleveAvailable)}}const H=function(n){return{"container-bg simple-padding":n}};let z=(()=>{class n extends((0,r.kCV)()){constructor(t,i,c,p,v){super(),this.manuelsNumeriquesStore=t,this.uiService=i,this.loaderService=c,this.authStore=p,this.manuelsNumeriquesService=v,this.isOpenInModal=!1,this.classeChoose=!1,this.oneAtATime=!0,this.listeEleves=[],this.currentStateTousAucun=!1,this.isCDTPrimaire="1"===r.Kg5.getModuleParametre(r.qzA.CAHIER_DE_TEXTES,"isCDTPrimaire",this.authStore.currentUser),this.showAll=!1,this._variant=r.$ej.edDBUserSpecificKeyFromUser(this.authStore.currentUser)}ngOnInit(){this.manuelsNumeriquesStore.select$().pipe((0,l.b)(t=>{const i=Object.getEntity(t,this._variant);Object.isExpired(i)||(this.manuelsProfAvailable=new r.yN1(i));const c=Object.getEntity(t,this._variantEleve);Object.isExpired(c)||(this.manuelsEleveAvailable=new r.yN1(c))}),(0,f.K)(t=>this.uiService.notifyErrorThenEmpty(t,!0,"Erreur","fa fa-warning")),(0,C.R)(this.componentDestroyed$)).subscribe(),Object.isExists(this.classeGroupeSelected)&&this.onSelectClasseGroupe(this.classeGroupeSelected)}isShowAllEnable(){return this.classeChoose&&Object.isExists(this.matiereSelected)}showAllChanged(){this.showAll=!this.showAll,this.getManuelsProfOrEleveAvalaible(!0)}onSelectClasseGroupe(t){let i;this.classeGroupeSelected=t,this.classeChoose=!0,Object.isExists(this.matiereSelected)&&(i=t.matieres.find(c=>c.code===this.matiereSelected.code)),Object.isExists(i)?this.onSelectMatiere(i):Array.isArray(t.matieres)&&t.matieres.length>0?this.onSelectMatiere(t.matieres[0]):Object.isExists(this.matiereSelected)?this.onSelectMatiere(this.matiereSelected):this.onSelectMatiere(new r.vcu)}onSelectMatiere(t){this.matiereSelected=t,this.getManuelsProfOrEleveAvalaible()}getManuelsProfOrEleveAvalaible(t=!1){this.listeEleves=[],this._variant=r.$ej.edDBUserSpecificKeyFromUser(this.authStore.currentUser,[this.classeGroupeSelected.code,"D",1,"ALL",this.showAll?1:0]),this._variantEleve=r.$ej.edDBUserSpecificKey(this.authStore.currentUser.codeOgec,r.meW.CLASSE,this.authStore.currentUser.id,[this.classeGroupeSelected.code,"D",1,"ALL",this.showAll?1:0]);const i=this.manuelsNumeriquesService.manuelsNumeriques(this.authStore.currentUser.id,this.authStore.currentUser.typeCompte,this.classeGroupeSelected.code,this.matiereSelected.code,!0,this.showAll,t).pipe((0,y.d)(void 0)),c=this.manuelsNumeriquesService.manuelsNumeriques(this.authStore.currentUser.id,r.meW.CLASSE,this.classeGroupeSelected.code,this.matiereSelected.code,!0,this.showAll,t).pipe((0,y.d)(void 0));this.loader=this.loaderService.show(this),(0,U.D)([i,c]).pipe((0,l.b)(p=>{Object.isExists(p[0])||(this.manuelsProfAvailable=new r.yN1(Object.getEntity(this.manuelsNumeriquesStore.snapshot,this._variant))),Object.isExists(p[1])||(this.manuelsEleveAvailable=new r.yN1(Object.getEntity(this.manuelsNumeriquesStore.snapshot,this._variantEleve)))}),(0,S.x)(()=>this.loaderService.hide(this)),(0,f.K)(p=>this.uiService.notifyErrorThenEmpty(p,!0,"Erreur","fa fa-warning"))).subscribe()}updateAssociationProfManuel(t){this.loader=this.loaderService.show(this),this.manuelsNumeriquesService.updateAssociationProfManuel(t,this.authStore.currentUser.id,r.meW.ENSEIGNANT,this.classeGroupeSelected.code,this.matiereSelected.code).pipe((0,S.x)(()=>this.loaderService.hide(this)),(0,f.K)(i=>this.uiService.notifyErrorThenEmpty(i,!0,"Erreur","fa fa-warning"))).subscribe()}showEleves(t){Object.isExists(this.selectedManuelEleve)&&t.idRessource===this.selectedManuelEleve.idRessource?(this.selectedManuelEleve=void 0,this.listeEleves=[],this.listeElevesDefault=[],this.closeListeEleve()):(this.selectedManuelEleve=t,this.listeEleves=t.eleves.map(i=>new r.Oev(i)),this.currentStateTousAucun=t.eleves.every(i=>!0===i.affecte))}updateAssociationElevesManuel(t){this.selectedManuelEleve.eleves=this.listeEleves,this.loader=this.loaderService.show(this),this.manuelsNumeriquesService.updateAssociationEleveManuel(t,this.authStore.currentUser.id,r.meW.CLASSE,this.classeGroupeSelected.code,this.matiereSelected.code).pipe((0,l.b)(i=>{i?this.uiService.notifyEvent(r.DOJ.genericSuccess,"L'affectation des manuels scolaires a bien \xe9t\xe9 prise en compte.","Manuels scolaires"):this.uiService.notifyEvent(r.DOJ.genericError,"Une erreur s'est produite lors de l'affectation des manuels scolaires","Manuels scolaires")}),(0,S.x)(()=>this.loaderService.hide(this)),(0,f.K)(i=>this.uiService.notifyErrorThenEmpty(i,!0,"Erreur","fa fa-warning"))).subscribe()}closeListeEleve(){this.selectedManuelEleve=void 0,this.listeEleves=[]}tousAucunEleves(){this.currentStateTousAucun=!this.currentStateTousAucun,this.listeEleves.forEach(t=>{t.affecte=this.currentStateTousAucun})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(r.Fh3),e.Y36(r.VLf),e.Y36(x.S),e.Y36(r.CnD),e.Y36(r.rP1))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ed-prof-distribution-des-manuels"]],inputs:{classeGroupeSelected:"classeGroupeSelected",matiereSelected:"matiereSelected",isOpenInModal:"isOpenInModal"},features:[e.qOj],decls:7,vars:13,consts:[[1,"ed-prof-distribution-des-manuels",3,"ngClass","ngBusy"],["class","form-show-all mt-2",4,"ngIf"],[1,"my-2"],[1,"btn-group"],["placeholder","Choisir une classe",3,"displayClasses","displayClassesEtabsLibelle","displayGroupes","displaySalles","entity","displayAllClasses","entityChange"],["class","btn-group margin-whitespace","dropdown","",3,"isDisabled",4,"ngIf"],["class","mb-3",3,"closeOthers",4,"ngIf"],[1,"form-show-all","mt-2"],[1,"form-check"],["id","showAll","type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],["for","showAll",1,"form-check-label","fw-normal"],["dropdown","",1,"btn-group","margin-whitespace",3,"isDisabled"],["id","dropdownMenu12","type","button","dropdownToggle","","aria-controls","dropdown-matieres",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","dropdownMenu12","class","dropdown-menu","role","menu","id","dropdown-matieres",4,"dropdownMenu"],["aria-labelledby","dropdownMenu12","role","menu","id","dropdown-matieres",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf","ngForTrackBy"],["role","menuitem"],["type","button",1,"dropdown-item",3,"click"],[1,"mb-3",3,"closeOthers"],[3,"isOpen",4,"ngIf"],["class","panel-custom",4,"ngIf"],[3,"isOpen"],["first",""],["accordion-heading",""],["class","badge",4,"ngIf"],["accordion-body",""],[1,"mt-3"],[2,"color","grey"],[1,"mt-2"],["class","jumbotron",4,"ngIf"],[1,"list-group",2,"max-height","55vh","overflow-y","auto"],["class","list-group-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"badge"],[1,"jumbotron"],[1,"list-group-item"],[1,"row-action-primary"],[1,"material-icons"],["alt","manuel scolaire",3,"src","title"],[1,"list-group-item-text","float-end","form-check"],["type","checkbox",1,"form-check-input",3,"id","ngModel","ngModelChange"],[1,"form-check-label","fw-normal",3,"for"],[1,"list-group-item-heading"],[1,"panel-custom"],["second",""],[1,"list-group-item-text","float-end"],["type","button","aria-label","Afficher la liste des \xe9l\xe8ves",1,"btn","btn-fab","btn-primary",3,"click"],["aria-hidden","true",1,"icon-ed_eleve"],[4,"ngIf"],[1,"listEleveManuel","clearfix"],[1,"row"],[1,"col-lg-4","nomEleve"],[1,"col-lg-4"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],["class","row",4,"ngFor","ngForOf","ngForTrackBy"],[1,"button-bar"],["type","button",1,"btn","btn-danger","btn-sm","float-start",3,"click"],["type","button",1,"btn","btn-success","btn-sm","float-end",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,I,5,1,"div",1),e.TgZ(2,"div",2)(3,"div",3)(4,"ed-select-entity",4),e.NdJ("entityChange",function(p){return i.onSelectClasseGroupe(p)}),e.qZA()(),e.YNc(5,J,4,2,"div",5),e.qZA(),e.YNc(6,W,3,3,"accordion",6),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(11,H,!i.isOpenInModal))("ngBusy",i.loader),e.xp6(1),e.Q6J("ngIf",i.isShowAllEnable()),e.xp6(3),e.Q6J("displayClasses",!0)("displayClassesEtabsLibelle",!0)("displayGroupes",!0)("displaySalles",!1)("entity",i.classeGroupeSelected)("displayAllClasses",!1),e.xp6(1),e.Q6J("ngIf",!i.isCDTPrimaire),e.xp6(1),e.Q6J("ngIf",i.matiereSelected))},dependencies:[m.mk,m.sg,m.O5,D.Wl,D.JJ,D.On,Z.Zf,Z.U_,O.Hz,O.Mq,O.TO,A.DC,_.h,s.$],styles:[".ed-prof-distribution-des-manuels .form-show-all{position:absolute;right:40px;z-index:10}.ed-prof-distribution-des-manuels .accordion .panel-heading .badge,.ed-prof-distribution-des-manuels accordion .panel-heading .badge{background-color:#fff;color:var(--light-primary-color)}.ed-prof-distribution-des-manuels .accordion .modal-content .modal-body h4,.ed-prof-distribution-des-manuels accordion .modal-content .modal-body h4{color:var(--light-primary-color);font-size:14px;text-transform:uppercase}.ed-prof-distribution-des-manuels .accordion .list-group-item .row-action-primary,.ed-prof-distribution-des-manuels accordion .list-group-item .row-action-primary{float:left;margin:0 10px 0 0;width:50px}.ed-prof-distribution-des-manuels .accordion .list-group-item .row-action-primary img,.ed-prof-distribution-des-manuels accordion .list-group-item .row-action-primary img{width:100%}.ed-prof-distribution-des-manuels .accordion .listEleveManuel>div:nth-child(odd),.ed-prof-distribution-des-manuels accordion .listEleveManuel>div:nth-child(odd){background:#fff}.ed-prof-distribution-des-manuels .accordion .button-bar,.ed-prof-distribution-des-manuels accordion .button-bar{margin:10px 0 0}\n"],encapsulation:2,changeDetection:0}),n})();function X(n,a){if(1&n&&e._UZ(0,"ed-prof-vos-manuels-scolaires",7),2&n){const t=e.oxw();e.Q6J("isOpenInModal",t.isInModal)("classeGroupeSelected",t.entity)}}function ee(n,a){if(1&n&&e._UZ(0,"ed-prof-distribution-des-manuels",8),2&n){const t=e.oxw();e.Q6J("isOpenInModal",t.isInModal)("classeGroupeSelected",t.entity)("matiereSelected",t.matiere)}}let te=(()=>{class n{constructor(){this.isInModal=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["ed-manuels-scolaires-prof"]],inputs:{entity:"entity",matiere:"matiere",isInModal:"isInModal"},decls:7,vars:2,consts:[[1,"nav-tabs-container-bg"],["heading","Vos manuels scolaires","edTabOrder","1",1,"visible"],["tabVMS","tab"],[3,"isOpenInModal","classeGroupeSelected",4,"ngIf"],["heading","Distribution des manuels","edTabOrder","2",1,"visible"],["tabDDM","tab"],[3,"isOpenInModal","classeGroupeSelected","matiereSelected",4,"ngIf"],[3,"isOpenInModal","classeGroupeSelected"],[3,"isOpenInModal","classeGroupeSelected","matiereSelected"]],template:function(t,i){if(1&t&&(e.TgZ(0,"tabset",0)(1,"tab",1,2),e.YNc(3,X,1,2,"ed-prof-vos-manuels-scolaires",3),e.qZA(),e.TgZ(4,"tab",4,5),e.YNc(6,ee,1,3,"ed-prof-distribution-des-manuels",6),e.qZA()()),2&t){const c=e.MAs(2),p=e.MAs(5);e.xp6(3),e.Q6J("ngIf",c.active),e.xp6(3),e.Q6J("ngIf",p.active)}},dependencies:[m.O5,E.wW,E.AH,h.v,N,z],changeDetection:0}),n})()},40030:(T,b,o)=>{o.d(b,{m:()=>E});var e=o(99658),m=o(94650);let E=(()=>{class h{}return h.\u0275fac=function(f){return new(f||h)},h.\u0275mod=m.oAB({type:h}),h.\u0275inj=m.cJS({imports:[e.m]}),h})()}}]);